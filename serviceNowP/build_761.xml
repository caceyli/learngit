<project name="bDNA" default="all" basedir=".">
<!--                                                        -->
<!--            High-level build targets                    -->
<!--                                                        -->

<!--
1. Make sure Ant is already installed and is fully working.
2. Copy flexTasks.jar onto /usr/share/jakarta/apache-ant-1.6.5/lib/
(flexTasks.jar can be found under C:\Program Files\Adobe\Flex Builder 3\sdks\3.2.0\ant\lib
3. Copy entire Flex SDK onto /usr/share/flex/sdk.  If you are using Adobe Flex Builder,
the Flex SDK can be found under C:\Program Files\Adobe\Flex Builder 3\sdks\3.2.0\.
(It must be the Adobe implementation of Flex SDK, not Open Source Flex SDK)

modified by kchu
-->

<target name="build" depends="content_java, build_sequences" />
<!-- <target name="all" depends="build, install" /> -->

<target name="build_pssoft" depends="content_java, build_pssoft_sequence" />
<target name="build_enterprise" depends="content_java, build_enterprise_sequence" />

<!--                                                        -->
<!--            The build configuration                     -->
<!--                                                        -->
<property resource="build_env.${os.name}.properties" classpath="${basedir}"/>

<!-- Base file name of the Tomcat archive to use for the clm. -->
<property name="clm.tomcat.instance" value="jakarta-tomcat-5.0.19"/>
<property name="rs.tomcat.instance" value="jakarta-tomcat-4.1.27" />

<!-- Name of directory (in nih) of the instance of Axis to use for the clm. -->
<property name="clm.axis.instance"   value="axis/1.2alpha"/>

<!--            derive build, install and dist directories  -->
<property name="bdna.seq"                location="${basedir}/.." />
<property name="bdna.build"              location="${bdna.seq}/../build${bdna.bcp.version}" />
<property name="bdna.content.build"      location="${bdna.seq}/../content_build${bdna.bcp.version}" />
<property name="bdna.content.dist"       location="${bdna.seq}/../content_dist${bdna.bcp.version}/bdna" />
<property name="bdna.nightly_builds"     location="${bdna.seq}/../nightly_builds" />

<property name="bdna.src"                location="${basedir}/../../bdna" />

<property name="bdna.BCP.Baseline.label"    value="Baseline Pack" />
<property name="bdna.BCP.Baseline.version"  value="${bdna.bcp.version}" />
<property name="bdna.BCP.MicrosoftSoftware.label"    value="Microsoft Software Sequence" />
<property name="bdna.BCP.MicrosoftSoftware.version"  value="${bdna.bcp.version}" />
<property name="bdna.BCP.IBMHardware.label"    value="IBM Hardware Sequence" />
<property name="bdna.BCP.IBMHardware.version"  value="${bdna.bcp.version}" />
<property name="bdna.BCP.IBMSoftware.label"    value="IBM Software Sequence" />
<property name="bdna.BCP.IBMSoftware.version"  value="${bdna.bcp.version}" />
<property name="bdna.BCP.OracleSoftware.label"    value="Oracle Software Sequence" />
<property name="bdna.BCP.OracleSoftware.version"  value="${bdna.bcp.version}" />
<property name="bdna.BCP.OracleLMS.label"    value="Oracle License Management Sequence" />
<property name="bdna.BCP.OracleLMS.version"  value="${bdna.bcp.version}" />
<property name="bdna.BCP.AdobeSoftware.label"    value="Adobe Software Sequence" />
<property name="bdna.BCP.AdobeSoftware.version"  value="${bdna.bcp.version}" />
<property name="bdna.BCP.DellHardware.label"    value="IBM Hardware Sequence" />
<property name="bdna.BCP.DellHardware.version"  value="${bdna.bcp.version}" />
<property name="bdna.BCP.CiscoHardware.label"    value="Cisco Hardware Sequence" />
<property name="bdna.BCP.CiscoHardware.version"  value="${bdna.bcp.version}" />
<property name="bdna.BCP.HPHardware.label"    value="HP Hardware Sequence" />
<property name="bdna.BCP.HPHardware.version"  value="${bdna.bcp.version}" />
<property name="bdna.BCP.HardwareEnergy.label"    value="Hardware Energy Sequence" />
<property name="bdna.BCP.HardwareEnergy.version"  value="${bdna.bcp.version}" />
<property name="bdna.BCP.EnterpriseSequence.label"    value="Enterprise Sequence" />
<property name="bdna.BCP.EnterpriseSequence.version"  value="${bdna.bcp.version}" />

<property name="bdna.BCP.PSSoftSequence.label"    value="Discover OEM: PSSoft" />
<property name="bdna.BCP.PSSoftSequence.version"  value="${bdna.bcp.version}" />

<property name="bdna.BCP.Content612.label"    value="6.1.2 Content Update" />
<property name="bdna.BCP.Content612.version"  value="${bdna.bcp.version}" />

<!--                                                        -->
<!--            Sets the environment variables              -->
<!--                                                        -->

<path id="javac.classpath">
        <pathelement location="${bdna.src}/nih/Xerces/xercesImpl.jar"/>
        <pathelement location="${bdna.src}/nih/Xerces/xml-apis.jar"/>
        <pathelement location="${bdna.src}/nih/JUnit/junit.jar"/>
        <pathelement location="${bdna.src}/nih/rhino/js.jar"/>
        <pathelement location="${bdna.src}/nih/oracle/ojdbc6.jar"/>
        <pathelement location="${bdna.src}/nih/oracle/ucp.jar"/>
        <pathelement location="${bdna.src}/nih/oracle/xsu12.jar"/>
        <pathelement location="${bdna.src}/nih/Log4J/log4j.jar"/>
        <pathelement location="${bdna.src}/nih/SOAP/soap.jar"/>
        <pathelement location="${bdna.src}/nih/electric/servlet.jar"/>
        <pathelement location="${bdna.src}/nih/electric/GLUE.jar"/>
        <pathelement location="${bdna.src}/nih/electric/jnet.jar"/>
        <pathelement location="${bdna.src}/nih/concurrent/concurrent.jar"/>
        <pathelement location="${bdna.src}/nih/Regexp/jakarta-regexp-1.2.jar"/>
        <pathelement location="${bdna.src}/nih/gnu/gnu-regexp-1.1.4.jar"/>
        <pathelement location="${bdna.src}/nih/marsh/marsh.jar"/>
        <pathelement location="${bdna.src}/nih/Velocity/velocity-dep-1.2.jar"/>
        <pathelement location="${bdna.src}/nih/JavaCup/javacup.jar"/>
        <pathelement location="${bdna.src}/nih/JavaCup/JFlex.jar"/>
        <pathelement location="${bdna.src}/nih/JBAF/activation.jar"/>
        <pathelement location="${bdna.src}/nih/Netcharts/netcharts4.jar"/>
        <pathelement location="${bdna.src}/nih/Netcharts/ncpro.jar"/>
        <pathelement location="${bdna.src}/nih/tinylf/tinylf.jar"/>
        <pathelement location="${bdna.src}/nih/HTTPClient/commons-httpclient.jar"/>
        <pathelement location="${bdna.src}/nih/Codec/commons-codec.jar"/>
        <pathelement location="${bdna.src}/nih/htmlparser/htmlparser.jar"/>
        <pathelement location="${bdna.src}/nih/fileupload/commons-fileupload-1.2.1.jar"/>
        <pathelement location="${bdna.src}/nih/commons-io/commons-io-1.4.jar"/>
        <pathelement location="${bdna.src}/nih/OpenView/libovw.jar"/>
        <pathelement location="${bdna.src}/nih/JCalendar/jcalendar-1.3.2.jar"/>
        <pathelement location="${bdna.src}/nih/JSON/JSON.jar"/>
        <pathelement location="${bdna.src}/nih/BeanShell/bsh-1.2b8.jar"/>
        <pathelement location="${bdna.src}/nih/BrowserLauncher2/BrowserLauncher2.jar"/>
        <pathelement location="${bdna.src}/nih/xstream/xpp3_min-1.1.3.4.I.jar"/>
        <pathelement location="${bdna.src}/nih/xstream/xstream-1.1.2.jar"/>
        <pathelement location="${bdna.src}/content/external/IBMCMDB/dlAdapter/lib/dl_core.jar"/>
        <pathelement location="${bdna.src}/nih/Jetty/core-3.1.1.jar"/>
        <pathelement location="${bdna.src}/nih/Jetty/jetty-6.1.5.jar"/>
        <pathelement location="${bdna.src}/nih/Jetty/jetty-util-6.1.5.jar"/>
        <pathelement location="${bdna.src}/nih/Jetty/slf4j-api-1.5.6.jar"/>
        <pathelement location="${bdna.src}/nih/Jetty/slf4j-log4j12-1.5.6.jar"/>
        <pathelement location="${bdna.src}/nih/Jetty/jsp-2.1.jar"/>
        <pathelement location="${bdna.src}/nih/Jetty/jsp-api-2.1.jar"/>
        <pathelement location="${bdna.src}/nih/SunJDK/deploy.jar"/>
        <pathelement location="${bdna.src}/nih/jcs/jcs-1.3.jar"/>
        <pathelement path="${bdna.seq}/conf" />
        <pathelement path="${bdna.seq}/conf/jiffy" />
        <pathelement location="${bdna.seq}/lib/j4.jar"/>
        <pathelement location="${bdna.seq}/lib/bdna.jar"/>
        <fileset dir="${bdna.src}/nih/${clm.axis.instance}">
            <include name="*.jar"/>
        </fileset>
        <pathelement location="${bdna.build}/nih/Tomcat/${clm.tomcat.instance}/bin/bootstrap.jar"/>
</path>

<!--                                                        -->
<!--            Stamp the build                             -->
<!--                                                        -->

<target name="stamp">
    <tstamp>
        <format property="bdna.build.stamp" pattern="yyyy_MM_dd_HH_mm" />
    </tstamp>

    <tstamp>
        <format property="bdna.build.jar.stamp" pattern="yyyyMMdd" />
    </tstamp>

    <!-- bdna.build.number is the value of build.number at the time
         an "ant stamp" is done.  That way, the destination directory
         does not change even if the developer re-synchronizes with the
         repository and gets an updated build.number file.  -->
    <property file="${basedir}/bcp.build.number"/>
    <property name="bcp.build.number" value="${bcp.build.number}" />

    <echo file="${basedir}/current_build.stamp">bdna.build.stamp=${bdna.build.stamp}
bcp.build.number=${bcp.build.number}
    </echo>
</target>

<target name="init">
    <property resource="current_build.stamp" classpath="${basedir}"/>
    <!-- Depend on ant properties being immutable; if a developer wants
         to do builds without doing a stamp, they can.  But if they
         did do a stamp in this source tree, then the values from
         current_build.stamp will prevail. -->
    <property name="bdna.build.stamp" value="1970_01_01_00_00" />
    <property name="bcp.build.number" value="0000" />

    <property name="bdna.nightly_builds.this_build" value="${bdna.nightly_builds}/${bdna.bcp.version}/${bdna.build.stamp}_${bcp.build.number}" />
    <mkdir dir="${bdna.nightly_builds.this_build}" />
</target>

<!--                                                        -->
<!--              Build content sequences                   -->
<!--                                                        -->

<target name="ui_engine_library">
    <mkdir dir="${bdna.content.dist}/appframe" />
    <mkdir dir="${bdna.content.dist}/appframe/com" />
    <mkdir dir="${bdna.content.dist}/appframe/com/bdna" />
    <mkdir dir="${bdna.content.dist}/appframe/com/bdna/modules" />
    <mkdir dir="${bdna.content.dist}/appframe/com/bdna/modules/appmeta" />
    <copy file="${bdna.seq}/com/bdna/app/widget/WidgetLibrary.xml" todir="${bdna.content.dist}/appframe/com/bdna/modules/appmeta" />
    <copy file="${bdna.seq}/com/bdna/app/uiengine/HTMLEngineWidgetLibrary.xml" todir="${bdna.content.dist}/appframe/com/bdna/modules/appmeta" />
    <copy file="${bdna.seq}/com/bdna/app/uiengine/SwingEngineWidgetLibrary.xml" todir="${bdna.content.dist}/appframe/com/bdna/modules/appmeta" />
</target>

<target name="prep_content_java" depends="init">
    <delete dir="${bdna.build}" />
    <mkdir dir="${bdna.build}/classes" />
    <mkdir dir="${bdna.build}/debug" />
    <mkdir dir="${bdna.build}/debug/classes" />
</target>

<target name="content_java" depends="prep_content_java">
    <!-- build UDTs from sequences directory -->
    <javac
        srcdir="${bdna.seq}"
        includes="com/bdna/si/udt/**"
        destdir="${bdna.build}/classes"
        classpathref="javac.classpath"
        failonerror="true"
        verbose="${verbose}"
        debug="${debug}"
        optimize="${optimize}"
        fork="true"
        memoryMaximumSize="256M"
        source="1.5">
    </javac>
    <javac
        srcdir="${bdna.seq}"
        includes="com/bdna/si/udt/**"
        destdir="${bdna.build}/debug/classes"
        classpathref="javac.classpath"
        failonerror="true"
        verbose="${verbose}"
        debug="on"
        fork="true"
        memoryMaximumSize="256M"
        optimize="off"
        source="1.5">
    </javac>

<!--
    <javac
        srcdir="${bdna.src}"
        destdir="${bdna.build}/classes"
        classpathref="javac.classpath"
        failonerror="true"
        verbose="${verbose}"
        debug="${debug}"
        excludes="com/bdna/si/udt/**"
        optimize="${optimize}"
        fork="true"
        memoryMaximumSize="256M"
        source="1.5">
        <include name="com/bdna/app/widget/JNavigation.java" />
        <include name="com/bdna/app/metadata/ScanQuery.java" />
        <include name="com/bdna/bvl/dw/GlobalScan.java" />
        <include name="com/bdna/si/common/AutoConnection.java" />
        <include name="com/bdna/si/metadata/ElementFactory.java" />
        <include name="com/bdna/si/metadata/PackageFactory.java" />
        <include name="com/bdna/si/udt/UDTUtil.java" />
        <include name="com/bdna/ut/cla/claMessages/ResultCodes.java" />
        <include name="com/bdna/ut/xmlsax/BaseHandler.java" />
        <include name="com/bdna/app/metadata/eri/ERIGenerator.java" />
        <include name="com/bdna/si/ac/User.java" />
    </javac>
    <javac
        srcdir="${bdna.src}"
        destdir="${bdna.build}/debug/classes"
        classpathref="javac.classpath"
        failonerror="true"
        verbose="${verbose}"
        debug="on"
        fork="true"
        memoryMaximumSize="256M"
        optimize="off"
        source="1.5">
        <include name="com/bdna/app/widget/JNavigation.java" />
        <include name="com/bdna/app/metadata/ScanQuery.java" />
        <include name="com/bdna/bvl/dw/GlobalScan.java" />
        <include name="com/bdna/si/common/AutoConnection.java" />
        <include name="com/bdna/si/metadata/ElementFactory.java" />
        <include name="com/bdna/si/metadata/PackageFactory.java" />
        <include name="com/bdna/si/udt/UDTUtil.java" />
        <include name="com/bdna/ut/cla/claMessages/ResultCodes.java" />
        <include name="com/bdna/ut/xmlsax/BaseHandler.java" />
        <include name="com/bdna/app/metadata/eri/ERIGenerator.java" />
        <include name="com/bdna/si/ac/User.java" />
    </javac>
-->
</target>


<target name="prep_build_bcp_Baseline">
    <delete dir="${bdna.content.build}" />
    <mkdir dir="${bdna.content.build}/modules" />
    <mkdir dir="${bdna.content.build}/presentation" />
    <mkdir dir="${bdna.content.build}/com/bdna/junit" />
    <mkdir dir="${bdna.content.build}/nih" />
    <mkdir dir="${bdna.content.build}/nih" />
    <mkdir dir="${bdna.content.build}/scripts" />
    <mkdir dir="${bdna.content.build}/appframe" />
    <mkdir dir="${bdna.content.build}/appdata" />
    <mkdir dir="${bdna.content.build}/java" />
    <mkdir dir="${bdna.content.build}/conf" />
<!--
    <mkdir dir="${bdna.content.build}/java/sources/com/bdna/si/udt" />
    <mkdir dir="${bdna.content.build}/java/classes/com/bdna/si/udt" />
-->
</target>


<!--                                                        -->
<!--            Generate the fingerprint modules            -->
<!--                                                        -->
<macrodef name="generate-bcp-Baseline">
  <sequential>
    <java
        classname="com.bdna.fingerprintTool.OSDevFingerprint"
        classpathref="javac.classpath"
        failonerror="true"
        dir="${bdna.seq}/com/bdna/fingerprintTool/templates"
        fork="yes" >
        <sysproperty key="bdna.home" value="${bdna.seq}"/>
        <sysproperty key="bdna.jiffy.noperlcheck" value="${bdna.jiffy.noperlcheck}" />
        <arg value="${bdna.seq}" />
        <arg value="${bdna.content.build}" />
    </java>


    <!-- move the bdna modules, overwrite the generated version if any -->
    <copy todir="${bdna.content.build}/modules/">
        <fileset dir="${bdna.seq}/modules">
            <include name="com/bdna/modules/app/ActiveDirectory.xml" />
            <include name="com/bdna/modules/app/NetworkServices.xml" />
            <include name="com/bdna/modules/common/Base.xml" />
            <include name="com/bdna/modules/common/CalculatedGlobalAttributes.xml" />
            <include name="com/bdna/modules/common/Connection.xml" />
            <include name="com/bdna/modules/common/CredentialAggregationDefs.xml" />
            <include name="com/bdna/modules/common/DisableUNIXProcessDepList.xml" />
            <include name="com/bdna/modules/common/DiscoveryInstall.xml" />
            <include name="com/bdna/modules/common/DiscoveryBase.xml" />
            <include name="com/bdna/modules/common/DuplicateResource.xml" />
            <include name="com/bdna/modules/common/ExternalTypes.xml" />
            <include name="com/bdna/modules/common/Financial.xml" />
            <include name="com/bdna/modules/common/NamespaceDuplicateResource.xml" />
            <include name="com/bdna/modules/common/Peripheral.xml" />
            <include name="com/bdna/modules/common/QueryBasedTypes" />
            <include name="com/bdna/modules/common/RecycleBin.xml" />
            <include name="com/bdna/modules/common/SystemDiscovery.xml" />
            <include name="com/bdna/modules/hardware/PrinterDiscovery.xml" />
            <include name="com/bdna/modules/hardware/SMIS.xml" />
            <include name="com/bdna/modules/network/CiscoIPPhone.xml" />
            <include name="com/bdna/modules/network/genericNetworkInfrastructure.xml" />
            <include name="com/bdna/modules/os/Embedded.xml" />
            <include name="com/bdna/modules/os/IBMzOS.xml" />
            <include name="com/bdna/modules/os/J2ME.xml" />
            <include name="com/bdna/modules/os/Mainframe.xml" />
            <include name="com/bdna/modules/os/Minicomputer.xml" />
            <include name="com/bdna/modules/os/OperatingSystemTypes.xml" />
            <include name="com/bdna/modules/os/WyseThinClient.xml" />
            <include name="**/*.properties" />
        </fileset>
    </copy>


    <!-- move the bdna modules, overwrite the generated version if any -->
    <copy todir="${bdna.content.build}/modules/com/bdna/presentationModules">
        <fileset dir="${bdna.seq}/modules/com/bdna/presentationModules">
            <include name="common/*" />
            <exclude name="common/ADMTypesAndAttrsDef.xml" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.build}/modules/com/bdna/presentationModules">
        <fileset dir="${bdna.seq}/modules/com/bdna/presentationModules">
            <include name="hardware/PrinterDiscovery.xml" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.build}/modules/com/bdna/presentationModules">
        <fileset dir="${bdna.seq}/modules/com/bdna/presentationModules">
            <include name="os/AIX.xml" />
            <include name="os/Embedded.xml" />
            <include name="os/HPUX.xml" />
            <include name="os/IBMzOS.xml" />
            <include name="os/J2ME.xml" />
            <include name="os/Linux.xml" />
            <include name="os/MacOS.xml" />
            <include name="os/Netware.xml" />
            <include name="os/OracleVMServer.xml" />
            <include name="os/UNIX.xml" />
            <include name="os/VNwareESXServer.xml" />            
            <include name="os/Windows.xml" />
            <include name="os/XenServer.xml" />
        </fileset>
    </copy>


    <!-- copy the built-in application modules -->
    <copy todir="${bdna.content.build}/appframe/com/bdna/modules/appmeta">
        <fileset dir="${bdna.seq}/com/bdna/app/application">
            <include name="ADMDependencyMatch.xml" />
            <include name="Administrative.xml" />
            <include name="ADMResults.xml" />
            <include name="Aggregate.xml" />
            <include name="AppConsole.xml" />
            <include name="Applications.xml" />
            <include name="AssetRecon.xml" />
            <include name="BaselinePack.xml" />
            <include name="Base.xml" />
            <include name="CatalogBase.xml" />
            <include name="Common.xml" />
            <include name="Dashboard.xml" />
            <include name="Databases.xml" />
            <include name="ERIBase.xml" />
            <include name="ERIStar.xml" />
            <include name="FactBase.xml" />
            <include name="Folders.xml" />
            <include name="Guardium_Modules.xml" />
            <include name="HTMLInventoryApplication.xml" />
            <include name="HyperVVirtualization.xml" />
            <include name="LinkingRules.xml" />
            <include name="Linking.xml" />
            <include name="MarketData_SupportViews.xml" />
            <include name="MarketData.xml" />
            <include name="MDTablesFolderPlacements.xml" />
            <include name="NetworkEquipment.xml" />
            <include name="NetworkServices.xml" />
            <include name="OperatingSystems.xml" />
            <include name="Printers.xml" />
            <include name="QuickReports.xml" />
            <include name="ScanAdmin.xml" />
            <include name="SchemaTool.xml" />
            <include name="StandardApplication.xml" />
            <include name="Storage.xml" />
            <include name="TransactionalModel.xml" />
            <include name="UserReports.xml" />
            <include name="VideoConferencingEquipment.xml" />
            <include name="VMapRelations.xml" />
            <include name="ScanSummary.xml" />
        </fileset>
    </copy>


    <copy todir="${bdna.content.build}/presentation">
        <fileset dir="${bdna.src}/presentation">
            <include name="**/*.xml" />
            <include name="**/*.properties" />
        </fileset>
    </copy>


    <!-- Copy SAP related files to nih -->
    <copy file="${bdna.seq}/nih/SAP/SAPSolmanCredentialVerifier" todir="${bdna.content.build}/nih/SAP" />
    <copy file="${bdna.seq}/nih/SAP/SAPSolmanDataCollector" todir="${bdna.content.build}/nih/SAP" />
    <copy file="${bdna.seq}/nih/SAP/README.txt" todir="${bdna.content.build}/nih/SAP" />
    <copy file="${bdna.seq}/nih/SAP/deplpoyables/EAR_SAPLDC.ear" todir="${bdna.content.build}/nih/SAP/deplpoyables" />
    <copy file="${bdna.seq}/nih/SAP/deplpoyables/SAPLDCDaemon.sda" todir="${bdna.content.build}/nih/SAP/deplpoyables" />
    <copy file="${bdna.seq}/nih/SAP/runnables/solman7.jar" todir="${bdna.content.build}/nih/SAP/runnables" />

    <!-- Copy the entite SAP Solman library admin directory to build directory-->
    <copy todir="${bdna.content.build}/nih/SAP/runnables/lib">
        <fileset dir="${bdna.seq}/nih/SAP/runnables/lib">
            <include name="**" />
        </fileset>
    </copy>
    <copy todir="${bdna.content.build}/nih/SAP/runnables">
        <fileset dir="${bdna.seq}/nih/SAP/runnables">
            <include name="**" />
        </fileset>
    </copy>

    <exec dir="${bdna.content.build}/nih/SAP"
          os="Linux"
          executable="/bin/chmod">
          <arg line="+x SAPSolmanDataCollector SAPSolmanCredentialVerifier" />
     </exec>

    <!-- dist the misc scripts -->
    <copy todir="${bdna.content.build}/scripts">
        <fileset dir="${bdna.seq}/scripts">
            <include name="**" />
            <include name="CLE/**" />
            <include name="ModularCollection/**" />
            <include name="RuleEngine/**" />
        </fileset>
    </copy>

    <!-- Fix for bug #21680 until 7.6 -->
    <copy todir="${bdna.content.build}/scripts">
        <fileset dir="${bdna.src}/scripts">
            <include name="control/start_component.sh" />
        </fileset>
    </copy>

    <!-- Fix for bug #26033 until next platform -->
    <copy todir="${bdna.content.build}/conf">
        <fileset dir="${bdna.src}/conf">
            <include name="MessagesBundle.properties" />
        </fileset>
    </copy>

    <!-- dist the nih components -->
    <copy todir="${bdna.content.build}/nih">
        <fileset dir="${bdna.seq}/nih">
            <include name="Perl/Modules/**" />
            <include name="Nmap/src/nmap.Linux.RHEL4" />
            <include name="Nmap/src/nmap.Linux.RHEL5.i686" />
            <include name="Nmap/src/nmap.Linux.RHEL5.x86_64" />
            <include name="Nmap/src/nmap-mac-prefixes" />
            <include name="Nmap/src/nmap-os-db" />
            <include name="Nmap/src/nmap-protocols" />
            <include name="Nmap/src/nmap-rpc" />
            <include name="Nmap/src/nmap-service-probes" />
            <include name="Nmap/src/nmap-services" />
            <include name="Nmap/src/nse_main.lua" />
            <include name="Nmap/src/nselib" />
            <include name="Nmap/src/scripts" />
            <include name="Nmap/src4/nmap-os-fingerprints" />
            <include name="Nmap/src4/nmap-protocols" />
            <include name="Nmap/src4/nmap-services" />
            <include name="Nmap/src4/nmap-rpc" />
            <include name="Nmap/src4/nmap.Linux" />
            <include name="Nmap/src4/nmap.exe" />
            <include name="SNMP/**" />
            <include name="samba/bin/**" />
            <include name="mssqlping/sqlping.Linux" />
            <include name="npadmin/npadmin.Linux" />
            <include name="nbtscan/nbtscan.Linux" />
            <include name="nbtscan/nbtscan.exe" />
            <include name="wbemcli/**" />
            <include name="mitre/**" />
        </fileset>
    </copy>
  </sequential>
</macrodef>

<target name="generate_bcp_Baseline" depends="prep_build_bcp_Baseline">
    <generate-bcp-Baseline />
</target>

<!--                                                        -->
<!--            Prepare the distribution directories        -->
<!--                                                        -->
<target name="prep_dist_bcp_Baseline">
    <delete dir="${bdna.content.dist}" />
    <mkdir dir="${bdna.content.dist}/modules" />
    <mkdir dir="${bdna.content.dist}/modules/com" />
    <mkdir dir="${bdna.content.dist}/modules/com/bdna" />
    <mkdir dir="${bdna.content.dist}/scripts" />
    <mkdir dir="${bdna.content.dist}/nih" />
    <mkdir dir="${bdna.content.dist}/appdata" />
    <mkdir dir="${bdna.content.dist}/java" />
    <mkdir dir="${bdna.content.dist}/appframe" />
    <mkdir dir="${bdna.content.dist}/MANIFEST" />
    <mkdir dir="${bdna.content.dist}/upgrade" />
    <mkdir dir="${bdna.content.dist}/pre_upgrade" />
    <mkdir dir="${bdna.content.dist}/content/cmdb/BDNAERI" />
    <mkdir dir="${bdna.content.dist}/classes" />
    <mkdir dir="${bdna.content.dist}/debug" />
    <mkdir dir="${bdna.content.dist}/debug/classes" />
    <mkdir dir="${bdna.content.dist}/conf" />
</target>


<target name="dist_bcp_Baseline" depends="init, generate_bcp_Baseline, prep_dist_bcp_Baseline, content_java">

    <copy file="${bdna.seq}/content/manifests/BaselineManifest.xml" todir="${bdna.content.dist}/MANIFEST" />
<!--
    <copy file="${bdna.seq}/content/pre_upgrade/pre_upgrade.sh" tofile="${bdna.content.dist}/pre_upgrade/pre_upgrade.sh" />
    <copy file="${bdna.seq}/content/upgrade/upgrade.xml" tofile="${bdna.content.dist}/upgrade/upgrade.xml" />
    <copy file="${bdna.seq}/content/upgrade/BaselineUpgrade.sh" tofile="${bdna.content.dist}/upgrade/upgrade.sh" />
    <copy file="${bdna.seq}/content/upgrade/pubTablesCleanup.sql" tofile="${bdna.content.dist}/upgrade/pubTablesCleanup.sql" />
-->
    <copy file="${bdna.seq}/com/bdna/app/metadata/eri/ERI_ColExclusionList.txt" todir="${bdna.content.dist}/content/cmdb/BDNAERI" />
    <copy file="${bdna.seq}/com/bdna/app/widget/WidgetLibrary.xml" todir="${bdna.content.dist}/appframe/com/bdna/modules/appmeta" />
    <copy file="${bdna.seq}/com/bdna/app/uiengine/HTMLEngineWidgetLibrary.xml" todir="${bdna.content.dist}/appframe/com/bdna/modules/appmeta" />
    <copy file="${bdna.seq}/com/bdna/app/uiengine/SwingEngineWidgetLibrary.xml" todir="${bdna.content.dist}/appframe/com/bdna/modules/appmeta" />

    <replace file="${bdna.content.dist}/MANIFEST/BaselineManifest.xml" value="${bdna.bcp.version}">
        <replacefilter token="@bdna.bcp.version@"/>
    </replace>
<!--
    <replace file="${bdna.content.dist}/upgrade/upgrade.sh" value="${bdna.bcp.version}">
        <replacefilter token="@bdna.bcp.version@"/>
    </replace>
    <replace file="${bdna.content.dist}/upgrade/upgrade.sh" value="${bcp.build.number}">
        <replacefilter token="@bcp.build.number@"/>
    </replace>
-->
    <copy todir="${bdna.content.dist}/nih">
        <fileset dir="${bdna.content.build}/nih">
            <include name="**" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.dist}/scripts">
        <fileset dir="${bdna.content.build}/scripts">
            <include name="**" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.dist}/appdata">
        <fileset dir="${bdna.content.build}/appdata">
            <include name="**" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.dist}/appframe">
        <fileset dir="${bdna.content.build}/appframe">
            <include name="**" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.dist}/java/sources/com/bdna/si/udt">
        <fileset dir="${bdna.seq}/com/bdna/si/udt">
            <include name="*.java" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.dist}/java/classes/com/bdna/si/udt">
        <fileset dir="${bdna.build}/classes/com/bdna/si/udt">
            <include name="**" />
        </fileset>
    </copy>

    <!-- move the new Java classes -->
    <copy todir="${bdna.content.dist}/classes">
        <fileset dir="${bdna.seq}/java/classes">
            <include name="com/bdna/xsi/commands/CommandRunXform.class" />
            <include name="com/bdna/app/metadata/xsi/Project.class" />
            <include name="com/bdna/app/metadata/TableDef.class" />
            <include name="com/bdna/app/widget/JNavigation.class" />
            <include name="com/bdna/app/widget/JNavigation$$*.class" />
            <include name="com/bdna/app/widget/JDataAdmin.class" />
            <include name="com/bdna/app/widget/JDataAdmin$$*.class" />
            <include name="com/bdna/app/widget/JRoleEditor.class" />
            <include name="com/bdna/app/widget/JRoleEditor$$*.class" />
            <include name="com/bdna/app/metadata/ScanQuery.class" />
            <include name="com/bdna/app/metadata/ScanQuery$$*.class" />
            <include name="com/bdna/app/uiengine/SwingAppClient.class" />
            <include name="com/bdna/app/uiengine/SwingAppClient$$*.class" />            
            <include name="com/bdna/bvl/dw/GlobalScan.class" />
            <include name="com/bdna/bvl/dw/GlobalScan$$*.class" />
            <include name="com/bdna/bvl/dw/CumulativeScanBuilder.class" />
            <include name="com/bdna/bvl/dw/CumulativeScanBuilder$$*.class" />
            <include name="com/bdna/si/common/AutoConnection.class" />
            <include name="com/bdna/si/common/AutoConnection$$*.class" />
            <include name="com/bdna/si/metadata/ElementFactory.class" />
            <include name="com/bdna/si/metadata/ElementFactory$$*.class" />
            <include name="com/bdna/si/metadata/PackageFactory.class" />
            <include name="com/bdna/si/metadata/PackageFactory$$*.class" />
            <include name="com/bdna/si/udt/UDTUtil.class" />
            <include name="com/bdna/si/udt/GuardiumModulesUDT.class" />
            <include name="com/bdna/si/udt/IBMDB2FeaturesUDT.class" />
            <include name="com/bdna/si/udt/IBMDB2LicmListUDT.class" />
            <include name="com/bdna/ut/cla/claMessages/ResultCodes.class" />
            <include name="com/bdna/ut/xmlsax/BaseHandler.class" />
            <include name="com/bdna/ut/xmlsax/BaseHandler$$*.class" />
            <include name="com/bdna/app/metadata/eri/ERIGenerator.class" />
            <include name="com/bdna/app/metadata/eri/ERIGenerator$$*.class" />
            <include name="com/bdna/si/ac/User.class" />
            <include name="com/bdna/si/ac/User$$*.class" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.dist}/debug/classes">
        <fileset dir="${bdna.seq}/java/debug/classes">
            <include name="com/bdna/xsi/commands/CommandRunXform.class" />
            <include name="com/bdna/app/metadata/xsi/Project.class" />
            <include name="com/bdna/app/metadata/TableDef.class" />
            <include name="com/bdna/app/widget/JNavigation.class" />
            <include name="com/bdna/app/widget/JNavigation$$*.class" />
            <include name="com/bdna/app/widget/JDataAdmin.class" />
            <include name="com/bdna/app/widget/JDataAdmin$$*.class" />
            <include name="com/bdna/app/widget/JRoleEditor.class" />
            <include name="com/bdna/app/widget/JRoleEditor$$*.class" />
            <include name="com/bdna/app/metadata/ScanQuery.class" />
            <include name="com/bdna/app/metadata/ScanQuery$$*.class" />
            <include name="com/bdna/app/uiengine/SwingAppClient.class" />
            <include name="com/bdna/app/uiengine/SwingAppClient$$*.class" />
            <include name="com/bdna/bvl/dw/GlobalScan.class" />
            <include name="com/bdna/bvl/dw/GlobalScan$$*.class" />
            <include name="com/bdna/bvl/dw/CumulativeScanBuilder.class" />
            <include name="com/bdna/bvl/dw/CumulativeScanBuilder$$*.class" />
            <include name="com/bdna/si/common/AutoConnection.class" />
            <include name="com/bdna/si/common/AutoConnection$$*.class" />
            <include name="com/bdna/si/metadata/ElementFactory.class" />
            <include name="com/bdna/si/metadata/ElementFactory$$*.class" />
            <include name="com/bdna/si/metadata/PackageFactory.class" />
            <include name="com/bdna/si/metadata/PackageFactory$$*.class" />
            <include name="com/bdna/si/udt/UDTUtil.class" />
            <include name="com/bdna/ut/cla/claMessages/ResultCodes.class" />
            <include name="com/bdna/ut/xmlsax/BaseHandler.class" />
            <include name="com/bdna/ut/xmlsax/BaseHandler$$*.class" />
            <include name="com/bdna/app/metadata/eri/ERIGenerator.class" />
            <include name="com/bdna/app/metadata/eri/ERIGenerator$$*.class" />
            <include name="com/bdna/si/ac/User.class" />
            <include name="com/bdna/si/ac/User$$*.class" />
        </fileset>
    </copy>

    <!-- Update the contentExportTag element contents -->
    <replace file="${bdna.content.build}/modules/com/bdna/modules/common/DiscoveryBase.xml" value="${bdna.bcp.version}">
        <replacefilter token="@bdna.bcp.version@"/>
    </replace>
    <replace file="${bdna.content.build}/modules/com/bdna/modules/common/DiscoveryBase.xml" value="${bcp.build.number}">
        <replacefilter token="@bcp.build.number@"/>
    </replace>

    <delete file="${bdna.content.dist}/modules/com/bdna/bdna_content.bar"/>
    <jar
        jarfile="${bdna.content.dist}/modules/com/bdna/bdna_content.bar"
        basedir="${bdna.content.build}/modules" >
        <manifest>
            <attribute name="Built-By" value="${user.name}"/>
            <section name="common">
              <attribute name="BDNA_CONTENT_PACK_NAME" value="${bdna.BCP.Baseline.label}"/>
              <attribute name="BDNA_CONTENT_BUILD_DATE" value="${bdna.build.stamp}"/>
              <attribute name="BDNA_CONTENT_VERSION_NUMBER" value="${bdna.BCP.Baseline.version}"/>
              <attribute name="BDNA_CONTENT_BUILD_NUMBER" value="${bcp.build.number}"/>
            </section>
            <section name="common/class1.class">
              <attribute name="Sealed" value="false"/>
            </section>
        </manifest>
    </jar>

</target>


<target name="content_installkit_bcp_Baseline" depends="dist_bcp_Baseline">
    <delete file="${bdna.nightly_builds.this_build}/Baseline_${bdna.BCP.Baseline.version}_${bcp.build.number}.seq"/>
    <delete file="${bdna.nightly_builds}/Baseline_latest.seq"/>
    <jar
        jarfile="${bdna.nightly_builds.this_build}/Baseline_${bdna.BCP.Baseline.version}_${bcp.build.number}.seq"
        basedir="${bdna.content.dist}" >
    </jar>
    <copy file="${bdna.nightly_builds.this_build}/Baseline_${bdna.BCP.Baseline.version}_${bcp.build.number}.seq" tofile="${bdna.nightly_builds}/Baseline_latest.seq" />
</target>


<target name="prep_build_bcp_MicrosoftSoftware">
    <delete dir="${bdna.content.build}" />
    <mkdir dir="${bdna.content.build}/modules" />
    <mkdir dir="${bdna.content.build}/appframe" />
    <mkdir dir="${bdna.content.build}/appdata" />
</target>

<!--                                                        -->
<!--            Generate the fingerprint modules            -->
<!--                                                        -->
<target name="generate_bcp_MicrosoftSoftware" depends="prep_build_bcp_MicrosoftSoftware">

    <java
        classname="com.bdna.fingerprintTool.GenJiffyFP"
        classpathref="javac.classpath"
        failonerror="true"
        dir="${bdna.seq}/com/bdna/fingerprintTool/templates/jiffy"
        fork="yes" >
        <sysproperty key="bdna.home" value="${bdna.seq}"/>
        <sysproperty key="bdna.jiffy.noperlcheck" value="${bdna.jiffy.noperlcheck}" />
        <arg value="${bdna.seq}/com/bdna/fingerprintTool" />
        <arg value="${bdna.content.build}/modules" />
    </java>


    <!-- move the bdna modules, overwrite the generated version if any -->
    <copy todir="${bdna.content.build}/modules/">
        <fileset dir="${bdna.seq}/modules">
            <include name="com/bdna/modules/app/Microsoft/**" />
            <include name="com/bdna/modules/app/Microsoft.xml" />
            <include name="com/bdna/modules/app/PotentialWindows.xml" />
            <include name="com/bdna/modules/app/CPAWindows.xml" />
            <include name="com/bdna/modules/app/CPAMSSQL.xml" />
            <include name="com/bdna/modules/app/CPACommon.xml" />
            <include name="com/bdna/modules/common/ADMTypesAndAttrsDef.xml" />
            <include name="com/bdna/modules/database/MSSQLServer.xml" />
            <include name="com/bdna/modules/database/MSSQLServerL3.xml" />
            <include name="com/bdna/modules/os/Windows.xml" />
            <include name="com/bdna/modules/metadata/MicrosoftSoftwareFlags.xml" />
            <include name="**/*.properties" />
        </fileset>
    </copy>


    <copy todir="${bdna.content.build}/modules/com/bdna/presentationModules">
        <fileset dir="${bdna.seq}/modules/com/bdna/presentationModules">
            <include name="app/PotentialWindows.xml" />
            <include name="app/Microsoft/**" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.build}/modules/com/bdna/presentationModules">
        <fileset dir="${bdna.seq}/modules/com/bdna/presentationModules">
            <include name="database/MSSQLServer.xml" />
            <include name="database/MSSQLServerL3.xml" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.build}/modules/com/bdna/presentationModules">
        <fileset dir="${bdna.seq}/modules/com/bdna/presentationModules">
            <include name="os/AIX.xml" />
            <include name="os/Embedded.xml" />
            <include name="os/HPUX.xml" />
            <include name="os/IBMzOS.xml" />
            <include name="os/J2ME.xml" />
            <include name="os/Linux.xml" />
            <include name="os/MacOS.xml" />
            <include name="os/Netware.xml" />
            <include name="os/OracleVMServer.xml" />
            <include name="os/UNIX.xml" />
            <include name="os/VNwareESXServer.xml" />            
            <include name="os/Windows.xml" />
            <include name="os/WindowsL2.xml" />
            <include name="os/XenServer.xml" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.build}/modules/com/bdna/presentationModules">
        <fileset dir="${bdna.seq}/modules/com/bdna/presentationModules">
            <include name="common/*" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.build}/modules/com/bdna/presentationModules">
        <fileset dir="${bdna.seq}/modules/com/bdna/presentationModules">
            <include name="hardware/PrinterDiscovery.xml" />
        </fileset>
    </copy>


    <!-- copy the built-in application modules -->
    <copy todir="${bdna.content.build}/appframe/com/bdna/modules/appmeta">
        <fileset dir="${bdna.seq}/com/bdna/app/application">
            <include name="AppConsole.xml" />
            <include name="Folders.xml" />
            <include name="MarketData_SupportViews.xml" />
            <include name="MarketData.xml" />
            <include name="MicrosoftSoftwarePack.xml" />
            <include name="MSSQLDatabases.xml" />
            <include name="PublisherWin.xml" />
            <include name="PublisherUNIX.xml" />
            <include name="StandardApplication.xml" />
            <include name="WebServers.xml" />
        </fileset>
    </copy>

    <unzip src="${bdna.seq}/com/bdna/app/data/marketData-Common.zip" dest="${bdna.content.build}/appdata/" />
    <unzip src="${bdna.seq}/com/bdna/app/data/marketData-CPUcore.zip" dest="${bdna.content.build}/appdata/" />
    <unzip src="${bdna.seq}/com/bdna/app/data/marketData-MSApps.zip" dest="${bdna.content.build}/appdata/" />
    <unzip src="${bdna.seq}/com/bdna/app/data/marketData-WindowsL2.zip" dest="${bdna.content.build}/appdata/" />

    <copy todir="${bdna.content.build}/wincs/Scripts">
        <fileset dir="${bdna.seq}/wincs/Scripts">
            <include name="*.cs" />
        </fileset>
    </copy>

    <copy tofile="${bdna.content.build}/schema/bdna.dtd" file="${bdna.seq}/schema/bdna.dtd" />

    <!-- Insert Windows scripts into XML modules -->
    <java
        classname="com.bdna.fingerprintTool.ModulesTransformer"
        classpathref="javac.classpath"
        failonerror="true"
        dir="${bdna.content.build}/modules"
        fork="yes" >
        <sysproperty key="bdna.home" value="${bdna.seq}"/>
        <arg value="${bdna.content.build}" />
        <arg value="${bdna.content.build}" />
    </java>

    <copy todir="${bdna.content.build}/presentation">
        <fileset dir="${bdna.src}/presentation">
            <include name="**/*.xml" />
            <include name="**/*.properties" />
        </fileset>
    </copy>

</target>


<!--                                                        -->
<!--            Prepare the distribution directories        -->
<!--                                                        -->
<target name="prep_dist_bcp_MicrosoftSoftware">
    <delete dir="${bdna.content.dist}" />
    <mkdir dir="${bdna.content.dist}/modules" />
    <mkdir dir="${bdna.content.dist}/modules/com" />
    <mkdir dir="${bdna.content.dist}/modules/com/bdna" />
    <mkdir dir="${bdna.content.dist}/appdata" />
    <mkdir dir="${bdna.content.dist}/appframe" />
    <mkdir dir="${bdna.content.dist}/MANIFEST" />
    <mkdir dir="${bdna.content.dist}/upgrade" />
</target>


<target name="dist_bcp_MicrosoftSoftware"  depends="init, generate_bcp_MicrosoftSoftware, prep_dist_bcp_MicrosoftSoftware">

    <copy file="${bdna.seq}/content/manifests/MicrosoftSoftwareManifest.xml" todir="${bdna.content.dist}/MANIFEST" />
    <copy file="${bdna.seq}/content/upgrade/upgrade.xml" tofile="${bdna.content.dist}/upgrade/upgrade.xml" />
    <copy file="${bdna.seq}/content/upgrade/upgrade.sh" tofile="${bdna.content.dist}/upgrade/upgrade.sh" />
    <copy file="${bdna.seq}/content/upgrade/pubTablesCleanup.sql" tofile="${bdna.content.dist}/upgrade/pubTablesCleanup.sql" />
    <copy file="${bdna.seq}/content/upgrade/removeMD_dups.sql" tofile="${bdna.content.dist}/upgrade/removeMD_dups.sql" />
    <copy file="${bdna.seq}/content/upgrade/upgradeContentReports.xml" tofile="${bdna.content.dist}/upgrade/upgradeContentReports.xml" />

    <copy file="${bdna.seq}/com/bdna/app/widget/WidgetLibrary.xml" todir="${bdna.content.dist}/appframe/com/bdna/modules/appmeta" />
    <copy file="${bdna.seq}/com/bdna/app/uiengine/HTMLEngineWidgetLibrary.xml" todir="${bdna.content.dist}/appframe/com/bdna/modules/appmeta" />
    <copy file="${bdna.seq}/com/bdna/app/uiengine/SwingEngineWidgetLibrary.xml" todir="${bdna.content.dist}/appframe/com/bdna/modules/appmeta" />

    <replace file="${bdna.content.dist}/MANIFEST/MicrosoftSoftwareManifest.xml" value="${bdna.bcp.version}">
        <replacefilter token="@bdna.bcp.version@"/>
    </replace>

    <copy todir="${bdna.content.dist}/appdata">
        <fileset dir="${bdna.content.build}/appdata">
            <include name="**" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.dist}/appframe">
        <fileset dir="${bdna.content.build}/appframe">
            <include name="**" />
        </fileset>
    </copy>

<fileset id="MicrosoftSoftware_modules" dir="${bdna.content.build}/modules">
            <include name="com/bdna/modules/app/Microsoft/**" />
            <include name="com/bdna/modules/app/Microsoft.xml" />
            <include name="com/bdna/modules/app/PotentialWindows.xml" />
            <include name="com/bdna/modules/app/CPAWindows.xml" />
            <include name="com/bdna/modules/app/CPAMSSQL.xml" />
            <include name="com/bdna/modules/app/CPACommon.xml" />
            <include name="com/bdna/modules/common/ADMTypesAndAttrsDef.xml" />
            <include name="com/bdna/modules/database/MSSQLServer.xml" />
            <include name="com/bdna/modules/database/MSSQLServerL3.xml" />
            <include name="com/bdna/modules/os/Windows.xml" />
            <include name="com/bdna/modules/metadata/MicrosoftSoftwareFlags.xml" />
            <include name="**/*.properties" />
            <include name="com/bdna/presentationModules/app/PotentialWindows.xml" />
            <include name="com/bdna/presentationModules/app/Microsoft/**" />
            <include name="com/bdna/presentationModules/database/MSSQLServer.xml" />
            <include name="com/bdna/presentationModules/database/MSSQLServerL3.xml" />
            <include name="com/bdna/presentationModules/common/*" />
            <include name="com/bdna/presentationModules/hardware/PrinterDiscovery.xml" />
            <include name="com/bdna/presentationModules/os/AIX.xml" />
            <include name="com/bdna/presentationModules/os/Embedded.xml" />
            <include name="com/bdna/presentationModules/os/HPUX.xml" />
            <include name="com/bdna/presentationModules/os/IBMzOS.xml" />
            <include name="com/bdna/presentationModules/os/J2ME.xml" />
            <include name="com/bdna/presentationModules/os/Linux.xml" />
            <include name="com/bdna/presentationModules/os/MacOS.xml" />
            <include name="com/bdna/presentationModules/os/Netware.xml" />
            <include name="com/bdna/presentationModules/os/OracleVMServer.xml" />
            <include name="com/bdna/presentationModules/os/UNIX.xml" />
            <include name="com/bdna/presentationModules/os/VNwareESXServer.xml" />            
            <include name="com/bdna/presentationModules/os/Windows.xml" />
            <include name="com/bdna/presentationModules/os/WindowsL2.xml" />
            <include name="com/bdna/presentationModules/os/XenServer.xml" />
</fileset>



    <delete file="${bdna.content.dist}/modules/com/bdna/bdna_content.bar"/>
    <jar
        jarfile="${bdna.content.dist}/modules/com/bdna/bdna_content.bar"
        >
        <fileset refid="MicrosoftSoftware_modules"/>

        <manifest>
            <attribute name="Built-By" value="${user.name}"/>
            <section name="common">
              <attribute name="BDNA_CONTENT_PACK_NAME" value="${bdna.BCP.MicrosoftSoftware.label}"/>
              <attribute name="BDNA_CONTENT_BUILD_DATE" value="${bdna.content.build.stamp}"/>
              <attribute name="BDNA_CONTENT_VERSION_NUMBER" value="${bdna.BCP.MicrosoftSoftware.version}"/>
              <attribute name="BDNA_CONTENT_BUILD_NUMBER" value="${bcp.build.number}"/>
            </section>
            <section name="common/class1.class">
              <attribute name="Sealed" value="false"/>
            </section>
        </manifest>
    </jar>

</target>



<target name="content_installkit_bcp_MicrosoftSoftware" depends="dist_bcp_MicrosoftSoftware">
    <delete file="${bdna.nightly_builds.this_build}/MicrosoftSoftware_${bdna.BCP.MicrosoftSoftware.version}_${bcp.build.number}.seq"/>
    <delete file="${bdna.nightly_builds}/MicrosoftSoftware_latest.seq"/>

    <jar
        jarfile="${bdna.nightly_builds.this_build}/MicrosoftSoftware_${bdna.BCP.MicrosoftSoftware.version}_${bcp.build.number}.seq" 
        basedir="${bdna.content.dist}">
    </jar>
    <copy file="${bdna.nightly_builds.this_build}/MicrosoftSoftware_${bdna.BCP.MicrosoftSoftware.version}_${bcp.build.number}.seq" tofile="${bdna.nightly_builds}/MicrosoftSoftware_latest.seq" />
</target>


<target name="prep_build_bcp_IBMHardware">
    <delete dir="${bdna.content.build}" />
    <mkdir dir="${bdna.content.build}/modules" />
    <mkdir dir="${bdna.content.build}/appframe" />
    <mkdir dir="${bdna.content.build}/appdata" />
</target>

<!--                                                        -->
<!--            Generate the fingerprint modules            -->
<!--                                                        -->
<target name="generate_bcp_IBMHardware" depends="prep_build_bcp_IBMHardware">

    <!-- move the bdna modules, overwrite the generated version if any -->
    <copy todir="${bdna.content.build}/modules/">
        <fileset dir="${bdna.seq}/modules">
            <include name="com/bdna/modules/app/CleanupBDNATrace.xml" />
            <include name="com/bdna/modules/app/PotentialWindows.xml" />
            <include name="com/bdna/modules/app/procCleanup.xml" />
            <include name="com/bdna/modules/app/CPAWindows.xml" />
            <include name="com/bdna/modules/app/CPAUNIX.xml" />
            <include name="com/bdna/modules/app/CPACommon.xml" />
            <include name="com/bdna/modules/common/Discovery.xml" />
            <include name="com/bdna/modules/common/DisableUNIXProcessDepList.xml" />
            <include name="com/bdna/modules/common/SNMP.xml" />
            <include name="com/bdna/modules/common/ILOM.xml" />
            <include name="com/bdna/modules/hardware/IBMFabricSwitchDiscovery.xml" />
            <include name="com/bdna/modules/os/AIX.xml" />
            <include name="com/bdna/modules/os/HPUX.xml" />
            <include name="com/bdna/modules/os/IRIX.xml" />
            <include name="com/bdna/modules/os/Linux.xml" />
            <include name="com/bdna/modules/os/Solaris.xml" />
            <include name="com/bdna/modules/os/Tru64.xml" />
            <include name="com/bdna/modules/os/UNIX.xml" />
            <include name="com/bdna/modules/os/Windows.xml" />
            <include name="com/bdna/modules/metadata/IBMHardwareFlags.xml" />
            <include name="**/*.properties" />
        </fileset>
    </copy>


    <copy todir="${bdna.content.build}/modules/com/bdna/presentationModules">
        <fileset dir="${bdna.seq}/modules/com/bdna/presentationModules">
            <include name="app/PotentialWindows.xml" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.build}/modules/com/bdna/presentationModules">
        <fileset dir="${bdna.seq}/modules/com/bdna/presentationModules">
            <include name="os/AIX.xml" />
            <include name="os/Embedded.xml" />
            <include name="os/HPUX.xml" />
            <include name="os/IBMzOS.xml" />
            <include name="os/J2ME.xml" />
            <include name="os/Linux.xml" />
            <include name="os/MacOS.xml" />
            <include name="os/Netware.xml" />
            <include name="os/OracleVMServer.xml" />
            <include name="os/UNIX.xml" />
            <include name="os/VNwareESXServer.xml" />            
            <include name="os/Windows.xml" />
            <include name="os/WindowsL2.xml" />
            <include name="os/XenServer.xml" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.build}/modules/com/bdna/presentationModules">
        <fileset dir="${bdna.seq}/modules/com/bdna/presentationModules">
            <include name="common/*" />
            <exclude name="common/ADMTypesAndAttrsDef.xml" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.build}/modules/com/bdna/presentationModules">
        <fileset dir="${bdna.seq}/modules/com/bdna/presentationModules">
            <include name="hardware/PrinterDiscovery.xml" />
        </fileset>
    </copy>


    <!-- copy the built-in application modules -->
    <copy todir="${bdna.content.build}/appframe/com/bdna/modules/appmeta">
        <fileset dir="${bdna.seq}/com/bdna/app/application">
            <include name="AppConsole.xml" />
            <include name="IBMHardwarePack.xml" />
            <include name="Folders.xml" />
            <include name="MarketData_SupportViews.xml" />
            <include name="MarketData.xml" />
            <include name="PublisherNIC.xml" />
            <include name="PublisherUNIX.xml" />
            <include name="StandardApplication.xml" />
        </fileset>
    </copy>

    <unzip src="${bdna.seq}/com/bdna/app/data/marketData-Common.zip" dest="${bdna.content.build}/appdata/" />
    <unzip src="${bdna.seq}/com/bdna/app/data/marketData-CPUcore.zip" dest="${bdna.content.build}/appdata/" />
    <unzip src="${bdna.seq}/com/bdna/app/data/marketData-IBMHW.zip" dest="${bdna.content.build}/appdata/" />
    <unzip src="${bdna.seq}/com/bdna/app/data/marketData-UNIXL2.zip" dest="${bdna.content.build}/appdata/" />
    <unzip src="${bdna.seq}/com/bdna/app/data/marketData-WindowsL2.zip" dest="${bdna.content.build}/appdata/" />

     <!-- Insert Windows scripts into XML modules -->
     <java
         classname="com.bdna.fingerprintTool.ModulesTransformer"
         classpathref="javac.classpath"
         failonerror="true"
         dir="${bdna.seq}/modules"
         fork="yes" >
         <sysproperty key="bdna.home" value="${bdna.seq}"/>
         <arg value="${bdna.seq}" />
         <arg value="${bdna.content.build}" />
     </java>


    <copy todir="${bdna.content.build}/presentation">
        <fileset dir="${bdna.src}/presentation">
            <include name="**/*.xml" />
            <include name="**/*.properties" />
        </fileset>
    </copy>

</target>


<!--                                                        -->
<!--            Prepare the distribution directories        -->
<!--                                                        -->
<target name="prep_dist_bcp_IBMHardware">
    <delete dir="${bdna.content.dist}" />
    <mkdir dir="${bdna.content.dist}/modules" />
    <mkdir dir="${bdna.content.dist}/modules/com" />
    <mkdir dir="${bdna.content.dist}/modules/com/bdna" />
    <mkdir dir="${bdna.content.dist}/appdata" />
    <mkdir dir="${bdna.content.dist}/appframe" />
    <mkdir dir="${bdna.content.dist}/MANIFEST" />
    <mkdir dir="${bdna.content.dist}/upgrade" />
</target>


<target name="dist_bcp_IBMHardware"  depends="init, generate_bcp_IBMHardware, prep_dist_bcp_IBMHardware">

    <copy file="${bdna.seq}/content/manifests/IBMHardwareManifest.xml" todir="${bdna.content.dist}/MANIFEST" />

    <copy file="${bdna.seq}/content/upgrade/upgrade.xml" tofile="${bdna.content.dist}/upgrade/upgrade.xml" />
    <copy file="${bdna.seq}/content/upgrade/upgrade.sh" tofile="${bdna.content.dist}/upgrade/upgrade.sh" />
    <copy file="${bdna.seq}/content/upgrade/pubTablesCleanup.sql" tofile="${bdna.content.dist}/upgrade/pubTablesCleanup.sql" />
    <copy file="${bdna.seq}/content/upgrade/removeMD_dups.sql" tofile="${bdna.content.dist}/upgrade/removeMD_dups.sql" />
    <copy file="${bdna.seq}/content/upgrade/upgradeContentReports.xml" tofile="${bdna.content.dist}/upgrade/upgradeContentReports.xml" />

    <copy file="${bdna.seq}/com/bdna/app/widget/WidgetLibrary.xml" todir="${bdna.content.dist}/appframe/com/bdna/modules/appmeta" />
    <copy file="${bdna.seq}/com/bdna/app/uiengine/HTMLEngineWidgetLibrary.xml" todir="${bdna.content.dist}/appframe/com/bdna/modules/appmeta" />
    <copy file="${bdna.seq}/com/bdna/app/uiengine/SwingEngineWidgetLibrary.xml" todir="${bdna.content.dist}/appframe/com/bdna/modules/appmeta" />

    <replace file="${bdna.content.dist}/MANIFEST/IBMHardwareManifest.xml" value="${bdna.bcp.version}">
        <replacefilter token="@bdna.bcp.version@"/>
    </replace>

    <copy todir="${bdna.content.dist}/appdata">
        <fileset dir="${bdna.content.build}/appdata">
            <include name="**" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.dist}/appframe">
        <fileset dir="${bdna.content.build}/appframe">
            <include name="**" />
        </fileset>
    </copy>

<fileset id="IBMHardware_modules" dir="${bdna.content.build}/modules">
            <include name="com/bdna/modules/app/CleanupBDNATrace.xml" />
            <include name="com/bdna/modules/app/PotentialWindows.xml" />
            <include name="com/bdna/modules/app/procCleanup.xml" />
            <include name="com/bdna/modules/app/CPAWindows.xml" />
            <include name="com/bdna/modules/app/CPAUNIX.xml" />
            <include name="com/bdna/modules/app/CPACommon.xml" />
            <include name="com/bdna/modules/common/Discovery.xml" />
            <include name="com/bdna/modules/common/DisableUNIXProcessDepList.xml" />
            <include name="com/bdna/modules/common/SNMP.xml" />
            <include name="com/bdna/modules/common/ILOM.xml" />
            <include name="com/bdna/modules/hardware/IBMFabricSwitchDiscovery.xml" />
            <include name="com/bdna/modules/os/AIX.xml" />
            <include name="com/bdna/modules/os/HPUX.xml" />
            <include name="com/bdna/modules/os/IRIX.xml" />
            <include name="com/bdna/modules/os/Linux.xml" />
            <include name="com/bdna/modules/os/Solaris.xml" />
            <include name="com/bdna/modules/os/Tru64.xml" />
            <include name="com/bdna/modules/os/UNIX.xml" />
            <include name="com/bdna/modules/os/Windows.xml" />
            <include name="com/bdna/modules/metadata/IBMHardwareFlags.xml" />
            <include name="**/*.properties" />
            <include name="com/bdna/presentationModules/os/WindowsL2.xml" />
            <include name="com/bdna/presentationModules/app/PotentialWindows.xml" />
            <include name="com/bdna/presentationModules/common/*" />
            <include name="com/bdna/presentationModules/hardware/PrinterDiscovery.xml" />
            <include name="com/bdna/presentationModules/os/AIX.xml" />
            <include name="com/bdna/presentationModules/os/Embedded.xml" />
            <include name="com/bdna/presentationModules/os/HPUX.xml" />
            <include name="com/bdna/presentationModules/os/IBMzOS.xml" />
            <include name="com/bdna/presentationModules/os/J2ME.xml" />
            <include name="com/bdna/presentationModules/os/Linux.xml" />
            <include name="com/bdna/presentationModules/os/MacOS.xml" />
            <include name="com/bdna/presentationModules/os/Netware.xml" />
            <include name="com/bdna/presentationModules/os/OracleVMServer.xml" />
            <include name="com/bdna/presentationModules/os/UNIX.xml" />
            <include name="com/bdna/presentationModules/os/VNwareESXServer.xml" />            
            <include name="com/bdna/presentationModules/os/Windows.xml" />
            <include name="com/bdna/presentationModules/os/WindowsL2.xml" />
            <include name="com/bdna/presentationModules/os/XenServer.xml" />
</fileset>



    <delete file="${bdna.content.dist}/modules/com/bdna/bdna_content.bar"/>
    <jar
        jarfile="${bdna.content.dist}/modules/com/bdna/bdna_content.bar"
        >
        <fileset refid="IBMHardware_modules"/>

        <manifest>
            <attribute name="Built-By" value="${user.name}"/>
            <section name="common">
              <attribute name="BDNA_CONTENT_PACK_NAME" value="${bdna.BCP.IBMHardware.label}"/>
              <attribute name="BDNA_CONTENT_BUILD_DATE" value="${bdna.content.build.stamp}"/>
              <attribute name="BDNA_CONTENT_VERSION_NUMBER" value="${bdna.BCP.IBMHardware.version}"/>
              <attribute name="BDNA_CONTENT_BUILD_NUMBER" value="${bcp.build.number}"/>
            </section>
            <section name="common/class1.class">
              <attribute name="Sealed" value="false"/>
            </section>
        </manifest>
    </jar>

</target>

<target name="content_installkit_bcp_IBMHardware" depends="dist_bcp_IBMHardware">
    <delete file="${bdna.nightly_builds.this_build}/IBMHardware_${bdna.BCP.IBMHardware.version}_${bcp.build.number}.seq"/>
    <delete file="${bdna.nightly_builds}/IBMHardware_latest.seq"/>

    <jar
        destfile="${bdna.nightly_builds.this_build}/IBMHardware_${bdna.BCP.IBMHardware.version}_${bcp.build.number}.seq"
        basedir="${bdna.content.dist}" >
    </jar>
    <copy file="${bdna.nightly_builds.this_build}/IBMHardware_${bdna.BCP.IBMHardware.version}_${bcp.build.number}.seq" tofile="${bdna.nightly_builds}/IBMHardware_latest.seq" />
</target>


<target name="prep_build_bcp_IBMSoftware">
    <delete dir="${bdna.content.build}" />
    <mkdir dir="${bdna.content.build}/modules" />
    <mkdir dir="${bdna.content.build}/appframe" />
    <mkdir dir="${bdna.content.build}/appdata" />
</target>

<!--                                                        -->
<!--            Generate the fingerprint modules            -->
<!--                                                        -->
<target name="generate_bcp_IBMSoftware" depends="prep_build_bcp_IBMSoftware">

    <java
        classname="com.bdna.fingerprintTool.GenJiffyFP"
        classpathref="javac.classpath"
        failonerror="true"
        dir="${bdna.seq}/com/bdna/fingerprintTool/templates/jiffy"
        fork="yes" >
        <sysproperty key="bdna.home" value="${bdna.seq}"/>
        <sysproperty key="bdna.jiffy.noperlcheck" value="${bdna.jiffy.noperlcheck}" />
        <arg value="${bdna.seq}/com/bdna/fingerprintTool" />
        <arg value="${bdna.content.build}/modules" />
    </java>


    <!-- move the bdna modules, overwrite the generated version if any -->
    <copy todir="${bdna.content.build}/modules/">
        <fileset dir="${bdna.seq}/modules">
            <include name="com/bdna/modules/app/AIXLogicalVolumeManager.xml" />
            <include name="com/bdna/modules/app/CleanupBDNATrace.xml" />
            <include name="com/bdna/modules/app/LicenseServer.xml" />
            <include name="com/bdna/modules/app/PotentialWindows.xml" />
            <include name="com/bdna/modules/app/Microsoft/MicrosoftIIS.xml" />
            <include name="com/bdna/modules/app/procCleanup.xml" />
            <include name="com/bdna/modules/app/IBM.xml" />
            <include name="com/bdna/modules/app/IBM/**" />
            <include name="com/bdna/modules/app/Applix.xml" />
            <include name="com/bdna/modules/app/Applix/**" />
            <include name="com/bdna/modules/app/Cognos.xml" />
            <include name="com/bdna/modules/app/Cognos/**" />
            <include name="com/bdna/modules/app/ILOG.xml" />
            <include name="com/bdna/modules/app/ILOG/**" />
            <include name="com/bdna/modules/app/InternetSecuritySystem.xml" />
            <include name="com/bdna/modules/app/InternetSecuritySystem/Internet_Scanner.xml" />
            <include name="com/bdna/modules/app/InternetSecuritySystem/UNIX_InternetScanner.xml" />
            <include name="com/bdna/modules/app/Telelogic.xml" />
            <include name="com/bdna/modules/app/Telelogic/**" />
            <include name="com/bdna/modules/app/TelelogicTau.xml" />
            <include name="com/bdna/modules/app/CPAWindows.xml" />
            <include name="com/bdna/modules/app/CPAUNIX.xml" />
            <include name="com/bdna/modules/app/CPACommon.xml" />
            <include name="com/bdna/modules/common/ADMTypesAndAttrsDef.xml" />
            <include name="com/bdna/modules/common/Discovery.xml" />
            <include name="com/bdna/modules/common/DisableUNIXProcessDepList.xml" />
            <include name="com/bdna/modules/common/SNMP.xml" />
            <include name="com/bdna/modules/common/ILOM.xml" />
            <include name="com/bdna/modules/database/DB2.xml" />
            <include name="com/bdna/modules/database/Informix.xml" />
            <include name="com/bdna/modules/database/WindowsDB2Installation.xml" />
            <include name="com/bdna/modules/database/UNIXDB2.xml" />
            <include name="com/bdna/modules/database/UNIXInformixOnline.xml" />
            <include name="com/bdna/modules/os/AIX.xml" />
            <include name="com/bdna/modules/os/HPUX.xml" />
            <include name="com/bdna/modules/os/IRIX.xml" />
            <include name="com/bdna/modules/os/Linux.xml" />
            <include name="com/bdna/modules/os/Solaris.xml" />
            <include name="com/bdna/modules/os/Tru64.xml" />
            <include name="com/bdna/modules/os/UNIX.xml" />
            <include name="com/bdna/modules/os/Windows.xml" />
            <include name="com/bdna/modules/metadata/IBMSoftwareFlags.xml" />
            <include name="**/*.properties" />
        </fileset>
    </copy>


    <copy todir="${bdna.content.build}/modules/com/bdna/presentationModules">
        <fileset dir="${bdna.seq}/modules/com/bdna/presentationModules">
            <include name="app/PotentialWindows.xml" />
            <include name="app/AIXLogicalVolumeManager.xml" />
            <include name="app/IBM/**" />
            <include name="app/Applix/**" />
            <include name="app/Cognos/**" />
            <include name="app/ILOG/**" />
            <include name="app/InternetSecuritySystem/**" />
            <include name="app/Telelogic/**" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.build}/modules/com/bdna/presentationModules">
        <fileset dir="${bdna.seq}/modules/com/bdna/presentationModules">
            <include name="database/DB2.xml" />
            <include name="database/UNIXInformixOnline.xml" />
        </fileset>
    </copy>


    <copy todir="${bdna.content.build}/modules/com/bdna/presentationModules">
        <fileset dir="${bdna.seq}/modules/com/bdna/presentationModules">
            <include name="os/AIX.xml" />
            <include name="os/Embedded.xml" />
            <include name="os/HPUX.xml" />
            <include name="os/IBMzOS.xml" />
            <include name="os/J2ME.xml" />
            <include name="os/Linux.xml" />
            <include name="os/MacOS.xml" />
            <include name="os/Netware.xml" />
            <include name="os/OracleVMServer.xml" />
            <include name="os/UNIX.xml" />
            <include name="os/VNwareESXServer.xml" />            
            <include name="os/Windows.xml" />
            <include name="os/WindowsL2.xml" />
            <include name="os/XenServer.xml" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.build}/modules/com/bdna/presentationModules">
        <fileset dir="${bdna.seq}/modules/com/bdna/presentationModules">
            <include name="common/*" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.build}/modules/com/bdna/presentationModules">
        <fileset dir="${bdna.seq}/modules/com/bdna/presentationModules">
            <include name="hardware/PrinterDiscovery.xml" />
        </fileset>
    </copy>


    <!-- copy the built-in application modules -->
    <copy todir="${bdna.content.build}/appframe/com/bdna/modules/appmeta">
        <fileset dir="${bdna.seq}/com/bdna/app/application">
            <include name="AppConsole.xml" />
            <include name="DB2Databases.xml" />
            <include name="Guardium_Modules.xml" />
            <include name="IBMApplications.xml" />
            <include name="IBMSoftwarePack.xml" />
            <include name="InformixDatabases.xml" />
            <include name="MarketData_SupportViews.xml" />
            <include name="MarketData.xml" />
            <include name="PublisherIBM.xml" />
            <include name="PublisherWebServers.xml" />
            <include name="StandardApplication.xml" />
            <include name="WebServers.xml" />
            <include name="WebSphere.xml" />
            <include name="WebSphereMQ.xml" />
            <include name="Folders.xml" />
        </fileset>
    </copy>


    <unzip src="${bdna.seq}/com/bdna/app/data/marketData-Common.zip" dest="${bdna.content.build}/appdata/" />
    <unzip src="${bdna.seq}/com/bdna/app/data/marketData-CPUcore.zip" dest="${bdna.content.build}/appdata/" />
    <unzip src="${bdna.seq}/com/bdna/app/data/marketData-IBMSW.zip" dest="${bdna.content.build}/appdata/" />
    <unzip src="${bdna.seq}/com/bdna/app/data/marketData-UNIXL2.zip" dest="${bdna.content.build}/appdata/" />
    <unzip src="${bdna.seq}/com/bdna/app/data/marketData-WindowsL2.zip" dest="${bdna.content.build}/appdata/" />

     <!-- Insert Windows scripts into XML modules -->
     <java
         classname="com.bdna.fingerprintTool.ModulesTransformer"
         classpathref="javac.classpath"
         failonerror="true"
         dir="${bdna.seq}/modules"
         fork="yes" >
         <sysproperty key="bdna.home" value="${bdna.seq}"/>
         <arg value="${bdna.seq}" />
         <arg value="${bdna.content.build}" />
     </java>


    <copy todir="${bdna.content.build}/presentation">
        <fileset dir="${bdna.src}/presentation">
            <include name="**/*.xml" />
            <include name="**/*.properties" />
        </fileset>
    </copy>

</target>


<!--                                                        -->
<!--            Prepare the distribution directories        -->
<!--                                                        -->
<target name="prep_dist_bcp_IBMSoftware">
    <delete dir="${bdna.content.dist}" />
    <mkdir dir="${bdna.content.dist}/modules" />
    <mkdir dir="${bdna.content.dist}/modules/com" />
    <mkdir dir="${bdna.content.dist}/modules/com/bdna" />
    <mkdir dir="${bdna.content.dist}/appdata" />
    <mkdir dir="${bdna.content.dist}/appframe" />
    <mkdir dir="${bdna.content.dist}/MANIFEST" />
    <mkdir dir="${bdna.content.dist}/upgrade" />
</target>

<target name="dist_bcp_IBMSoftware" depends="init, generate_bcp_IBMSoftware, prep_dist_bcp_IBMSoftware, ui_engine_library">

    <copy file="${bdna.seq}/content/manifests/IBMSoftwareManifest.xml" todir="${bdna.content.dist}/MANIFEST" />

    <copy file="${bdna.seq}/content/upgrade/upgrade.xml" tofile="${bdna.content.dist}/upgrade/upgrade.xml" />
    <copy file="${bdna.seq}/content/upgrade/upgrade.sh" tofile="${bdna.content.dist}/upgrade/upgrade.sh" />
    <copy file="${bdna.seq}/content/upgrade/pubTablesCleanup.sql" tofile="${bdna.content.dist}/upgrade/pubTablesCleanup.sql" />
    <copy file="${bdna.seq}/content/upgrade/removeMD_dups.sql" tofile="${bdna.content.dist}/upgrade/removeMD_dups.sql" />
    <copy file="${bdna.seq}/content/upgrade/upgradeContentReports.xml" tofile="${bdna.content.dist}/upgrade/upgradeContentReports.xml" />

    <replace file="${bdna.content.dist}/MANIFEST/IBMSoftwareManifest.xml" value="${bdna.bcp.version}">
        <replacefilter token="@bdna.bcp.version@"/>
    </replace>

    <replace file="${bdna.content.dist}/upgrade/upgrade.sh" value="${bdna.bcp.version}">
        <replacefilter token="@bdna.bcp.version@"/>
    </replace>
    <replace file="${bdna.content.dist}/upgrade/upgrade.sh" value="${bcp.build.number}">
        <replacefilter token="@bcp.build.number@"/>
    </replace>

    <copy file="${bdna.seq}/com/bdna/app/widget/WidgetLibrary.xml" todir="${bdna.content.dist}/appframe/com/bdna/modules/appmeta" />
    <copy file="${bdna.seq}/com/bdna/app/uiengine/HTMLEngineWidgetLibrary.xml" todir="${bdna.content.dist}/appframe/com/bdna/modules/appmeta" />
    <copy file="${bdna.seq}/com/bdna/app/uiengine/SwingEngineWidgetLibrary.xml" todir="${bdna.content.dist}/appframe/com/bdna/modules/appmeta" />


    <copy todir="${bdna.content.dist}/appdata">
        <fileset dir="${bdna.content.build}/appdata">
            <include name="**" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.dist}/appframe">
        <fileset dir="${bdna.content.build}/appframe">
            <include name="**" />
        </fileset>
    </copy>

<fileset id="IBMSoftware_modules" dir="${bdna.content.build}/modules">
            <include name="com/bdna/modules/app/AIXLogicalVolumeManager.xml" />
            <include name="com/bdna/modules/app/CleanupBDNATrace.xml" />
            <include name="com/bdna/modules/app/IBM/**" />
            <include name="com/bdna/modules/app/IBM.xml" />
            <include name="com/bdna/modules/app/CPAWindows.xml" />
            <include name="com/bdna/modules/app/CPAUNIX.xml" />
            <include name="com/bdna/modules/app/CPACommon.xml" />
            <include name="com/bdna/modules/app/Applix.xml" />
            <include name="com/bdna/modules/app/Applix/**" />
            <include name="com/bdna/modules/app/Cognos.xml" />
            <include name="com/bdna/modules/app/Cognos/**" />
            <include name="com/bdna/modules/app/ILOG.xml" />
            <include name="com/bdna/modules/app/ILOG/**" />
            <include name="com/bdna/modules/app/InternetSecuritySystem.xml" />
            <include name="com/bdna/modules/app/InternetSecuritySystem/Internet_Scanner.xml" />
            <include name="com/bdna/modules/app/InternetSecuritySystem/UNIX_InternetScanner.xml" />
            <include name="com/bdna/modules/app/Telelogic.xml" />
            <include name="com/bdna/modules/app/Telelogic/**" />
            <include name="com/bdna/modules/app/TelelogicTau.xml" />
            <include name="com/bdna/modules/app/LicenseServer.xml" />
            <include name="com/bdna/modules/app/PotentialWindows.xml" />
            <include name="com/bdna/modules/app/procCleanup.xml" />
            <include name="com/bdna/modules/app/Microsoft/MicrosoftIIS.xml" />
            <include name="com/bdna/modules/common/ADMTypesAndAttrsDef.xml" />
            <include name="com/bdna/modules/common/Discovery.xml" />
            <include name="com/bdna/modules/common/DisableUNIXProcessDepList.xml" />
            <include name="com/bdna/modules/common/SNMP.xml" />
            <include name="com/bdna/modules/common/ILOM.xml" />
            <include name="com/bdna/modules/database/DB2.xml" />
            <include name="com/bdna/modules/database/Informix.xml" />
            <include name="com/bdna/modules/database/UNIXDB2.xml" />
            <include name="com/bdna/modules/database/UNIXInformixOnline.xml" />
            <include name="com/bdna/modules/database/WindowsDB2Installation.xml" />
            <include name="com/bdna/modules/os/AIX.xml" />
            <include name="com/bdna/modules/os/HPUX.xml" />
            <include name="com/bdna/modules/os/IRIX.xml" />
            <include name="com/bdna/modules/os/Linux.xml" />
            <include name="com/bdna/modules/os/Solaris.xml" />
            <include name="com/bdna/modules/os/Tru64.xml" />
            <include name="com/bdna/modules/os/UNIX.xml" />
            <include name="com/bdna/modules/os/Windows.xml" />
            <include name="com/bdna/modules/metadata/IBMSoftwareFlags.xml" />
            <include name="com/bdna/presentationModules/app/PotentialWindows.xml" />
            <include name="com/bdna/presentationModules/app/AIXLogicalVolumeManager.xml" />
            <include name="com/bdna/presentationModules/app/IBM/**" />
            <include name="com/bdna/presentationModules/database/DB2.xml" />
            <include name="com/bdna/presentationModules/database/UNIXInformixOnline.xml" />
            <include name="com/bdna/presentationModules/common/*" />
            <include name="com/bdna/presentationModules/hardware/PrinterDiscovery.xml" />
            <include name="com/bdna/presentationModules/os/AIX.xml" />
            <include name="com/bdna/presentationModules/os/Embedded.xml" />
            <include name="com/bdna/presentationModules/os/HPUX.xml" />
            <include name="com/bdna/presentationModules/os/IBMzOS.xml" />
            <include name="com/bdna/presentationModules/os/J2ME.xml" />
            <include name="com/bdna/presentationModules/os/Linux.xml" />
            <include name="com/bdna/presentationModules/os/MacOS.xml" />
            <include name="com/bdna/presentationModules/os/Netware.xml" />
            <include name="com/bdna/presentationModules/os/OracleVMServer.xml" />
            <include name="com/bdna/presentationModules/os/UNIX.xml" />
            <include name="com/bdna/presentationModules/os/VNwareESXServer.xml" />            
            <include name="com/bdna/presentationModules/os/Windows.xml" />
            <include name="com/bdna/presentationModules/os/WindowsL2.xml" />
            <include name="com/bdna/presentationModules/os/XenServer.xml" />
            <include name="**/*.properties" />
</fileset>


    <delete file="${bdna.content.dist}/modules/com/bdna/bdna_content.bar"/>
    <jar
        jarfile="${bdna.content.dist}/modules/com/bdna/bdna_content.bar"
        >
        <fileset refid="IBMSoftware_modules"/>

        <manifest>
            <attribute name="Built-By" value="${user.name}"/>
            <section name="common">
              <attribute name="BDNA_CONTENT_PACK_NAME" value="${bdna.BCP.IBMSoftware.label}"/>
              <attribute name="BDNA_CONTENT_BUILD_DATE" value="${bdna.content.build.stamp}"/>
              <attribute name="BDNA_CONTENT_VERSION_NUMBER" value="${bdna.BCP.IBMSoftware.version}"/>
              <attribute name="BDNA_CONTENT_BUILD_NUMBER" value="${bcp.build.number}"/>
            </section>
            <section name="common/class1.class">
              <attribute name="Sealed" value="false"/>
            </section>
        </manifest>
    </jar>

</target>


<target name="content_installkit_bcp_IBMSoftware" depends="dist_bcp_IBMSoftware">
    <delete file="${bdna.nightly_builds.this_build}/IBMSoftware_${bdna.BCP.IBMSoftware.version}_${bcp.build.number}.seq"/>
    <delete file="${bdna.nightly_builds}/IBMSoftware_latest.seq"/>

    <jar
        destfile="${bdna.nightly_builds.this_build}/IBMSoftware_${bdna.BCP.IBMSoftware.version}_${bcp.build.number}.seq"
        basedir="${bdna.content.dist}" >
    </jar>
    <copy file="${bdna.nightly_builds.this_build}/IBMSoftware_${bdna.BCP.IBMSoftware.version}_${bcp.build.number}.seq" tofile="${bdna.nightly_builds}/IBMSoftware_latest.seq" />
</target>

<target name="prep_build_bcp_OracleSoftware">
    <delete dir="${bdna.content.build}" />
    <mkdir dir="${bdna.content.build}/modules" />
    <mkdir dir="${bdna.content.build}/appframe" />
    <mkdir dir="${bdna.content.build}/appdata" />
</target>


<!--                                                        -->
<!--            Generate the fingerprint modules            -->
<!--                                                        -->
<target name="generate_bcp_OracleSoftware" depends="prep_build_bcp_OracleSoftware">

    <java
        classname="com.bdna.fingerprintTool.GenJiffyFP"
        classpathref="javac.classpath"
        failonerror="true"
        dir="${bdna.seq}/com/bdna/fingerprintTool/templates/jiffy"
        fork="yes" >
        <sysproperty key="bdna.home" value="${bdna.seq}"/>
        <sysproperty key="bdna.jiffy.noperlcheck" value="${bdna.jiffy.noperlcheck}" />
        <arg value="${bdna.seq}/com/bdna/fingerprintTool" />
        <arg value="${bdna.content.build}/modules" />
    </java>


    <!-- move the bdna modules, overwrite the generated version if any -->
    <copy todir="${bdna.content.build}/modules/">
        <fileset dir="${bdna.seq}/modules">
            <include name="com/bdna/modules/app/BEA.xml" />
            <include name="com/bdna/modules/app/BEA/**" />
            <include name="com/bdna/modules/app/Brio.xml" />
            <include name="com/bdna/modules/app/Brio/**" />
            <include name="com/bdna/modules/app/CleanupBDNATrace.xml" />
            <include name="com/bdna/modules/app/Hyperion.xml" />
            <include name="com/bdna/modules/app/Hyperion/**" />
            <include name="com/bdna/modules/app/JDEdwards.xml" />
            <include name="com/bdna/modules/app/JDEdwards/**" />
            <include name="com/bdna/modules/app/Microsoft/MicrosoftIIS.xml" />
            <include name="com/bdna/modules/app/OracleIAS.xml" />
            <include name="com/bdna/modules/app/Oracle/**" />
            <exclude name="com/bdna/modules/app/Oracle/OracleVirtualSystem.xml" />
            <exclude name="com/bdna/modules/app/Oracle/Oracle_Clinical.xml" />
            <exclude name="com/bdna/modules/app/Oracle/UNIX_Oracle_Clinical.xml" />
            <include name="com/bdna/modules/app/Oracle.xml" />
            <include name="com/bdna/modules/app/OracleApp.xml" />
            <include name="com/bdna/modules/app/PeopleSoft.xml" />
            <include name="com/bdna/modules/app/PeopleSoft/**" />
            <include name="com/bdna/modules/app/PotentialWindows.xml" />
            <include name="com/bdna/modules/app/procCleanup.xml" />
            <include name="com/bdna/modules/app/Stellent.xml" />
            <include name="com/bdna/modules/app/Stellent/**" />
            <include name="com/bdna/modules/app/Sun.xml" />
            <include name="com/bdna/modules/app/Sun/**" />
            <include name="com/bdna/modules/app/UNIXOracleIAS.xml" />
            <include name="com/bdna/modules/app/UNIXPeopleSoft.xml" />
            <include name="com/bdna/modules/app/Vantive.xml" />
            <include name="com/bdna/modules/app/UNIXVantive.xml" />
            <include name="com/bdna/modules/app/CPAWindows.xml" />
            <include name="com/bdna/modules/app/CPAUNIX.xml" />
            <include name="com/bdna/modules/app/CPAOracle.xml" />
            <include name="com/bdna/modules/app/CPACommon.xml" />
            <include name="com/bdna/modules/common/ADMTypesAndAttrsDef.xml" />
            <include name="com/bdna/modules/common/Discovery.xml" />
            <include name="com/bdna/modules/common/DisableUNIXProcessDepList.xml" />
            <include name="com/bdna/modules/common/SNMP.xml" />
            <include name="com/bdna/modules/common/ILOM.xml" />
            <include name="com/bdna/modules/database/Oracle.xml" />
            <include name="com/bdna/modules/database/UNIXOracle.xml" />
            <include name="com/bdna/modules/database/WindowsOracle.xml" />
            <include name="com/bdna/modules/os/AIX.xml" />
            <include name="com/bdna/modules/os/HPUX.xml" />
            <include name="com/bdna/modules/os/IRIX.xml" />
            <include name="com/bdna/modules/os/Linux.xml" />
            <include name="com/bdna/modules/os/Solaris.xml" />
            <include name="com/bdna/modules/os/Tru64.xml" />
            <include name="com/bdna/modules/os/UNIX.xml" />
            <include name="com/bdna/modules/os/Windows.xml" />
            <include name="com/bdna/modules/metadata/OracleSoftwareFlags.xml" />
            <include name="**/*.properties" />
        </fileset>
    </copy>


    <copy todir="${bdna.content.build}/modules/com/bdna/presentationModules">
        <fileset dir="${bdna.seq}/modules/com/bdna/presentationModules">
            <include name="app/BEA/**" />
            <include name="app/BEA.xml" />
            <include name="app/Brio/**" />
            <include name="app/Hyperion/**" />
            <include name="app/JDEdwards/**" />
            <include name="app/Stellent/**" />
            <include name="app/OracleIAS.xml" />
            <include name="app/PotentialWindows.xml" />
            <include name="app/Oracle/**" />
            <include name="app/Vantive/**" />
            <include name="app/UNIXVantive/**" />
            <exclude name="app/Oracle/OracleVirtualSystem.xml" />
            <exclude name="app/Oracle/Oracle_Clinical.xml" />
            <exclude name="app/Oracle/UNIX_Oracle_Clinical.xml" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.build}/modules/com/bdna/presentationModules">
        <fileset dir="${bdna.seq}/modules/com/bdna/presentationModules">
            <include name="database/Oracle.xml" />
            <include name="database/UNIXOracle.xml" />
            <include name="database/WindowsOracle.xml" />
        </fileset>
    </copy>


    <copy todir="${bdna.content.build}/modules/com/bdna/presentationModules">
        <fileset dir="${bdna.seq}/modules/com/bdna/presentationModules">
            <include name="hardware/PrinterDiscovery.xml" />
            <include name="os/AIX.xml" />
            <include name="os/Embedded.xml" />
            <include name="os/HPUX.xml" />
            <include name="os/IBMzOS.xml" />
            <include name="os/J2ME.xml" />
            <include name="os/Linux.xml" />
            <include name="os/MacOS.xml" />
            <include name="os/Netware.xml" />
            <include name="os/OracleVMServer.xml" />
            <include name="os/UNIX.xml" />
            <include name="os/VNwareESXServer.xml" />            
            <include name="os/Windows.xml" />
            <include name="os/WindowsL2.xml" />
            <include name="os/XenServer.xml" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.build}/modules/com/bdna/presentationModules">
        <fileset dir="${bdna.seq}/modules/com/bdna/presentationModules">
            <include name="common/*" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.build}/modules/com/bdna/presentationModules">
        <fileset dir="${bdna.seq}/modules/com/bdna/presentationModules">
            <include name="hardware/PrinterDiscovery.xml" />
        </fileset>
    </copy>


    <!-- copy the built-in application modules -->
    <copy todir="${bdna.content.build}/appframe/com/bdna/modules/appmeta">
        <fileset dir="${bdna.seq}/com/bdna/app/application">
            <include name="AppConsole.xml" />
            <include name="MarketData_SupportViews.xml" />
            <include name="MarketData.xml" />
            <include name="PublisherOracle.xml" />
            <include name="OracleApplications.xml" />
            <include name="OracleDatabases.xml" />
            <include name="OracleSoftwarePack.xml" />
            <include name="StandardApplication.xml" />
            <include name="WebLogic.xml" />
            <include name="WebServers.xml" />
            <include name="Folders.xml" />
        </fileset>
    </copy>


    <unzip src="${bdna.seq}/com/bdna/app/data/marketData-Common.zip" dest="${bdna.content.build}/appdata/" />
    <unzip src="${bdna.seq}/com/bdna/app/data/marketData-CPUcore.zip" dest="${bdna.content.build}/appdata/" />
    <unzip src="${bdna.seq}/com/bdna/app/data/marketData-OracleSW.zip" dest="${bdna.content.build}/appdata/" />
    <unzip src="${bdna.seq}/com/bdna/app/data/marketData-UNIXL2.zip" dest="${bdna.content.build}/appdata/" />
    <unzip src="${bdna.seq}/com/bdna/app/data/marketData-WindowsL2.zip" dest="${bdna.content.build}/appdata/" />


     <!-- Insert Windows scripts into XML modules -->
     <java
         classname="com.bdna.fingerprintTool.ModulesTransformer"
         classpathref="javac.classpath"
         failonerror="true"
         dir="${bdna.seq}/modules"
         fork="yes" >
         <sysproperty key="bdna.home" value="${bdna.seq}"/>
         <arg value="${bdna.seq}" />
         <arg value="${bdna.content.build}" />
     </java>

    <copy todir="${bdna.content.build}/presentation">
        <fileset dir="${bdna.src}/presentation">
            <include name="**/*.xml" />
            <include name="**/*.properties" />
        </fileset>
    </copy>

</target>


<!--                                                        -->
<!--            Prepare the distribution directories        -->
<!--                                                        -->
<target name="prep_dist_bcp_OracleSoftware">
    <delete dir="${bdna.content.dist}" />
    <mkdir dir="${bdna.content.dist}/modules" />
    <mkdir dir="${bdna.content.dist}/modules/com" />
    <mkdir dir="${bdna.content.dist}/modules/com/bdna" />
    <mkdir dir="${bdna.content.dist}/appdata" />
    <mkdir dir="${bdna.content.dist}/appframe" />
    <mkdir dir="${bdna.content.dist}/MANIFEST" />
    <mkdir dir="${bdna.content.dist}/upgrade" />
</target>

<target name="dist_bcp_OracleSoftware" depends="init, generate_bcp_OracleSoftware, prep_dist_bcp_OracleSoftware, ui_engine_library">

    <copy file="${bdna.seq}/content/manifests/OracleSoftwareManifest.xml" todir="${bdna.content.dist}/MANIFEST" />

    <copy file="${bdna.seq}/content/upgrade/upgrade.xml" tofile="${bdna.content.dist}/upgrade/upgrade.xml" />
    <copy file="${bdna.seq}/content/upgrade/upgrade.sh" tofile="${bdna.content.dist}/upgrade/upgrade.sh" />
    <copy file="${bdna.seq}/content/upgrade/pubTablesCleanup.sql" tofile="${bdna.content.dist}/upgrade/pubTablesCleanup.sql" />
    <copy file="${bdna.seq}/content/upgrade/removeMD_dups.sql" tofile="${bdna.content.dist}/upgrade/removeMD_dups.sql" />
    <copy file="${bdna.seq}/content/upgrade/upgradeContentReports.xml" tofile="${bdna.content.dist}/upgrade/upgradeContentReports.xml" />

    <replace file="${bdna.content.dist}/MANIFEST/OracleSoftwareManifest.xml" value="${bdna.bcp.version}">
        <replacefilter token="@bdna.bcp.version@"/>
    </replace>

    <replace file="${bdna.content.dist}/upgrade/upgrade.sh" value="${bdna.bcp.version}">
        <replacefilter token="@bdna.bcp.version@"/>
    </replace>
    <replace file="${bdna.content.dist}/upgrade/upgrade.sh" value="${bcp.build.number}">
        <replacefilter token="@bcp.build.number@"/>
    </replace>

    <copy file="${bdna.seq}/com/bdna/app/widget/WidgetLibrary.xml" todir="${bdna.content.dist}/appframe/com/bdna/modules/appmeta" />
    <copy file="${bdna.seq}/com/bdna/app/uiengine/HTMLEngineWidgetLibrary.xml" todir="${bdna.content.dist}/appframe/com/bdna/modules/appmeta" />
    <copy file="${bdna.seq}/com/bdna/app/uiengine/SwingEngineWidgetLibrary.xml" todir="${bdna.content.dist}/appframe/com/bdna/modules/appmeta" />


    <copy todir="${bdna.content.dist}/appdata">
        <fileset dir="${bdna.content.build}/appdata">
            <include name="**" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.dist}/appframe">
        <fileset dir="${bdna.content.build}/appframe">
            <include name="**" />
        </fileset>
    </copy>


<fileset id="OracleSoftware_modules" dir="${bdna.content.build}/modules">
            <include name="com/bdna/modules/app/BEA.xml" />
            <include name="com/bdna/modules/app/BEA/**" />
            <include name="com/bdna/modules/app/Brio.xml" />
            <include name="com/bdna/modules/app/Brio/**" />
            <include name="com/bdna/modules/app/Hyperion.xml" />
            <include name="com/bdna/modules/app/Hyperion/**" />
            <include name="com/bdna/modules/app/JDEdwards.xml" />
            <include name="com/bdna/modules/app/JDEdwards/**" />
            <include name="com/bdna/modules/app/Stellent.xml" />
            <include name="com/bdna/modules/app/Stellent/**" />
            <include name="com/bdna/modules/app/Vantive.xml" />
            <include name="com/bdna/modules/app/UNIXVantive.xml" />
            <include name="com/bdna/modules/app/CleanupBDNATrace.xml" />
            <include name="com/bdna/modules/app/Microsoft/MicrosoftIIS.xml" />
            <include name="com/bdna/modules/app/OracleIAS.xml" />
            <include name="com/bdna/modules/app/Oracle/**" />
            <exclude name="com/bdna/modules/app/Oracle/OracleVirtualSystem.xml" />
            <exclude name="com/bdna/modules/app/Oracle/Oracle_Clinical.xml" />
            <exclude name="com/bdna/modules/app/Oracle/UNIX_Oracle_Clinical.xml" />
            <include name="com/bdna/modules/app/Oracle.xml" />
            <include name="com/bdna/modules/app/OracleApp.xml" />
            <include name="com/bdna/modules/app/PeopleSoft/**" />
            <include name="com/bdna/modules/app/PeopleSoft.xml" />
            <include name="com/bdna/modules/app/PotentialWindows.xml" />
            <include name="com/bdna/modules/app/procCleanup.xml" />
            <include name="com/bdna/modules/app/Sun.xml" />
            <include name="com/bdna/modules/app/Sun/**" />
            <include name="com/bdna/modules/app/UNIXOracleIAS.xml" />
            <include name="com/bdna/modules/app/UNIXPeopleSoft.xml" />
            <include name="com/bdna/modules/app/CPAWindows.xml" />
            <include name="com/bdna/modules/app/CPAUNIX.xml" />
            <include name="com/bdna/modules/app/CPAOracle.xml" />
            <include name="com/bdna/modules/app/CPACommon.xml" />
            <include name="com/bdna/modules/common/ADMTypesAndAttrsDef.xml" />
            <include name="com/bdna/modules/common/Discovery.xml" />
            <include name="com/bdna/modules/common/DisableUNIXProcessDepList.xml" />
            <include name="com/bdna/modules/common/SNMP.xml" />
            <include name="com/bdna/modules/common/ILOM.xml" />
            <include name="com/bdna/modules/database/Oracle.xml" />
            <include name="com/bdna/modules/database/UNIXOracle.xml" />
            <include name="com/bdna/modules/database/WindowsOracle.xml" />
            <include name="com/bdna/modules/os/AIX.xml" />
            <include name="com/bdna/modules/os/HPUX.xml" />
            <include name="com/bdna/modules/os/IRIX.xml" />
            <include name="com/bdna/modules/os/Linux.xml" />
            <include name="com/bdna/modules/os/Solaris.xml" />
            <include name="com/bdna/modules/os/Tru64.xml" />
            <include name="com/bdna/modules/os/UNIX.xml" />
            <include name="com/bdna/modules/os/Windows.xml" />
            <include name="com/bdna/modules/metadata/OracleSoftwareFlags.xml" />
            <include name="com/bdna/presentationModules/app/BEA/**" />
            <include name="com/bdna/presentationModules/app/BEA.xml" />
            <include name="com/bdna/presentationModules/app/OracleIAS.xml" />
            <include name="com/bdna/presentationModules/app/PotentialWindows.xml" />
            <include name="com/bdna/presentationModules/app/Oracle/**" />
            <exclude name="com/bdna/presentationModules/app/Oracle/OracleVirtualSystem.xml" />
            <exclude name="com/bdna/presentationModules/app/Oracle/Oracle_Clinical.xml" />
            <exclude name="com/bdna/presentationModules/app/Oracle/UNIX_Oracle_Clinical.xml" />
            <include name="com/bdna/presentationModules/database/Oracle.xml" />
            <include name="com/bdna/presentationModules/database/UNIXOracle.xml" />
            <include name="com/bdna/presentationModules/database/WindowsOracle.xml" />
            <include name="com/bdna/presentationModules/common/*" />
            <include name="com/bdna/presentationModules/hardware/PrinterDiscovery.xml" />
            <include name="com/bdna/presentationModules/os/AIX.xml" />
            <include name="com/bdna/presentationModules/os/Embedded.xml" />
            <include name="com/bdna/presentationModules/os/HPUX.xml" />
            <include name="com/bdna/presentationModules/os/IBMzOS.xml" />
            <include name="com/bdna/presentationModules/os/J2ME.xml" />
            <include name="com/bdna/presentationModules/os/Linux.xml" />
            <include name="com/bdna/presentationModules/os/MacOS.xml" />
            <include name="com/bdna/presentationModules/os/Netware.xml" />
            <include name="com/bdna/presentationModules/os/OracleVMServer.xml" />
            <include name="com/bdna/presentationModules/os/UNIX.xml" />
            <include name="com/bdna/presentationModules/os/VNwareESXServer.xml" />            
            <include name="com/bdna/presentationModules/os/Windows.xml" />
            <include name="com/bdna/presentationModules/os/WindowsL2.xml" />
            <include name="com/bdna/presentationModules/os/XenServer.xml" />
</fileset>





    <delete file="${bdna.content.dist}/modules/com/bdna/bdna_content.bar"/>
    <jar
        jarfile="${bdna.content.dist}/modules/com/bdna/bdna_content.bar"
        >
        <fileset refid="OracleSoftware_modules"/>

        <manifest>
            <attribute name="Built-By" value="${user.name}"/>
            <section name="common">
              <attribute name="BDNA_CONTENT_PACK_NAME" value="${bdna.BCP.OracleSoftware.label}"/>
              <attribute name="BDNA_CONTENT_BUILD_DATE" value="${bdna.content.build.stamp}"/>
              <attribute name="BDNA_CONTENT_VERSION_NUMBER" value="${bdna.BCP.OracleSoftware.version}"/>
              <attribute name="BDNA_CONTENT_BUILD_NUMBER" value="${bcp.build.number}"/>
            </section>
            <section name="common/class1.class">
              <attribute name="Sealed" value="false"/>
            </section>
        </manifest>
    </jar>

</target>


<target name="content_installkit_bcp_OracleSoftware" depends="dist_bcp_OracleSoftware">
    <delete file="${bdna.nightly_builds.this_build}/OracleSoftware_${bdna.BCP.OracleSoftware.version}_${bcp.build.number}.seq"/>
    <delete file="${bdna.nightly_builds}/OracleSoftware_latest.seq"/>

    <jar
        destfile="${bdna.nightly_builds.this_build}/OracleSoftware_${bdna.BCP.OracleSoftware.version}_${bcp.build.number}.seq"
        basedir="${bdna.content.dist}" >
    </jar>
    <copy file="${bdna.nightly_builds.this_build}/OracleSoftware_${bdna.BCP.OracleSoftware.version}_${bcp.build.number}.seq" tofile="${bdna.nightly_builds}/OracleSoftware_latest.seq" />
</target>


<target name="prep_build_bcp_OracleLMS">
    <delete dir="${bdna.content.build}" />
    <mkdir dir="${bdna.content.build}/modules" />
    <mkdir dir="${bdna.content.build}/appframe" />
    <mkdir dir="${bdna.content.build}/appdata" />
    <mkdir dir="${bdna.content.build}/java" />
</target>

<!--                                                        -->
<!--            Generate the fingerprint modules            -->
<!--                                                        -->
<target name="generate_bcp_OracleLMS" depends="prep_build_bcp_OracleLMS">

    <java
        classname="com.bdna.fingerprintTool.GenJiffyFP"
        classpathref="javac.classpath"
        failonerror="true"
        dir="${bdna.seq}/com/bdna/fingerprintTool/templates/jiffy"
        fork="yes" >
        <sysproperty key="bdna.home" value="${bdna.seq}"/>
        <sysproperty key="bdna.jiffy.noperlcheck" value="${bdna.jiffy.noperlcheck}" />
        <arg value="${bdna.seq}/com/bdna/fingerprintTool" />
        <arg value="${bdna.content.build}/modules" />
    </java>


    <!-- move the bdna modules, overwrite the generated version if any -->
    <copy todir="${bdna.content.build}/modules/">
        <fileset dir="${bdna.seq}/modules">
            <include name="com/bdna/modules/app/CleanupBDNATrace.xml"/>
            <include name="com/bdna/modules/app/Microsoft/MicrosoftIIS.xml" />
            <include name="com/bdna/modules/app/OracleApp.xml" />
            <include name="com/bdna/modules/app/PotentialWindows.xml" />
            <include name="com/bdna/modules/app/procCleanup.xml" />
            <include name="com/bdna/modules/app/CPAWindows.xml" />
            <include name="com/bdna/modules/app/CPAUNIX.xml" />
            <include name="com/bdna/modules/app/CPAOracle.xml" />
            <include name="com/bdna/modules/app/CPACommon.xml" />
            <include name="com/bdna/modules/common/ADMTypesAndAttrsDef.xml" />
            <include name="com/bdna/modules/common/Discovery.xml" />
            <include name="com/bdna/modules/common/DisableUNIXProcessDepList.xml" />
            <include name="com/bdna/modules/common/SNMP.xml" />
            <include name="com/bdna/modules/common/ILOM.xml" />
            <include name="com/bdna/modules/database/Oracle.xml" />
            <include name="com/bdna/modules/database/OracleL3Common.xml" />
            <include name="com/bdna/modules/database/UNIXOracle.xml" />
            <include name="com/bdna/modules/database/UNIXOracleL3.xml" />
            <include name="com/bdna/modules/database/UNIXOracleLMS.xml" />
            <include name="com/bdna/modules/database/WindowsOracle.xml" />
            <include name="com/bdna/modules/database/WindowsOracleL3.xml" />
            <include name="com/bdna/modules/database/WindowsOracleLMS.xml" />
            <include name="com/bdna/modules/os/AIX.xml" />
            <include name="com/bdna/modules/os/HPUX.xml" />
            <include name="com/bdna/modules/os/IRIX.xml" />
            <include name="com/bdna/modules/os/Linux.xml" />
            <include name="com/bdna/modules/os/Solaris.xml" />
            <include name="com/bdna/modules/os/Tru64.xml" />
            <include name="com/bdna/modules/os/UNIX.xml" />
            <include name="com/bdna/modules/os/Windows.xml" />
            <include name="com/bdna/modules/metadata/OracleSoftwareFlags.xml" />
            <include name="**/*.properties" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.build}/modules/com/bdna/presentationModules">
        <fileset dir="${bdna.seq}/modules/com/bdna/presentationModules">
            <include name="app/PotentialWindows.xml" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.build}/modules/com/bdna/presentationModules">
        <fileset dir="${bdna.seq}/modules/com/bdna/presentationModules">
            <include name="database/Oracle.xml" />
            <include name="database/UNIXOracle.xml" />
            <include name="database/UNIXOracleL3.xml" />
            <include name="database/WindowsOracle.xml" />
            <include name="database/WindowsOracleL3.xml" />
        </fileset>
    </copy>


    <copy todir="${bdna.content.build}/modules/com/bdna/presentationModules">
        <fileset dir="${bdna.seq}/modules/com/bdna/presentationModules">
            <include name="os/AIX.xml" />
            <include name="os/Embedded.xml" />
            <include name="os/HPUX.xml" />
            <include name="os/IBMzOS.xml" />
            <include name="os/J2ME.xml" />
            <include name="os/Linux.xml" />
            <include name="os/MacOS.xml" />
            <include name="os/Netware.xml" />
            <include name="os/OracleVMServer.xml" />
            <include name="os/UNIX.xml" />
            <include name="os/VNwareESXServer.xml" />
            <include name="os/Windows.xml" />
            <include name="os/WindowsL2.xml" />
            <include name="os/XenServer.xml" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.build}/modules/com/bdna/presentationModules">
        <fileset dir="${bdna.seq}/modules/com/bdna/presentationModules">
            <include name="common/*" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.build}/modules/com/bdna/presentationModules">
        <fileset dir="${bdna.seq}/modules/com/bdna/presentationModules">
            <include name="hardware/PrinterDiscovery.xml" />
        </fileset>
    </copy>


    <!-- copy the built-in application modules -->
    <copy todir="${bdna.content.build}/appframe/com/bdna/modules/appmeta">
        <fileset dir="${bdna.seq}/com/bdna/app/application">
            <include name="AppConsole.xml" />
            <include name="MarketData_SupportViews.xml" />
            <include name="MarketData.xml" />
            <include name="OracleDatabases.xml" />
            <include name="OracleLMS.xml" />
            <include name="OracleLMSPack.xml" />
            <include name="StandardApplication.xml" />
            <include name="Folders.xml" />
            <include name="WebServers.xml" />
            <!--
            <include name="PublisherOracle.xml" />
            --> 
        </fileset>
    </copy>

    <unzip src="${bdna.seq}/com/bdna/app/data/marketData-Common.zip" dest="${bdna.content.build}/appdata/" />
    <unzip src="${bdna.seq}/com/bdna/app/data/marketData-CPUcore.zip" dest="${bdna.content.build}/appdata/" />
    <unzip src="${bdna.seq}/com/bdna/app/data/marketData-OracleSW.zip" dest="${bdna.content.build}/appdata/" />
    <unzip src="${bdna.seq}/com/bdna/app/data/marketData-UNIXL2.zip" dest="${bdna.content.build}/appdata/" />
    <unzip src="${bdna.seq}/com/bdna/app/data/marketData-WindowsL2.zip" dest="${bdna.content.build}/appdata/" />


     <!-- Insert Windows scripts into XML modules -->
     <java
         classname="com.bdna.fingerprintTool.ModulesTransformer"
         classpathref="javac.classpath"
         failonerror="true"
         dir="${bdna.seq}/modules"
         fork="yes" >
         <sysproperty key="bdna.home" value="${bdna.seq}"/>
         <arg value="${bdna.seq}" />
         <arg value="${bdna.content.build}" />
     </java>

    <copy todir="${bdna.content.build}/presentation">
        <fileset dir="${bdna.src}/presentation">
            <include name="**/*.xml" />
            <include name="**/*.properties" />
        </fileset>
    </copy>

</target>

<!--                                                        -->
<!--            Prepare the distribution directories        -->
<!--                                                        -->
<target name="prep_dist_bcp_OracleLMS">
    <delete dir="${bdna.content.dist}" />
    <mkdir dir="${bdna.content.dist}/conf" />
    <mkdir dir="${bdna.content.dist}/modules" />
    <mkdir dir="${bdna.content.dist}/modules/com" />
    <mkdir dir="${bdna.content.dist}/modules/com/bdna" />
    <mkdir dir="${bdna.content.dist}/appdata" />
    <mkdir dir="${bdna.content.dist}/appframe" />
    <mkdir dir="${bdna.content.dist}/MANIFEST" />
    <mkdir dir="${bdna.content.dist}/upgrade" />
    <mkdir dir="${bdna.content.dist}/java" />

</target>

<target name="dist_bcp_OracleLMS" depends="init, generate_bcp_OracleLMS, prep_dist_bcp_OracleLMS, content_java">

    <copy file="${bdna.seq}/content/manifests/OracleLicenseManagementManifest.xml" todir="${bdna.content.dist}/MANIFEST" />

    <copy file="${bdna.seq}/content/upgrade/upgrade.xml" tofile="${bdna.content.dist}/upgrade/upgrade.xml" />
    <copy file="${bdna.seq}/content/upgrade/upgrade.sh" tofile="${bdna.content.dist}/upgrade/upgrade.sh" />
    <copy file="${bdna.seq}/content/upgrade/pubTablesCleanup.sql" tofile="${bdna.content.dist}/upgrade/pubTablesCleanup.sql" />
    <copy file="${bdna.seq}/content/upgrade/removeMD_dups.sql" tofile="${bdna.content.dist}/upgrade/removeMD_dups.sql" />
    <copy file="${bdna.seq}/content/upgrade/upgradeContentReports.xml" tofile="${bdna.content.dist}/upgrade/upgradeContentReports.xml" />

    <replace file="${bdna.content.dist}/MANIFEST/OracleLicenseManagementManifest.xml" value="${bdna.bcp.version}">
        <replacefilter token="@bdna.bcp.version@"/>
    </replace>

    <replace file="${bdna.content.dist}/upgrade/upgrade.sh" value="${bdna.bcp.version}">
        <replacefilter token="@bdna.bcp.version@"/>
    </replace>
    <replace file="${bdna.content.dist}/upgrade/upgrade.sh" value="${bcp.build.number}">
        <replacefilter token="@bcp.build.number@"/>
    </replace>

    <copy file="${bdna.seq}/com/bdna/app/widget/WidgetLibrary.xml" todir="${bdna.content.dist}/appframe/com/bdna/modules/appmeta" />
    <copy file="${bdna.seq}/com/bdna/app/uiengine/HTMLEngineWidgetLibrary.xml" todir="${bdna.content.dist}/appframe/com/bdna/modules/appmeta" />
    <copy file="${bdna.seq}/com/bdna/app/uiengine/SwingEngineWidgetLibrary.xml" todir="${bdna.content.dist}/appframe/com/bdna/modules/appmeta" />


    <copy todir="${bdna.content.dist}/appdata">
        <fileset dir="${bdna.content.build}/appdata">
            <include name="**" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.dist}/appframe">
        <fileset dir="${bdna.content.build}/appframe">
            <include name="**" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.dist}/conf">
        <fileset dir="${bdna.seq}/content/udtTemplate">
            <include name="OracleLicenseManagementUdt.tpl" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.dist}/java/sources/com/bdna/si/udt">
        <fileset dir="${bdna.seq}/com/bdna/si/udt">
            <include name="dbOptions.java" />
            <include name="dbaFeatureStats.java" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.dist}/java/classes/com/bdna/si/udt">
        <fileset dir="${bdna.build}/classes/com/bdna/si/udt">
            <include name="dbOptions.class" />
            <include name="dbaFeatureStats.class" />
        </fileset>
    </copy>


<fileset id="OracleLMS_modules" dir="${bdna.content.build}/modules">
            <include name="com/bdna/modules/app/CleanupBDNATrace.xml" />
            <include name="com/bdna/modules/app/Microsoft/MicrosoftIIS.xml" />
            <include name="com/bdna/modules/app/OracleApp.xml" />
            <include name="com/bdna/modules/app/PotentialWindows.xml" />
            <include name="com/bdna/modules/app/procCleanup.xml" />
            <include name="com/bdna/modules/app/CPAWindows.xml" />
            <include name="com/bdna/modules/app/CPAUNIX.xml" />
            <include name="com/bdna/modules/app/CPAOracle.xml" />
            <include name="com/bdna/modules/app/CPACommon.xml" />
            <include name="com/bdna/modules/common/ADMTypesAndAttrsDef.xml" />
            <include name="com/bdna/modules/common/Discovery.xml" />
            <include name="com/bdna/modules/common/DisableUNIXProcessDepList.xml" />
            <include name="com/bdna/modules/common/SNMP.xml" />
            <include name="com/bdna/modules/common/ILOM.xml" />
            <include name="com/bdna/modules/database/Oracle.xml" />
            <include name="com/bdna/modules/database/OracleL3Common.xml" />
            <include name="com/bdna/modules/database/UNIXOracle.xml" />
            <include name="com/bdna/modules/database/UNIXOracleL3.xml" /> 
            <include name="com/bdna/modules/database/UNIXOracleLMS.xml" />
            <include name="com/bdna/modules/database/WindowsOracle.xml" />
            <include name="com/bdna/modules/database/WindowsOracleL3.xml" />
            <include name="com/bdna/modules/database/WindowsOracleLMS.xml" />
            <include name="com/bdna/modules/os/AIX.xml" />
            <include name="com/bdna/modules/os/HPUX.xml" />
            <include name="com/bdna/modules/os/IRIX.xml" />
            <include name="com/bdna/modules/os/Linux.xml" />
            <include name="com/bdna/modules/os/Solaris.xml" />
            <include name="com/bdna/modules/os/Tru64.xml" />
            <include name="com/bdna/modules/os/UNIX.xml" />
            <include name="com/bdna/modules/os/Windows.xml" />
            <include name="com/bdna/modules/metadata/OracleSoftwareFlags.xml" />
            <include name="com/bdna/presentationModules/app/PotentialWindows.xml" />
            <include name="com/bdna/presentationModules/database/UNIXOracle.xml" />
            <include name="com/bdna/presentationModules/database/UNIXOracleL3.xml" />
            <include name="com/bdna/presentationModules/database/WindowsOracle.xml" />
            <include name="com/bdna/presentationModules/database/WindowsOracleL3.xml" />
            <include name="com/bdna/presentationModules/common/*" />
            <include name="com/bdna/presentationModules/hardware/PrinterDiscovery.xml" />
            <include name="com/bdna/presentationModules/os/AIX.xml" />
            <include name="com/bdna/presentationModules/os/Embedded.xml" />
            <include name="com/bdna/presentationModules/os/HPUX.xml" />
            <include name="com/bdna/presentationModules/os/IBMzOS.xml" />
            <include name="com/bdna/presentationModules/os/J2ME.xml" />
            <include name="com/bdna/presentationModules/os/Linux.xml" />
            <include name="com/bdna/presentationModules/os/MacOS.xml" />
            <include name="com/bdna/presentationModules/os/Netware.xml" />
            <include name="com/bdna/presentationModules/os/OracleVMServer.xml" />
            <include name="com/bdna/presentationModules/os/UNIX.xml" />
            <include name="com/bdna/presentationModules/os/VNwareESXServer.xml" />
            <include name="com/bdna/presentationModules/os/Windows.xml" />
            <include name="com/bdna/presentationModules/os/WindowsL2.xml" />
            <include name="com/bdna/presentationModules/os/XenServer.xml" />
</fileset>


    <delete file="${bdna.content.dist}/modules/com/bdna/bdna_content.bar"/>
    <jar
        jarfile="${bdna.content.dist}/modules/com/bdna/bdna_content.bar"
        >
        <fileset refid="OracleLMS_modules"/>

        <manifest>
            <attribute name="Built-By" value="${user.name}"/>
            <section name="common">
              <attribute name="BDNA_CONTENT_PACK_NAME" value="${bdna.BCP.OracleLMS.label}"/>
              <attribute name="BDNA_CONTENT_BUILD_DATE" value="${bdna.content.build.stamp}"/>
              <attribute name="BDNA_CONTENT_VERSION_NUMBER" value="${bdna.BCP.OracleLMS.version}"/>
              <attribute name="BDNA_CONTENT_BUILD_NUMBER" value="${bcp.build.number}"/>
            </section>
            <section name="common/class1.class">
              <attribute name="Sealed" value="false"/>
            </section>
        </manifest>
    </jar>

</target>


<target name="content_installkit_bcp_OracleLMS" depends="dist_bcp_OracleLMS">
    <delete file="${bdna.nightly_builds.this_build}/OracleLMS_${bdna.BCP.OracleLMS.version}_${bcp.build.number}.seq"/>
    <delete file="${bdna.nightly_builds}/OracleLMS_latest.seq"/>

    <jar
        destfile="${bdna.nightly_builds.this_build}/OracleLMS_${bdna.BCP.OracleLMS.version}_${bcp.build.number}.seq"
        basedir="${bdna.content.dist}" >
    </jar>
    <copy file="${bdna.nightly_builds.this_build}/OracleLMS_${bdna.BCP.OracleLMS.version}_${bcp.build.number}.seq" tofile="${bdna.nightly_builds}/OracleLMS_latest.seq" />
</target>


<target name="prep_build_bcp_AdobeSoftware">
    <delete dir="${bdna.content.build}" />
    <mkdir dir="${bdna.content.build}/modules" />
    <mkdir dir="${bdna.content.build}/appframe" />
    <mkdir dir="${bdna.content.build}/appdata" />
</target>

<!--                                                        -->
<!--            Generate the fingerprint modules            -->
<!--                                                        -->
<target name="generate_bcp_AdobeSoftware" depends="prep_build_bcp_AdobeSoftware">

    <java
        classname="com.bdna.fingerprintTool.GenJiffyFP"
        classpathref="javac.classpath"
        failonerror="true"
        dir="${bdna.seq}/com/bdna/fingerprintTool/templates/jiffy"
        fork="yes" >
        <sysproperty key="bdna.home" value="${bdna.seq}"/>
        <sysproperty key="bdna.jiffy.noperlcheck" value="${bdna.jiffy.noperlcheck}" />
        <arg value="${bdna.seq}/com/bdna/fingerprintTool" />
        <arg value="${bdna.content.build}/modules" />
    </java>


    <!-- move the bdna modules, overwrite the generated version if any -->
    <copy todir="${bdna.content.build}/modules/">
        <fileset dir="${bdna.seq}/modules">
            <include name="com/bdna/modules/app/Adobe/**" />
            <include name="com/bdna/modules/app/Adobe.xml" />
            <include name="com/bdna/modules/app/CPAWindows.xml" />
            <include name="com/bdna/modules/app/CPAUNIX.xml" />
            <include name="com/bdna/modules/app/CPACommon.xml" />
            <include name="com/bdna/modules/app/CleanupBDNATrace.xml" />
            <include name="com/bdna/modules/app/PotentialWindows.xml" />
            <include name="com/bdna/modules/app/procCleanup.xml" />
            <include name="com/bdna/modules/common/Discovery.xml" />
            <include name="com/bdna/modules/common/DisableUNIXProcessDepList.xml" />
            <include name="com/bdna/modules/common/SNMP.xml" />
            <include name="com/bdna/modules/common/ILOM.xml" />
            <include name="com/bdna/modules/os/Windows.xml" />
            <include name="com/bdna/modules/metadata/AdobeSoftwareFlags.xml" />
            <include name="**/*.properties" />
        </fileset>
    </copy>


    <copy todir="${bdna.content.build}/modules/com/bdna/presentationModules">
        <fileset dir="${bdna.seq}/modules/com/bdna/presentationModules">
            <include name="app/Adobe/**" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.build}/modules/com/bdna/presentationModules">
        <fileset dir="${bdna.seq}/modules/com/bdna/presentationModules">
            <include name="os/AIX.xml" />
            <include name="os/Embedded.xml" />
            <include name="os/HPUX.xml" />
            <include name="os/IBMzOS.xml" />
            <include name="os/J2ME.xml" />
            <include name="os/Linux.xml" />
            <include name="os/MacOS.xml" />
            <include name="os/Netware.xml" />
            <include name="os/OracleVMServer.xml" />
            <include name="os/UNIX.xml" />
            <include name="os/VNwareESXServer.xml" />            
            <include name="os/Windows.xml" />
            <include name="os/WindowsL2.xml" />
            <include name="os/XenServer.xml" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.build}/modules/com/bdna/presentationModules">
        <fileset dir="${bdna.seq}/modules/com/bdna/presentationModules">
            <include name="common/*" />
            <exclude name="common/ADMTypesAndAttrsDef.xml" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.build}/modules/com/bdna/presentationModules">
        <fileset dir="${bdna.seq}/modules/com/bdna/presentationModules">
            <include name="hardware/PrinterDiscovery.xml" />
        </fileset>
    </copy>


    <!-- copy the built-in application modules -->
    <copy todir="${bdna.content.build}/appframe/com/bdna/modules/appmeta">
        <fileset dir="${bdna.seq}/com/bdna/app/application">
            <include name="AppConsole.xml" />
            <include name="Folders.xml" />
            <include name="AdobeSoftwarePack.xml" />
            <include name="MarketData_SupportViews.xml" />
            <include name="MarketData.xml" />
            <include name="StandardApplication.xml" />
        </fileset>
    </copy>


    <unzip src="${bdna.seq}/com/bdna/app/data/marketData-Common.zip" dest="${bdna.content.build}/appdata/" />
    <unzip src="${bdna.seq}/com/bdna/app/data/marketData-CPUcore.zip" dest="${bdna.content.build}/appdata/" />
    <unzip src="${bdna.seq}/com/bdna/app/data/marketData-AdobeApps.zip" dest="${bdna.content.build}/appdata/" />
    <unzip src="${bdna.seq}/com/bdna/app/data/marketData-UNIXL2.zip" dest="${bdna.content.build}/appdata/" />
    <unzip src="${bdna.seq}/com/bdna/app/data/marketData-WindowsL2.zip" dest="${bdna.content.build}/appdata/" />



     <!-- Insert Windows scripts into XML modules -->
     <java
         classname="com.bdna.fingerprintTool.ModulesTransformer"
         classpathref="javac.classpath"
         failonerror="true"
         dir="${bdna.seq}/modules"
         fork="yes" >
         <sysproperty key="bdna.home" value="${bdna.seq}"/>
         <arg value="${bdna.seq}" />
         <arg value="${bdna.content.build}" />
     </java>


    <copy todir="${bdna.content.build}/presentation">
        <fileset dir="${bdna.src}/presentation">
            <include name="**/*.xml" />
            <include name="**/*.properties" />
        </fileset>
    </copy>

</target>


<!--                                                        -->
<!--            Prepare the distribution directories        -->
<!--                                                        -->
<target name="prep_dist_bcp_AdobeSoftware">
    <delete dir="${bdna.content.dist}" />
    <mkdir dir="${bdna.content.dist}/modules" />
    <mkdir dir="${bdna.content.dist}/modules/com" />
    <mkdir dir="${bdna.content.dist}/modules/com/bdna" />
    <mkdir dir="${bdna.content.dist}/appdata" />
    <mkdir dir="${bdna.content.dist}/appframe" />
    <mkdir dir="${bdna.content.dist}/MANIFEST" />
    <mkdir dir="${bdna.content.dist}/upgrade" />
</target>


<target name="dist_bcp_AdobeSoftware" depends="init, generate_bcp_AdobeSoftware, prep_dist_bcp_AdobeSoftware, ui_engine_library">

    <copy file="${bdna.seq}/com/bdna/app/widget/WidgetLibrary.xml" todir="${bdna.content.dist}/appframe/com/bdna/modules/appmeta" />
    <copy file="${bdna.seq}/com/bdna/app/uiengine/HTMLEngineWidgetLibrary.xml" todir="${bdna.content.dist}/appframe/com/bdna/modules/appmeta" />
    <copy file="${bdna.seq}/com/bdna/app/uiengine/SwingEngineWidgetLibrary.xml" todir="${bdna.content.dist}/appframe/com/bdna/modules/appmeta" />


    <copy file="${bdna.seq}/content/manifests/AdobeSoftwareManifest.xml" todir="${bdna.content.dist}/MANIFEST" />

    <copy file="${bdna.seq}/content/upgrade/upgrade.xml" tofile="${bdna.content.dist}/upgrade/upgrade.xml" />
    <copy file="${bdna.seq}/content/upgrade/upgrade.sh" tofile="${bdna.content.dist}/upgrade/upgrade.sh" />
    <copy file="${bdna.seq}/content/upgrade/pubTablesCleanup.sql" tofile="${bdna.content.dist}/upgrade/pubTablesCleanup.sql" />
    <copy file="${bdna.seq}/content/upgrade/removeMD_dups.sql" tofile="${bdna.content.dist}/upgrade/removeMD_dups.sql" />
    <copy file="${bdna.seq}/content/upgrade/upgradeContentReports.xml" tofile="${bdna.content.dist}/upgrade/upgradeContentReports.xml" />

    <replace file="${bdna.content.dist}/MANIFEST/AdobeSoftwareManifest.xml" value="${bdna.bcp.version}">
        <replacefilter token="@bdna.bcp.version@"/>
    </replace>

    <replace file="${bdna.content.dist}/upgrade/upgrade.sh" value="${bdna.bcp.version}">
        <replacefilter token="@bdna.bcp.version@"/>
    </replace>
    <replace file="${bdna.content.dist}/upgrade/upgrade.sh" value="${bcp.build.number}">
        <replacefilter token="@bcp.build.number@"/>
    </replace>

<!--

<replace file="${bdna.seq}/content/manifests/BaselineManifest.xml">
  <replacetoken>contentBuildVersion="1"</replacetoken>
  <replacevalue>contentBuildVersion="${bcp.build.number}"</replacevalue>
</replace>

-->


    <copy todir="${bdna.content.dist}/appdata">
        <fileset dir="${bdna.content.build}/appdata">
            <include name="**" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.dist}/appframe">
        <fileset dir="${bdna.content.build}/appframe">
            <include name="**" />
        </fileset>
    </copy>

<fileset id="AdobeSoftware_modules" dir="${bdna.content.build}/modules">
            <include name="com/bdna/modules/app/Adobe.xml" />
            <include name="com/bdna/modules/app/Adobe/**" />
            <include name="com/bdna/modules/app/CPAWindows.xml" />
            <include name="com/bdna/modules/app/CPAUNIX.xml" />
            <include name="com/bdna/modules/app/CPACommon.xml" />
            <include name="com/bdna/modules/app/CleanupBDNATrace.xml" />
            <include name="com/bdna/modules/app/procCleanup.xml" />
            <include name="com/bdna/modules/app/PotentialWindows.xml" />
            <include name="com/bdna/modules/common/Discovery.xml" />
            <include name="com/bdna/modules/common/DisableUNIXProcessDepList.xml" />
            <include name="com/bdna/modules/common/SNMP.xml" />
            <include name="com/bdna/modules/common/ILOM.xml" />
            <include name="com/bdna/modules/os/AIX.xml" />
            <include name="com/bdna/modules/os/HPUX.xml" />
            <include name="com/bdna/modules/os/IRIX.xml" />
            <include name="com/bdna/modules/os/Linux.xml" />
            <include name="com/bdna/modules/os/Solaris.xml" />
            <include name="com/bdna/modules/os/Tru64.xml" />
            <include name="com/bdna/modules/os/UNIX.xml" />
            <include name="com/bdna/modules/os/Windows.xml" />
            <include name="com/bdna/modules/metadata/AdobeSoftwareFlags.xml" />
            <include name="**/*.properties" />
            <include name="com/bdna/presentationModules/app/PotentialWindows.xml" />
            <include name="com/bdna/presentationModules/app/Adobe/**" />
            <include name="com/bdna/presentationModules/common/*" />
            <include name="com/bdna/presentationModules/hardware/PrinterDiscovery.xml" />
            <include name="com/bdna/presentationModules/os/AIX.xml" />
            <include name="com/bdna/presentationModules/os/Embedded.xml" />
            <include name="com/bdna/presentationModules/os/HPUX.xml" />
            <include name="com/bdna/presentationModules/os/IBMzOS.xml" />
            <include name="com/bdna/presentationModules/os/J2ME.xml" />
            <include name="com/bdna/presentationModules/os/Linux.xml" />
            <include name="com/bdna/presentationModules/os/MacOS.xml" />
            <include name="com/bdna/presentationModules/os/Netware.xml" />
            <include name="com/bdna/presentationModules/os/OracleVMServer.xml" />
            <include name="com/bdna/presentationModules/os/UNIX.xml" />
            <include name="com/bdna/presentationModules/os/VNwareESXServer.xml" />            
            <include name="com/bdna/presentationModules/os/Windows.xml" />
            <include name="com/bdna/presentationModules/os/WindowsL2.xml" />
            <include name="com/bdna/presentationModules/os/XenServer.xml" />
</fileset>


    <delete file="${bdna.content.dist}/modules/com/bdna/bdna_content.bar"/>
    <jar
        jarfile="${bdna.content.dist}/modules/com/bdna/bdna_content.bar"
        >
        <fileset refid="AdobeSoftware_modules"/>

        <manifest>
            <attribute name="Built-By" value="${user.name}"/>
            <section name="common">
              <attribute name="BDNA_CONTENT_PACK_NAME" value="${bdna.BCP.AdobeSoftware.label}"/>
              <attribute name="BDNA_CONTENT_BUILD_DATE" value="${bdna.content.build.stamp}"/>
              <attribute name="BDNA_CONTENT_VERSION_NUMBER" value="${bdna.BCP.AdobeSoftware.version}"/>
              <attribute name="BDNA_CONTENT_BUILD_NUMBER" value="${bcp.build.number}"/>
            </section>
            <section name="common/class1.class">
              <attribute name="Sealed" value="false"/>
            </section>
        </manifest>
    </jar>

</target>


<target name="content_installkit_bcp_AdobeSoftware" depends="dist_bcp_AdobeSoftware">
    <delete file="${bdna.nightly_builds.this_build}/AdobeSoftware_${bdna.BCP.AdobeSoftware.version}_${bcp.build.number}.seq"/>
    <delete file="${bdna.nightly_builds}/AdobeSoftware_latest.seq"/>

    <jar
        jarfile="${bdna.nightly_builds.this_build}/AdobeSoftware_${bdna.BCP.AdobeSoftware.version}_${bcp.build.number}.seq"
        basedir="${bdna.content.dist}">
    </jar>
    <copy file="${bdna.nightly_builds.this_build}/AdobeSoftware_${bdna.BCP.AdobeSoftware.version}_${bcp.build.number}.seq" tofile="${bdna.nightly_builds}/AdobeSoftware_latest.seq" />
</target>


<target name="prep_build_bcp_DellHardware">
    <delete dir="${bdna.content.build}" />
    <mkdir dir="${bdna.content.build}/modules" />
    <mkdir dir="${bdna.content.build}/appframe" />
    <mkdir dir="${bdna.content.build}/appdata" />
</target>


<!--                                                        -->
<!--            Generate the fingerprint modules            -->
<!--                                                        -->
<target name="generate_bcp_DellHardware" depends="prep_build_bcp_DellHardware">

    <!-- move the bdna modules, overwrite the generated version if any -->
    <copy todir="${bdna.content.build}/modules/">
        <fileset dir="${bdna.seq}/modules">
            <include name="com/bdna/modules/app/CleanupBDNATrace.xml" />
            <include name="com/bdna/modules/app/PotentialWindows.xml" />
            <include name="com/bdna/modules/app/procCleanup.xml" />
            <include name="com/bdna/modules/app/CPAWindows.xml" />
            <include name="com/bdna/modules/app/CPAUNIX.xml" />
            <include name="com/bdna/modules/app/CPACommon.xml" />
            <include name="com/bdna/modules/common/Discovery.xml" />
            <include name="com/bdna/modules/common/DisableUNIXProcessDepList.xml" />
            <include name="com/bdna/modules/common/SNMP.xml" />
            <include name="com/bdna/modules/common/ILOM.xml" />
            <include name="com/bdna/modules/hardware/DellPrinter.xml" />
            <include name="com/bdna/modules/os/AIX.xml" />
            <include name="com/bdna/modules/os/HPUX.xml" />
            <include name="com/bdna/modules/os/IRIX.xml" />
            <include name="com/bdna/modules/os/Linux.xml" />
            <include name="com/bdna/modules/os/Solaris.xml" />
            <include name="com/bdna/modules/os/Tru64.xml" />
            <include name="com/bdna/modules/os/UNIX.xml" />
            <include name="com/bdna/modules/os/Windows.xml" />
            <include name="com/bdna/modules/metadata/DellHardwareFlags.xml" />
            <include name="**/*.properties" />
        </fileset>
    </copy>


    <copy todir="${bdna.content.build}/modules/com/bdna/presentationModules">
        <fileset dir="${bdna.seq}/modules/com/bdna/presentationModules">
            <include name="app/PotentialWindows.xml" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.build}/modules/com/bdna/presentationModules">
        <fileset dir="${bdna.seq}/modules/com/bdna/presentationModules">
            <include name="os/AIX.xml" />
            <include name="os/Embedded.xml" />
            <include name="os/HPUX.xml" />
            <include name="os/IBMzOS.xml" />
            <include name="os/J2ME.xml" />
            <include name="os/Linux.xml" />
            <include name="os/MacOS.xml" />
            <include name="os/Netware.xml" />
            <include name="os/OracleVMServer.xml" />
            <include name="os/UNIX.xml" />
            <include name="os/VNwareESXServer.xml" />            
            <include name="os/Windows.xml" />
            <include name="os/WindowsL2.xml" />
            <include name="os/XenServer.xml" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.build}/modules/com/bdna/presentationModules">
        <fileset dir="${bdna.seq}/modules/com/bdna/presentationModules">
            <include name="common/*" />
            <exclude name="common/ADMTypesAndAttrsDef.xml" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.build}/modules/com/bdna/presentationModules">
        <fileset dir="${bdna.seq}/modules/com/bdna/presentationModules">
            <include name="hardware/PrinterDiscovery.xml" />
        </fileset>
    </copy>


    <!-- copy the built-in application modules -->
    <copy todir="${bdna.content.build}/appframe/com/bdna/modules/appmeta">
        <fileset dir="${bdna.seq}/com/bdna/app/application">
            <include name="AppConsole.xml" />
            <include name="DellHardwarePack.xml" />
            <include name="Folders.xml" />
            <include name="MarketData_SupportViews.xml" />
            <include name="MarketData.xml" />
            <include name="PublisherNIC.xml" />
            <include name="PublisherUNIX.xml" />
            <include name="StandardApplication.xml" />

        </fileset>
    </copy>


    <unzip src="${bdna.seq}/com/bdna/app/data/marketData-Common.zip" dest="${bdna.content.build}/appdata/" />
    <unzip src="${bdna.seq}/com/bdna/app/data/marketData-CPUcore.zip" dest="${bdna.content.build}/appdata/" />
    <unzip src="${bdna.seq}/com/bdna/app/data/marketData-DellHW.zip" dest="${bdna.content.build}/appdata/" />
    <unzip src="${bdna.seq}/com/bdna/app/data/marketData-UNIXL2.zip" dest="${bdna.content.build}/appdata/" />
    <unzip src="${bdna.seq}/com/bdna/app/data/marketData-WindowsL2.zip" dest="${bdna.content.build}/appdata/" />


     <!-- Insert Windows scripts into XML modules -->
     <java
         classname="com.bdna.fingerprintTool.ModulesTransformer"
         classpathref="javac.classpath"
         failonerror="true"
         dir="${bdna.seq}/modules"
         fork="yes" >
         <sysproperty key="bdna.home" value="${bdna.seq}"/>
         <arg value="${bdna.seq}" />
         <arg value="${bdna.content.build}" />
     </java>


    <copy todir="${bdna.content.build}/presentation">
        <fileset dir="${bdna.src}/presentation">
            <include name="**/*.xml" />
            <include name="**/*.properties" />
        </fileset>
    </copy>

</target>


<!--                                                        -->
<!--            Prepare the distribution directories        -->
<!--                                                        -->
<target name="prep_dist_bcp_DellHardware">
    <delete dir="${bdna.content.dist}" />
    <mkdir dir="${bdna.content.dist}/modules" />
    <mkdir dir="${bdna.content.dist}/modules/com" />
    <mkdir dir="${bdna.content.dist}/modules/com/bdna" />
    <mkdir dir="${bdna.content.dist}/appdata" />
    <mkdir dir="${bdna.content.dist}/appframe" />
    <mkdir dir="${bdna.content.dist}/MANIFEST" />
    <mkdir dir="${bdna.content.dist}/upgrade" />
</target>


<target name="dist_bcp_DellHardware" depends="init, generate_bcp_DellHardware, prep_dist_bcp_DellHardware, ui_engine_library">

    <copy file="${bdna.seq}/com/bdna/app/widget/WidgetLibrary.xml" todir="${bdna.content.dist}/appframe/com/bdna/modules/appmeta" />
    <copy file="${bdna.seq}/com/bdna/app/uiengine/HTMLEngineWidgetLibrary.xml" todir="${bdna.content.dist}/appframe/com/bdna/modules/appmeta" />
    <copy file="${bdna.seq}/com/bdna/app/uiengine/SwingEngineWidgetLibrary.xml" todir="${bdna.content.dist}/appframe/com/bdna/modules/appmeta" />

    <copy file="${bdna.seq}/content/manifests/DellHardwareManifest.xml" todir="${bdna.content.dist}/MANIFEST" />

    <copy file="${bdna.seq}/content/upgrade/upgrade.xml" tofile="${bdna.content.dist}/upgrade/upgrade.xml" />
    <copy file="${bdna.seq}/content/upgrade/upgrade.sh" tofile="${bdna.content.dist}/upgrade/upgrade.sh" />
    <copy file="${bdna.seq}/content/upgrade/pubTablesCleanup.sql" tofile="${bdna.content.dist}/upgrade/pubTablesCleanup.sql" />
    <copy file="${bdna.seq}/content/upgrade/removeMD_dups.sql" tofile="${bdna.content.dist}/upgrade/removeMD_dups.sql" />
    <copy file="${bdna.seq}/content/upgrade/upgradeContentReports.xml" tofile="${bdna.content.dist}/upgrade/upgradeContentReports.xml" />

    <replace file="${bdna.content.dist}/MANIFEST/DellHardwareManifest.xml" value="${bdna.bcp.version}">
        <replacefilter token="@bdna.bcp.version@"/>
    </replace>

    <replace file="${bdna.content.dist}/upgrade/upgrade.sh" value="${bdna.bcp.version}">
        <replacefilter token="@bdna.bcp.version@"/>
    </replace>
    <replace file="${bdna.content.dist}/upgrade/upgrade.sh" value="${bcp.build.number}">
        <replacefilter token="@bcp.build.number@"/>
    </replace>

<!--

<replace file="${bdna.seq}/content/manifests/BaselineManifest.xml">
  <replacetoken>contentBuildVersion="1"</replacetoken>
  <replacevalue>contentBuildVersion="${bcp.build.number}"</replacevalue>
</replace>

-->


    <copy todir="${bdna.content.dist}/appdata">
        <fileset dir="${bdna.content.build}/appdata">
            <include name="**" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.dist}/appframe">
        <fileset dir="${bdna.content.build}/appframe">
            <include name="**" />
        </fileset>
    </copy>



<fileset id="DellHardware_modules" dir="${bdna.content.build}/modules">
            <include name="com/bdna/modules/app/CleanupBDNATrace.xml" />
            <include name="com/bdna/modules/app/PotentialWindows.xml" />
            <include name="com/bdna/modules/app/procCleanup.xml" />
            <include name="com/bdna/modules/app/CPAWindows.xml" />
            <include name="com/bdna/modules/app/CPAUNIX.xml" />
            <include name="com/bdna/modules/app/CPACommon.xml" />
            <include name="com/bdna/modules/common/Discovery.xml" />
            <include name="com/bdna/modules/common/DisableUNIXProcessDepList.xml" />
            <include name="com/bdna/modules/common/SNMP.xml" />
            <include name="com/bdna/modules/common/ILOM.xml" />
            <include name="com/bdna/modules/hardware/DellPrinter.xml" />
            <include name="com/bdna/modules/os/AIX.xml" />
            <include name="com/bdna/modules/os/HPUX.xml" />
            <include name="com/bdna/modules/os/IRIX.xml" />
            <include name="com/bdna/modules/os/Linux.xml" />
            <include name="com/bdna/modules/os/Solaris.xml" />
            <include name="com/bdna/modules/os/Tru64.xml" />
            <include name="com/bdna/modules/os/UNIX.xml" />
            <include name="com/bdna/modules/os/Windows.xml" />
            <include name="com/bdna/modules/metadata/DellHardwareFlags.xml" />
            <include name="**/*.properties" />
            <include name="com/bdna/presentationModules/app/PotentialWindows.xml" />
            <include name="com/bdna/presentationModules/common/*" />
            <include name="com/bdna/presentationModules/hardware/PrinterDiscovery.xml" />
            <include name="com/bdna/presentationModules/os/AIX.xml" />
            <include name="com/bdna/presentationModules/os/Embedded.xml" />
            <include name="com/bdna/presentationModules/os/HPUX.xml" />
            <include name="com/bdna/presentationModules/os/IBMzOS.xml" />
            <include name="com/bdna/presentationModules/os/J2ME.xml" />
            <include name="com/bdna/presentationModules/os/Linux.xml" />
            <include name="com/bdna/presentationModules/os/MacOS.xml" />
            <include name="com/bdna/presentationModules/os/Netware.xml" />
            <include name="com/bdna/presentationModules/os/OracleVMServer.xml" />
            <include name="com/bdna/presentationModules/os/UNIX.xml" />
            <include name="com/bdna/presentationModules/os/VNwareESXServer.xml" />            
            <include name="com/bdna/presentationModules/os/Windows.xml" />
            <include name="com/bdna/presentationModules/os/WindowsL2.xml" />
            <include name="com/bdna/presentationModules/os/XenServer.xml" />
</fileset>



    <delete file="${bdna.content.dist}/modules/com/bdna/bdna_content.bar"/>
    <jar
        jarfile="${bdna.content.dist}/modules/com/bdna/bdna_content.bar"
        >
        <fileset refid="DellHardware_modules"/>

        <manifest>
            <attribute name="Built-By" value="${user.name}"/>
            <section name="common">
              <attribute name="BDNA_CONTENT_PACK_NAME" value="${bdna.BCP.DellHardware.label}"/>
              <attribute name="BDNA_CONTENT_BUILD_DATE" value="${bdna.content.build.stamp}"/>
              <attribute name="BDNA_CONTENT_VERSION_NUMBER" value="${bdna.BCP.DellHardware.version}"/>
              <attribute name="BDNA_CONTENT_BUILD_NUMBER" value="${bcp.build.number}"/>
            </section>
            <section name="common/class1.class">
              <attribute name="Sealed" value="false"/>
            </section>
        </manifest>
    </jar>

</target>


<target name="content_installkit_bcp_DellHardware" depends="dist_bcp_DellHardware">
    <delete file="${bdna.nightly_builds.this_build}/DellHardware_${bdna.BCP.DellHardware.version}_${bcp.build.number}.seq"/>
    <delete file="${bdna.nightly_builds}/DellHardware_latest.seq"/>

    <jar
        destfile="${bdna.nightly_builds.this_build}/DellHardware_${bdna.BCP.DellHardware.version}_${bcp.build.number}.seq"
        basedir="${bdna.content.dist}" >
    </jar>
    <copy file="${bdna.nightly_builds.this_build}/DellHardware_${bdna.BCP.DellHardware.version}_${bcp.build.number}.seq" tofile="${bdna.nightly_builds}/DellHardware_latest.seq" />
</target>


<target name="prep_build_bcp_HPHardware">
    <delete dir="${bdna.content.build}" />
    <mkdir dir="${bdna.content.build}/modules" />
    <mkdir dir="${bdna.content.build}/appframe" />
    <mkdir dir="${bdna.content.build}/appdata" />
</target>


<!--                                                        -->
<!--            Generate the fingerprint modules            -->
<!--                                                        -->
<target name="generate_bcp_HPHardware" depends="prep_build_bcp_HPHardware">

    <!-- move the bdna modules, overwrite the generated version if any -->
    <copy todir="${bdna.content.build}/modules/">
        <fileset dir="${bdna.seq}/modules">
            <include name="com/bdna/modules/app/CleanupBDNATrace.xml" />
            <include name="com/bdna/modules/app/PotentialWindows.xml" />
            <include name="com/bdna/modules/app/procCleanup.xml" />
            <include name="com/bdna/modules/app/CPAWindows.xml" />
            <include name="com/bdna/modules/app/CPAUNIX.xml" />
            <include name="com/bdna/modules/app/CPACommon.xml" />
            <include name="com/bdna/modules/common/Discovery.xml" />
            <include name="com/bdna/modules/common/DisableUNIXProcessDepList.xml" />
            <include name="com/bdna/modules/common/SNMP.xml" />
            <include name="com/bdna/modules/common/ILOM.xml" />
            <include name="com/bdna/modules/hardware/HPFabricSwitchDiscovery.xml" />
            <include name="com/bdna/modules/network/HPSwitchDiscovery.xml" />
            <include name="com/bdna/modules/os/AIX.xml" />
            <include name="com/bdna/modules/os/HPUX.xml" />
            <include name="com/bdna/modules/os/IRIX.xml" />
            <include name="com/bdna/modules/os/Linux.xml" />
            <include name="com/bdna/modules/os/Solaris.xml" />
            <include name="com/bdna/modules/os/Tru64.xml" />
            <include name="com/bdna/modules/os/UNIX.xml" />
            <include name="com/bdna/modules/os/Windows.xml" />
            <include name="com/bdna/modules/metadata/HPHardwareFlags.xml" />
            <include name="**/*.properties" />
        </fileset>
    </copy>


    <copy todir="${bdna.content.build}/modules/com/bdna/presentationModules">
        <fileset dir="${bdna.seq}/modules/com/bdna/presentationModules">
            <include name="app/PotentialWindows.xml" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.build}/modules/com/bdna/presentationModules">
        <fileset dir="${bdna.seq}/modules/com/bdna/presentationModules">
            <include name="os/AIX.xml" />
            <include name="os/Embedded.xml" />
            <include name="os/HPUX.xml" />
            <include name="os/IBMzOS.xml" />
            <include name="os/J2ME.xml" />
            <include name="os/Linux.xml" />
            <include name="os/MacOS.xml" />
            <include name="os/Netware.xml" />
            <include name="os/OracleVMServer.xml" />
            <include name="os/UNIX.xml" />
            <include name="os/VNwareESXServer.xml" />            
            <include name="os/Windows.xml" />
            <include name="os/WindowsL2.xml" />
            <include name="os/XenServer.xml" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.build}/modules/com/bdna/presentationModules">
        <fileset dir="${bdna.seq}/modules/com/bdna/presentationModules">
            <include name="common/*" />
            <exclude name="common/ADMTypesAndAttrsDef.xml" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.build}/modules/com/bdna/presentationModules">
        <fileset dir="${bdna.seq}/modules/com/bdna/presentationModules">
            <include name="hardware/PrinterDiscovery.xml" />
        </fileset>
    </copy>


    <!-- copy the built-in application modules -->
    <copy todir="${bdna.content.build}/appframe/com/bdna/modules/appmeta">
        <fileset dir="${bdna.seq}/com/bdna/app/application">
            <include name="AppConsole.xml" />
            <include name="HPHardwarePack.xml" />
            <include name="Folders.xml" />
            <include name="MarketData_SupportViews.xml" />
            <include name="MarketData.xml" />
            <include name="PublisherNIC.xml" />
            <include name="PublisherUNIX.xml" />
            <include name="StandardApplication.xml" />
        </fileset>
    </copy>


    <unzip src="${bdna.seq}/com/bdna/app/data/marketData-Common.zip" dest="${bdna.content.build}/appdata/" />
    <unzip src="${bdna.seq}/com/bdna/app/data/marketData-CPUcore.zip" dest="${bdna.content.build}/appdata/" />
    <unzip src="${bdna.seq}/com/bdna/app/data/marketData-HPHW.zip" dest="${bdna.content.build}/appdata/" />
    <unzip src="${bdna.seq}/com/bdna/app/data/marketData-UNIXL2.zip" dest="${bdna.content.build}/appdata/" />
    <unzip src="${bdna.seq}/com/bdna/app/data/marketData-WindowsL2.zip" dest="${bdna.content.build}/appdata/" />


     <!-- Insert Windows scripts into XML modules -->
     <java
         classname="com.bdna.fingerprintTool.ModulesTransformer"
         classpathref="javac.classpath"
         failonerror="true"
         dir="${bdna.seq}/modules"
         fork="yes" >
         <sysproperty key="bdna.home" value="${bdna.seq}"/>
         <arg value="${bdna.seq}" />
         <arg value="${bdna.content.build}" />
     </java>


    <copy todir="${bdna.content.build}/presentation">
        <fileset dir="${bdna.src}/presentation">
            <include name="**/*.xml" />
            <include name="**/*.properties" />
        </fileset>
    </copy>

</target>


<!--                                                        -->
<!--            Prepare the distribution directories        -->
<!--                                                        -->
<target name="prep_dist_bcp_HPHardware">
    <delete dir="${bdna.content.dist}" />
    <mkdir dir="${bdna.content.dist}/modules" />
    <mkdir dir="${bdna.content.dist}/modules/com" />
    <mkdir dir="${bdna.content.dist}/modules/com/bdna" />
    <mkdir dir="${bdna.content.dist}/appdata" />
    <mkdir dir="${bdna.content.dist}/appframe" />
    <mkdir dir="${bdna.content.dist}/MANIFEST" />
    <mkdir dir="${bdna.content.dist}/upgrade" />
</target>


<target name="dist_bcp_HPHardware" depends="init, generate_bcp_HPHardware, prep_dist_bcp_HPHardware, ui_engine_library">

    <copy file="${bdna.seq}/com/bdna/app/widget/WidgetLibrary.xml" todir="${bdna.content.dist}/appframe/com/bdna/modules/appmeta" />
    <copy file="${bdna.seq}/com/bdna/app/uiengine/HTMLEngineWidgetLibrary.xml" todir="${bdna.content.dist}/appframe/com/bdna/modules/appmeta" />
    <copy file="${bdna.seq}/com/bdna/app/uiengine/SwingEngineWidgetLibrary.xml" todir="${bdna.content.dist}/appframe/com/bdna/modules/appmeta" />

    <copy file="${bdna.seq}/content/manifests/HPHardwareManifest.xml" todir="${bdna.content.dist}/MANIFEST" />

    <copy file="${bdna.seq}/content/upgrade/upgrade.xml" tofile="${bdna.content.dist}/upgrade/upgrade.xml" />
    <copy file="${bdna.seq}/content/upgrade/upgrade.sh" tofile="${bdna.content.dist}/upgrade/upgrade.sh" />
    <copy file="${bdna.seq}/content/upgrade/pubTablesCleanup.sql" tofile="${bdna.content.dist}/upgrade/pubTablesCleanup.sql" />
    <copy file="${bdna.seq}/content/upgrade/removeMD_dups.sql" tofile="${bdna.content.dist}/upgrade/removeMD_dups.sql" />
    <copy file="${bdna.seq}/content/upgrade/upgradeContentReports.xml" tofile="${bdna.content.dist}/upgrade/upgradeContentReports.xml" />

    <replace file="${bdna.content.dist}/MANIFEST/HPHardwareManifest.xml" value="${bdna.bcp.version}">
        <replacefilter token="@bdna.bcp.version@"/>
    </replace>

    <replace file="${bdna.content.dist}/upgrade/upgrade.sh" value="${bdna.bcp.version}">
        <replacefilter token="@bdna.bcp.version@"/>
    </replace>
    <replace file="${bdna.content.dist}/upgrade/upgrade.sh" value="${bcp.build.number}">
        <replacefilter token="@bcp.build.number@"/>
    </replace>

<!--

<replace file="${bdna.seq}/content/manifests/BaselineManifest.xml">
  <replacetoken>contentBuildVersion="1"</replacetoken>
  <replacevalue>contentBuildVersion="${bcp.build.number}"</replacevalue>
</replace>

-->


    <copy todir="${bdna.content.dist}/appdata">
        <fileset dir="${bdna.content.build}/appdata">
            <include name="**" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.dist}/appframe">
        <fileset dir="${bdna.content.build}/appframe">
            <include name="**" />
        </fileset>
    </copy>



<fileset id="HPHardware_modules" dir="${bdna.content.build}/modules">
            <include name="com/bdna/modules/app/CleanupBDNATrace.xml" />
            <include name="com/bdna/modules/app/PotentialWindows.xml" />
            <include name="com/bdna/modules/app/procCleanup.xml" />
            <include name="com/bdna/modules/app/CPAWindows.xml" />
            <include name="com/bdna/modules/app/CPAUNIX.xml" />
            <include name="com/bdna/modules/app/CPACommon.xml" />
            <include name="com/bdna/modules/common/Discovery.xml" />
            <include name="com/bdna/modules/common/DisableUNIXProcessDepList.xml" />
            <include name="com/bdna/modules/common/SNMP.xml" />
            <include name="com/bdna/modules/common/ILOM.xml" />
            <include name="com/bdna/modules/hardware/HPFabricSwitchDiscovery.xml" />
            <include name="com/bdna/modules/network/HPSwitchDiscovery.xml" />
            <include name="com/bdna/modules/os/AIX.xml" />
            <include name="com/bdna/modules/os/HPUX.xml" />
            <include name="com/bdna/modules/os/IRIX.xml" />
            <include name="com/bdna/modules/os/Linux.xml" />
            <include name="com/bdna/modules/os/Solaris.xml" />
            <include name="com/bdna/modules/os/Tru64.xml" />
            <include name="com/bdna/modules/os/UNIX.xml" />
            <include name="com/bdna/modules/os/Windows.xml" />
            <include name="com/bdna/modules/metadata/HPHardwareFlags.xml" />
            <include name="**/*.properties" />
            <include name="com/bdna/presentationModules/app/PotentialWindows.xml" />
            <include name="com/bdna/presentationModules/common/*" />
            <include name="com/bdna/presentationModules/hardware/PrinterDiscovery.xml" />
            <include name="com/bdna/presentationModules/os/AIX.xml" />
            <include name="com/bdna/presentationModules/os/Embedded.xml" />
            <include name="com/bdna/presentationModules/os/HPUX.xml" />
            <include name="com/bdna/presentationModules/os/IBMzOS.xml" />
            <include name="com/bdna/presentationModules/os/J2ME.xml" />
            <include name="com/bdna/presentationModules/os/Linux.xml" />
            <include name="com/bdna/presentationModules/os/MacOS.xml" />
            <include name="com/bdna/presentationModules/os/Netware.xml" />
            <include name="com/bdna/presentationModules/os/OracleVMServer.xml" />
            <include name="com/bdna/presentationModules/os/UNIX.xml" />
            <include name="com/bdna/presentationModules/os/VNwareESXServer.xml" />            
            <include name="com/bdna/presentationModules/os/Windows.xml" />
            <include name="com/bdna/presentationModules/os/WindowsL2.xml" />
            <include name="com/bdna/presentationModules/os/XenServer.xml" />
</fileset>



    <delete file="${bdna.content.dist}/modules/com/bdna/bdna_content.bar"/>
    <jar
        jarfile="${bdna.content.dist}/modules/com/bdna/bdna_content.bar"
        >
        <fileset refid="HPHardware_modules"/>

        <manifest>
            <attribute name="Built-By" value="${user.name}"/>
            <section name="common">
              <attribute name="BDNA_CONTENT_PACK_NAME" value="${bdna.BCP.HPHardware.label}"/>
              <attribute name="BDNA_CONTENT_BUILD_DATE" value="${bdna.content.build.stamp}"/>
              <attribute name="BDNA_CONTENT_VERSION_NUMBER" value="${bdna.BCP.HPHardware.version}"/>
              <attribute name="BDNA_CONTENT_BUILD_NUMBER" value="${bcp.build.number}"/>
            </section>
            <section name="common/class1.class">
              <attribute name="Sealed" value="false"/>
            </section>
        </manifest>
    </jar>

</target>


<target name="content_installkit_bcp_HPHardware" depends="dist_bcp_HPHardware">
    <delete file="${bdna.nightly_builds.this_build}/HPHardware_${bdna.BCP.HPHardware.version}_${bcp.build.number}.seq"/>
    <delete file="${bdna.nightly_builds}/HPHardware_latest.seq"/>

    <jar
        destfile="${bdna.nightly_builds.this_build}/HPHardware_${bdna.BCP.HPHardware.version}_${bcp.build.number}.seq"
        basedir="${bdna.content.dist}" >
    </jar>
    <copy file="${bdna.nightly_builds.this_build}/HPHardware_${bdna.BCP.HPHardware.version}_${bcp.build.number}.seq" tofile="${bdna.nightly_builds}/HPHardware_latest.seq" />
</target>


<target name="prep_build_bcp_CiscoHardware">
    <delete dir="${bdna.content.build}" />
    <mkdir dir="${bdna.content.build}/modules" />
    <mkdir dir="${bdna.content.build}/appframe" />
    <mkdir dir="${bdna.content.build}/appdata" />
</target>


<!--                                                        -->
<!--            Generate the fingerprint modules            -->
<!--                                                        -->
<target name="generate_bcp_CiscoHardware" depends="prep_build_bcp_CiscoHardware">

    <!-- move the bdna modules, overwrite the generated version if any -->
    <copy todir="${bdna.content.build}/modules/">
        <fileset dir="${bdna.seq}/modules">
            <include name="com/bdna/modules/app/CleanupBDNATrace.xml" />
            <include name="com/bdna/modules/app/PotentialWindows.xml" />
            <include name="com/bdna/modules/app/procCleanup.xml" />
            <include name="com/bdna/modules/app/CPAWindows.xml" />
            <include name="com/bdna/modules/app/CPAUNIX.xml" />
            <include name="com/bdna/modules/app/CPACommon.xml" />
            <include name="com/bdna/modules/common/Discovery.xml" />
            <include name="com/bdna/modules/common/DisableUNIXProcessDepList.xml" />
            <include name="com/bdna/modules/common/SNMP.xml" />
            <include name="com/bdna/modules/common/ILOM.xml" />
            <include name="com/bdna/modules/hardware/CiscoFabricSwitchDiscovery.xml" />
            <include name="com/bdna/modules/network/CiscoRouterDiscovery.xml" />
            <include name="com/bdna/modules/network/CiscoSwitchDiscovery.xml" />
            <include name="com/bdna/modules/os/AIX.xml" />
            <include name="com/bdna/modules/os/HPUX.xml" />
            <include name="com/bdna/modules/os/IRIX.xml" />
            <include name="com/bdna/modules/os/Linux.xml" />
            <include name="com/bdna/modules/os/Solaris.xml" />
            <include name="com/bdna/modules/os/Tru64.xml" />
            <include name="com/bdna/modules/os/UNIX.xml" />
            <include name="com/bdna/modules/os/Windows.xml" />
            <include name="com/bdna/modules/metadata/CiscoHardwareFlags.xml" />
            <include name="**/*.properties" />
        </fileset>
    </copy>


    <copy todir="${bdna.content.build}/modules/com/bdna/presentationModules">
        <fileset dir="${bdna.seq}/modules/com/bdna/presentationModules">
            <include name="app/PotentialWindows.xml" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.build}/modules/com/bdna/presentationModules">
        <fileset dir="${bdna.seq}/modules/com/bdna/presentationModules">
            <include name="os/AIX.xml" />
            <include name="os/Embedded.xml" />
            <include name="os/HPUX.xml" />
            <include name="os/IBMzOS.xml" />
            <include name="os/J2ME.xml" />
            <include name="os/Linux.xml" />
            <include name="os/MacOS.xml" />
            <include name="os/Netware.xml" />
            <include name="os/OracleVMServer.xml" />
            <include name="os/UNIX.xml" />
            <include name="os/VNwareESXServer.xml" />            
            <include name="os/Windows.xml" />
            <include name="os/WindowsL2.xml" />
            <include name="os/XenServer.xml" />
            <include name="network/CiscoRouterDiscovery.xml" />
            <include name="network/CiscoSwitchDiscovery.xml" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.build}/modules/com/bdna/presentationModules">
        <fileset dir="${bdna.seq}/modules/com/bdna/presentationModules">
            <include name="common/*" />
            <exclude name="common/ADMTypesAndAttrsDef.xml" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.build}/modules/com/bdna/presentationModules">
        <fileset dir="${bdna.seq}/modules/com/bdna/presentationModules">
            <include name="hardware/PrinterDiscovery.xml" />
        </fileset>
    </copy>


    <!-- copy the built-in application modules -->
    <copy todir="${bdna.content.build}/appframe/com/bdna/modules/appmeta">
        <fileset dir="${bdna.seq}/com/bdna/app/application">
            <include name="CiscoHardwarePack.xml" />
            <include name="Folders.xml" />
            <include name="MarketData_SupportViews.xml" />
            <include name="MarketData.xml" />
            <include name="StandardApplication.xml" />
        </fileset>
    </copy>


    <unzip src="${bdna.seq}/com/bdna/app/data/marketData-Common.zip" dest="${bdna.content.build}/appdata/" />
    <unzip src="${bdna.seq}/com/bdna/app/data/marketData-CPUcore.zip" dest="${bdna.content.build}/appdata/" />
    <unzip src="${bdna.seq}/com/bdna/app/data/marketData-CiscoHW.zip" dest="${bdna.content.build}/appdata/" />
    <unzip src="${bdna.seq}/com/bdna/app/data/marketData-UNIXL2.zip" dest="${bdna.content.build}/appdata/" />
    <unzip src="${bdna.seq}/com/bdna/app/data/marketData-WindowsL2.zip" dest="${bdna.content.build}/appdata/" />


     <!-- Insert Windows scripts into XML modules -->
     <java
         classname="com.bdna.fingerprintTool.ModulesTransformer"
         classpathref="javac.classpath"
         failonerror="true"
         dir="${bdna.seq}/modules"
         fork="yes" >
         <sysproperty key="bdna.home" value="${bdna.seq}"/>
         <arg value="${bdna.seq}" />
         <arg value="${bdna.content.build}" />
     </java>


    <copy todir="${bdna.content.build}/presentation">
        <fileset dir="${bdna.src}/presentation">
            <include name="**/*.xml" />
            <include name="**/*.properties" />
        </fileset>
    </copy>

</target>


<!--                                                        -->
<!--            Prepare the distribution directories        -->
<!--                                                        -->
<target name="prep_dist_bcp_CiscoHardware">
    <delete dir="${bdna.content.dist}" />
    <mkdir dir="${bdna.content.dist}/modules" />
    <mkdir dir="${bdna.content.dist}/modules/com" />
    <mkdir dir="${bdna.content.dist}/modules/com/bdna" />
    <mkdir dir="${bdna.content.dist}/appdata" />
    <mkdir dir="${bdna.content.dist}/appframe" />
    <mkdir dir="${bdna.content.dist}/MANIFEST" />
    <mkdir dir="${bdna.content.dist}/upgrade" />
</target>


<target name="dist_bcp_CiscoHardware" depends="init, generate_bcp_CiscoHardware, prep_dist_bcp_CiscoHardware, ui_engine_library">

    <copy file="${bdna.seq}/com/bdna/app/widget/WidgetLibrary.xml" todir="${bdna.content.dist}/appframe/com/bdna/modules/appmeta" />
    <copy file="${bdna.seq}/com/bdna/app/uiengine/HTMLEngineWidgetLibrary.xml" todir="${bdna.content.dist}/appframe/com/bdna/modules/appmeta" />
    <copy file="${bdna.seq}/com/bdna/app/uiengine/SwingEngineWidgetLibrary.xml" todir="${bdna.content.dist}/appframe/com/bdna/modules/appmeta" />

    <copy file="${bdna.seq}/content/manifests/CiscoHardwareManifest.xml" todir="${bdna.content.dist}/MANIFEST" />

    <copy file="${bdna.seq}/content/upgrade/upgrade.xml" tofile="${bdna.content.dist}/upgrade/upgrade.xml" />
    <copy file="${bdna.seq}/content/upgrade/upgrade.sh" tofile="${bdna.content.dist}/upgrade/upgrade.sh" />
    <copy file="${bdna.seq}/content/upgrade/pubTablesCleanup.sql" tofile="${bdna.content.dist}/upgrade/pubTablesCleanup.sql" />
    <copy file="${bdna.seq}/content/upgrade/removeMD_dups.sql" tofile="${bdna.content.dist}/upgrade/removeMD_dups.sql" />
    <copy file="${bdna.seq}/content/upgrade/upgradeContentReports.xml" tofile="${bdna.content.dist}/upgrade/upgradeContentReports.xml" />

    <replace file="${bdna.content.dist}/MANIFEST/CiscoHardwareManifest.xml" value="${bdna.bcp.version}">
        <replacefilter token="@bdna.bcp.version@"/>
    </replace>

    <replace file="${bdna.content.dist}/upgrade/upgrade.sh" value="${bdna.bcp.version}">
        <replacefilter token="@bdna.bcp.version@"/>
    </replace>
    <replace file="${bdna.content.dist}/upgrade/upgrade.sh" value="${bcp.build.number}">
        <replacefilter token="@bcp.build.number@"/>
    </replace>

<!--

<replace file="${bdna.seq}/content/manifests/BaselineManifest.xml">
  <replacetoken>contentBuildVersion="1"</replacetoken>
  <replacevalue>contentBuildVersion="${bcp.build.number}"</replacevalue>
</replace>

-->


    <copy todir="${bdna.content.dist}/appdata">
        <fileset dir="${bdna.content.build}/appdata">
            <include name="**" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.dist}/appframe">
        <fileset dir="${bdna.content.build}/appframe">
            <include name="**" />
        </fileset>
    </copy>



<fileset id="CiscoHardware_modules" dir="${bdna.content.build}/modules">
            <include name="com/bdna/modules/app/CleanupBDNATrace.xml" />
            <include name="com/bdna/modules/app/PotentialWindows.xml" />
            <include name="com/bdna/modules/app/procCleanup.xml" />
            <include name="com/bdna/modules/app/CPAWindows.xml" />
            <include name="com/bdna/modules/app/CPAUNIX.xml" />
            <include name="com/bdna/modules/app/CPACommon.xml" />
            <include name="com/bdna/modules/common/Discovery.xml" />
            <include name="com/bdna/modules/common/DisableUNIXProcessDepList.xml" />
            <include name="com/bdna/modules/common/SNMP.xml" />
            <include name="com/bdna/modules/common/ILOM.xml" />
            <include name="com/bdna/modules/hardware/IBMFabricSwitchDiscovery.xml" />
            <include name="com/bdna/modules/network/CiscoRouterDiscovery.xml" />
            <include name="com/bdna/modules/network/CiscoSwitchDiscovery.xml" />
            <include name="com/bdna/modules/os/AIX.xml" />
            <include name="com/bdna/modules/os/HPUX.xml" />
            <include name="com/bdna/modules/os/IRIX.xml" />
            <include name="com/bdna/modules/os/Linux.xml" />
            <include name="com/bdna/modules/os/Solaris.xml" />
            <include name="com/bdna/modules/os/Tru64.xml" />
            <include name="com/bdna/modules/os/UNIX.xml" />
            <include name="com/bdna/modules/os/Windows.xml" />
            <include name="com/bdna/modules/metadata/CiscoHardwareFlags.xml" />
            <include name="**/*.properties" />
            <include name="com/bdna/presentationModules/app/PotentialWindows.xml" />
            <include name="com/bdna/presentationModules/network/CiscoRouterDiscovery.xml" />
            <include name="com/bdna/presentationModules/network/CiscoSwitchDiscovery.xml" />
            <include name="com/bdna/presentationModules/common/*" />
            <include name="com/bdna/presentationModules/hardware/PrinterDiscovery.xml" />
            <include name="com/bdna/presentationModules/os/AIX.xml" />
            <include name="com/bdna/presentationModules/os/Embedded.xml" />
            <include name="com/bdna/presentationModules/os/HPUX.xml" />
            <include name="com/bdna/presentationModules/os/IBMzOS.xml" />
            <include name="com/bdna/presentationModules/os/J2ME.xml" />
            <include name="com/bdna/presentationModules/os/Linux.xml" />
            <include name="com/bdna/presentationModules/os/MacOS.xml" />
            <include name="com/bdna/presentationModules/os/Netware.xml" />
            <include name="com/bdna/presentationModules/os/OracleVMServer.xml" />
            <include name="com/bdna/presentationModules/os/UNIX.xml" />
            <include name="com/bdna/presentationModules/os/VNwareESXServer.xml" />            
            <include name="com/bdna/presentationModules/os/Windows.xml" />
            <include name="com/bdna/presentationModules/os/WindowsL2.xml" />
            <include name="com/bdna/presentationModules/os/XenServer.xml" />
</fileset>



    <delete file="${bdna.content.dist}/modules/com/bdna/bdna_content.bar"/>
    <jar
        jarfile="${bdna.content.dist}/modules/com/bdna/bdna_content.bar"
        >
        <fileset refid="CiscoHardware_modules"/>

        <manifest>
            <attribute name="Built-By" value="${user.name}"/>
            <section name="common">
              <attribute name="BDNA_CONTENT_PACK_NAME" value="${bdna.BCP.CiscoHardware.label}"/>
              <attribute name="BDNA_CONTENT_BUILD_DATE" value="${bdna.content.build.stamp}"/>
              <attribute name="BDNA_CONTENT_VERSION_NUMBER" value="${bdna.BCP.CiscoHardware.version}"/>
              <attribute name="BDNA_CONTENT_BUILD_NUMBER" value="${bcp.build.number}"/>
            </section>
            <section name="common/class1.class">
              <attribute name="Sealed" value="false"/>
            </section>
        </manifest>
    </jar>

</target>



<target name="content_installkit_bcp_CiscoHardware" depends="dist_bcp_CiscoHardware">
    <delete file="${bdna.nightly_builds.this_build}/CiscoHardware_${bdna.BCP.CiscoHardware.version}_${bcp.build.number}.seq"/>
    <delete file="${bdna.nightly_builds}/CiscoHardware_latest.seq"/>

    <jar
        destfile="${bdna.nightly_builds.this_build}/CiscoHardware_${bdna.BCP.CiscoHardware.version}_${bcp.build.number}.seq"
        basedir="${bdna.content.dist}" >
    </jar>
    <copy file="${bdna.nightly_builds.this_build}/CiscoHardware_${bdna.BCP.CiscoHardware.version}_${bcp.build.number}.seq" tofile="${bdna.nightly_builds}/CiscoHardware_latest.seq" />
</target>


<target name="prep_build_bcp_HardwareEnergy">
    <delete dir="${bdna.content.build}" />
    <mkdir dir="${bdna.content.build}/modules" />
    <mkdir dir="${bdna.content.build}/appframe" />
    <mkdir dir="${bdna.content.build}/appdata" />
</target>


<!--                                                        -->
<!--            Generate the fingerprint modules            -->
<!--                                                        -->
<target name="generate_bcp_HardwareEnergy" depends="prep_build_bcp_HardwareEnergy">

    <!-- move the bdna modules, overwrite the generated version if any -->
    <copy todir="${bdna.content.build}/modules/">
        <fileset dir="${bdna.seq}/modules">
            <include name="com/bdna/modules/app/CleanupBDNATrace.xml" />
            <include name="com/bdna/modules/app/PotentialWindows.xml" />
            <include name="com/bdna/modules/app/procCleanup.xml" />
            <include name="com/bdna/modules/app/CPAWindows.xml" />
            <include name="com/bdna/modules/app/CPAUNIX.xml" />
            <include name="com/bdna/modules/app/CPACommon.xml" />
            <include name="com/bdna/modules/common/Discovery.xml" />
            <include name="com/bdna/modules/common/DisableUNIXProcessDepList.xml" />
            <include name="com/bdna/modules/common/SNMP.xml" />
            <include name="com/bdna/modules/common/ILOM.xml" />
            <include name="com/bdna/modules/os/AIX.xml" />
            <include name="com/bdna/modules/os/HPUX.xml" />
            <include name="com/bdna/modules/os/IRIX.xml" />
            <include name="com/bdna/modules/os/Linux.xml" />
            <include name="com/bdna/modules/os/Solaris.xml" />
            <include name="com/bdna/modules/os/Tru64.xml" />
            <include name="com/bdna/modules/os/UNIX.xml" />
            <include name="com/bdna/modules/os/Windows.xml" />
            <include name="**/*.properties" />
        </fileset>
    </copy>


    <copy todir="${bdna.content.build}/modules/com/bdna/presentationModules">
        <fileset dir="${bdna.seq}/modules/com/bdna/presentationModules">
            <include name="app/PotentialWindows.xml" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.build}/modules/com/bdna/presentationModules">
        <fileset dir="${bdna.seq}/modules/com/bdna/presentationModules">
            <include name="os/AIX.xml" />
            <include name="os/Embedded.xml" />
            <include name="os/HPUX.xml" />
            <include name="os/IBMzOS.xml" />
            <include name="os/J2ME.xml" />
            <include name="os/Linux.xml" />
            <include name="os/MacOS.xml" />
            <include name="os/Netware.xml" />
            <include name="os/OracleVMServer.xml" />
            <include name="os/UNIX.xml" />
            <include name="os/VNwareESXServer.xml" />            
            <include name="os/Windows.xml" />
            <include name="os/WindowsL2.xml" />
            <include name="os/XenServer.xml" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.build}/modules/com/bdna/presentationModules">
        <fileset dir="${bdna.seq}/modules/com/bdna/presentationModules">
            <include name="common/*" />
            <exclude name="common/ADMTypesAndAttrsDef.xml" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.build}/modules/com/bdna/presentationModules">
        <fileset dir="${bdna.seq}/modules/com/bdna/presentationModules">
            <include name="hardware/PrinterDiscovery.xml" />
        </fileset>
    </copy>


    <!-- copy the built-in application modules -->
    <copy todir="${bdna.content.build}/appframe/com/bdna/modules/appmeta">
        <fileset dir="${bdna.seq}/com/bdna/app/application">
            <include name="AppConsole.xml" />
            <include name="HardwareEnergyPack.xml" />
            <include name="Folders.xml" />
            <include name="MarketData_SupportViews.xml" />
            <include name="MarketData.xml" />
            <include name="StandardApplication.xml" />
        </fileset>
    </copy>

    <unzip src="${bdna.seq}/com/bdna/app/data/marketData-Common.zip" dest="${bdna.content.build}/appdata/" />
    <unzip src="${bdna.seq}/com/bdna/app/data/marketData-CPUcore.zip" dest="${bdna.content.build}/appdata/" />
    <unzip src="${bdna.seq}/com/bdna/app/data/marketData-HWEnergy.zip" dest="${bdna.content.build}/appdata/" />
    <unzip src="${bdna.seq}/com/bdna/app/data/marketData-UNIXL2.zip" dest="${bdna.content.build}/appdata/" />
    <unzip src="${bdna.seq}/com/bdna/app/data/marketData-WindowsL2.zip" dest="${bdna.content.build}/appdata/" />



     <!-- Insert Windows scripts into XML modules -->
     <java
         classname="com.bdna.fingerprintTool.ModulesTransformer"
         classpathref="javac.classpath"
         failonerror="true"
         dir="${bdna.seq}/modules"
         fork="yes" >
         <sysproperty key="bdna.home" value="${bdna.seq}"/>
         <arg value="${bdna.seq}" />
         <arg value="${bdna.content.build}" />
     </java>


    <copy todir="${bdna.content.build}/presentation">
        <fileset dir="${bdna.src}/presentation">
            <include name="**/*.xml" />
            <include name="**/*.properties" />
        </fileset>
    </copy>

</target>


<!--                                                        -->
<!--            Prepare the distribution directories        -->
<!--                                                        -->
<target name="prep_dist_bcp_HardwareEnergy">
    <delete dir="${bdna.content.dist}" />
    <mkdir dir="${bdna.content.dist}/modules" />
    <mkdir dir="${bdna.content.dist}/modules/com" />
    <mkdir dir="${bdna.content.dist}/modules/com/bdna" />
    <mkdir dir="${bdna.content.dist}/appdata" />
    <mkdir dir="${bdna.content.dist}/appframe" />
    <mkdir dir="${bdna.content.dist}/MANIFEST" />
    <mkdir dir="${bdna.content.dist}/upgrade" />
</target>


<target name="dist_bcp_HardwareEnergy" depends="init, generate_bcp_HardwareEnergy, prep_dist_bcp_HardwareEnergy, ui_engine_library">

    <copy file="${bdna.seq}/com/bdna/app/widget/WidgetLibrary.xml" todir="${bdna.content.dist}/appframe/com/bdna/modules/appmeta" />
    <copy file="${bdna.seq}/com/bdna/app/uiengine/HTMLEngineWidgetLibrary.xml" todir="${bdna.content.dist}/appframe/com/bdna/modules/appmeta" />
    <copy file="${bdna.seq}/com/bdna/app/uiengine/SwingEngineWidgetLibrary.xml" todir="${bdna.content.dist}/appframe/com/bdna/modules/appmeta" />

    <copy file="${bdna.seq}/content/manifests/HardwareEnergyManifest.xml" todir="${bdna.content.dist}/MANIFEST" />

    <copy file="${bdna.seq}/content/upgrade/upgrade.xml" tofile="${bdna.content.dist}/upgrade/upgrade.xml" />
    <copy file="${bdna.seq}/content/upgrade/upgrade.sh" tofile="${bdna.content.dist}/upgrade/upgrade.sh" />
    <copy file="${bdna.seq}/content/upgrade/pubTablesCleanup.sql" tofile="${bdna.content.dist}/upgrade/pubTablesCleanup.sql" />
    <copy file="${bdna.seq}/content/upgrade/removeMD_dups.sql" tofile="${bdna.content.dist}/upgrade/removeMD_dups.sql" />
    <copy file="${bdna.seq}/content/upgrade/upgradeContentReports.xml" tofile="${bdna.content.dist}/upgrade/upgradeContentReports.xml" />

    <replace file="${bdna.content.dist}/MANIFEST/HardwareEnergyManifest.xml" value="${bdna.bcp.version}">
        <replacefilter token="@bdna.bcp.version@"/>
    </replace>

    <replace file="${bdna.content.dist}/upgrade/upgrade.sh" value="${bdna.bcp.version}">
        <replacefilter token="@bdna.bcp.version@"/>
    </replace>
    <replace file="${bdna.content.dist}/upgrade/upgrade.sh" value="${bcp.build.number}">
        <replacefilter token="@bcp.build.number@"/>
    </replace>

<!--

<replace file="${bdna.seq}/content/manifests/BaselineManifest.xml">
  <replacetoken>contentBuildVersion="1"</replacetoken>
  <replacevalue>contentBuildVersion="${bcp.build.number}"</replacevalue>
</replace>

-->


    <copy todir="${bdna.content.dist}/appdata">
        <fileset dir="${bdna.content.build}/appdata">
            <include name="**" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.dist}/appframe">
        <fileset dir="${bdna.content.build}/appframe">
            <include name="**" />
        </fileset>
    </copy>

<fileset id="HardwareEnergy_modules" dir="${bdna.content.build}/modules">
            <include name="com/bdna/modules/app/CleanupBDNATrace.xml" />
            <include name="com/bdna/modules/app/PotentialWindows.xml" />
            <include name="com/bdna/modules/app/procCleanup.xml" />
            <include name="com/bdna/modules/app/CPAWindows.xml" />
            <include name="com/bdna/modules/app/CPAUNIX.xml" />
            <include name="com/bdna/modules/app/CPACommon.xml" />
            <include name="com/bdna/modules/common/Discovery.xml" />
            <include name="com/bdna/modules/common/DisableUNIXProcessDepList.xml" />
            <include name="com/bdna/modules/common/SNMP.xml" />
            <include name="com/bdna/modules/common/ILOM.xml" />
            <include name="com/bdna/modules/os/AIX.xml" />
            <include name="com/bdna/modules/os/HPUX.xml" />
            <include name="com/bdna/modules/os/IRIX.xml" />
            <include name="com/bdna/modules/os/Linux.xml" />
            <include name="com/bdna/modules/os/Solaris.xml" />
            <include name="com/bdna/modules/os/Tru64.xml" />
            <include name="com/bdna/modules/os/UNIX.xml" />
            <include name="com/bdna/modules/os/Windows.xml" />
            <include name="**/*.properties" />
            <include name="com/bdna/presentationModules/app/PotentialWindows.xml" />
            <include name="com/bdna/presentationModules/common/*" />
            <include name="com/bdna/presentationModules/hardware/PrinterDiscovery.xml" />
            <include name="com/bdna/presentationModules/os/AIX.xml" />
            <include name="com/bdna/presentationModules/os/Embedded.xml" />
            <include name="com/bdna/presentationModules/os/HPUX.xml" />
            <include name="com/bdna/presentationModules/os/IBMzOS.xml" />
            <include name="com/bdna/presentationModules/os/J2ME.xml" />
            <include name="com/bdna/presentationModules/os/Linux.xml" />
            <include name="com/bdna/presentationModules/os/MacOS.xml" />
            <include name="com/bdna/presentationModules/os/Netware.xml" />
            <include name="com/bdna/presentationModules/os/OracleVMServer.xml" />
            <include name="com/bdna/presentationModules/os/UNIX.xml" />
            <include name="com/bdna/presentationModules/os/VNwareESXServer.xml" />            
            <include name="com/bdna/presentationModules/os/Windows.xml" />
            <include name="com/bdna/presentationModules/os/WindowsL2.xml" />
            <include name="com/bdna/presentationModules/os/XenServer.xml" />
</fileset>



    <delete file="${bdna.content.dist}/modules/com/bdna/bdna_content.bar"/>
    <jar
        jarfile="${bdna.content.dist}/modules/com/bdna/bdna_content.bar"
        >
        <fileset refid="HardwareEnergy_modules"/>

        <manifest>
            <attribute name="Built-By" value="${user.name}"/>
            <section name="common">
              <attribute name="BDNA_CONTENT_PACK_NAME" value="${bdna.BCP.HardwareEnergy.label}"/>
              <attribute name="BDNA_CONTENT_BUILD_DATE" value="${bdna.content.build.stamp}"/>
              <attribute name="BDNA_CONTENT_VERSION_NUMBER" value="${bdna.BCP.HardwareEnergy.version}"/>
              <attribute name="BDNA_CONTENT_BUILD_NUMBER" value="${bcp.build.number}"/>
            </section>
            <section name="common/class1.class">
              <attribute name="Sealed" value="false"/>
            </section>
        </manifest>
    </jar>

</target>


<target name="content_installkit_bcp_HardwareEnergy" depends="dist_bcp_HardwareEnergy">
    <delete file="${bdna.nightly_builds.this_build}/HardwareEnergy_${bdna.BCP.HardwareEnergy.version}_${bcp.build.number}.seq"/>
    <delete file="${bdna.nightly_builds}/HardwareEnergy_latest.seq"/>

    <jar
        destfile="${bdna.nightly_builds.this_build}/HardwareEnergy_${bdna.BCP.HardwareEnergy.version}_${bcp.build.number}.seq"
        basedir="${bdna.content.dist}" >
    </jar>
    <copy file="${bdna.nightly_builds.this_build}/HardwareEnergy_${bdna.BCP.HardwareEnergy.version}_${bcp.build.number}.seq" tofile="${bdna.nightly_builds}/HardwareEnergy_latest.seq" />
</target>



<target name="prep_build_bcp_EnterpriseSequence">
    <delete dir="${bdna.content.build}" />
    <mkdir dir="${bdna.content.build}/modules" />
    <mkdir dir="${bdna.content.build}/presentation" />
    <mkdir dir="${bdna.content.build}/com/bdna/junit" />
    <mkdir dir="${bdna.content.build}/nih" />
    <mkdir dir="${bdna.content.build}/scripts" />
    <mkdir dir="${bdna.content.build}/appframe" />
    <mkdir dir="${bdna.content.build}/appdata" />
    <mkdir dir="${bdna.content.build}/java" />
    <mkdir dir="${bdna.content.build}/pl/web/client/classes" />
    <mkdir dir="${bdna.content.build}/conf" />
</target>


<!--                                                        -->
<!--            Generate the fingerprint modules            -->
<!--                                                        -->
<target name="generate_bcp_EnterpriseSequence" depends="prep_build_bcp_EnterpriseSequence">

    <!-- Include Baseline pack in Enterprise -->
    <generate-bcp-Baseline />

    <java
        classname="com.bdna.fingerprintTool.GenJiffyFP"
        classpathref="javac.classpath"
        failonerror="true"
        dir="${bdna.seq}/com/bdna/fingerprintTool/templates/jiffy"
        fork="yes" >
        <sysproperty key="bdna.home" value="${bdna.seq}"/>
        <sysproperty key="bdna.jiffy.noperlcheck" value="${bdna.jiffy.noperlcheck}" />
        <arg value="${bdna.seq}/com/bdna/fingerprintTool" />
        <arg value="${bdna.content.build}/modules" />
    </java>


    <!-- move the bdna modules, overwrite the generated version if any -->
    <copy todir="${bdna.content.build}/modules/">
        <fileset dir="${bdna.seq}/modules">
            <include name="com/bdna/modules/app/**" />
            <exclude name="com/bdna/modules/app/ActiveDirectory.xml" />
            <exclude name="com/bdna/modules/app/NetworkServices.xml" />
            <include name="com/bdna/modules/common/ADMTypesAndAttrsDef.xml" />
            <include name="com/bdna/modules/common/DiscoveryInstallExtensions.xml" />
            <include name="com/bdna/modules/common/Discovery.xml" />
            <include name="com/bdna/modules/common/DisableUNIXProcessDepList.xml" />
            <include name="com/bdna/modules/common/SNMP.xml" />
            <include name="com/bdna/modules/common/ILOM.xml" />
            <include name="com/bdna/modules/common/QueryBasedTypes.xml" />
            <include name="com/bdna/modules/database/**" />
            <include name="com/bdna/modules/hardware/APCUPSDiscovery.xml" />
            <include name="com/bdna/modules/hardware/ArubaAPDiscovery.xml" />
            <include name="com/bdna/modules/hardware/AvayaPhoneDiscovery.xml" />
            <include name="com/bdna/modules/hardware/BrocadeFabricSwitchDiscovery.xml" />
            <include name="com/bdna/modules/hardware/CiscoFabricSwitchDiscovery.xml" />
            <include name="com/bdna/modules/hardware/EMCFabricSwitchDiscovery.xml" />
            <include name="com/bdna/modules/hardware/HPFabricSwitchDiscovery.xml" />
            <include name="com/bdna/modules/hardware/IBMFabricSwitchDiscovery.xml" />
            <include name="com/bdna/modules/hardware/McDATAFabricSwitchDiscovery.xml" />
            <include name="com/bdna/modules/hardware/NetAppFilerDiscovery.xml" />
            <include name="com/bdna/modules/hardware/SunStorageDeviceDiscovery.xml" />
            <include name="com/bdna/modules/hardware/SMISL2.xml" />
            <include name="com/bdna/modules/hardware/ILOM.xml" />
            <include name="com/bdna/modules/hardware/ELOM.xml" />
            <include name="com/bdna/modules/network/3ComSwitchDiscovery.xml" />
            <include name="com/bdna/modules/network/CiscoRouterDiscovery.xml" />
            <include name="com/bdna/modules/network/CiscoSwitchDiscovery.xml" />
            <include name="com/bdna/modules/network/EnterasysSwitchDiscovery.xml" />
            <include name="com/bdna/modules/network/HPSwitchDiscovery.xml" />
            <include name="com/bdna/modules/os/AIX.xml" />
            <include name="com/bdna/modules/os/HPUX.xml" />
            <include name="com/bdna/modules/os/IRIX.xml" />
            <include name="com/bdna/modules/os/Linux.xml" />
            <include name="com/bdna/modules/os/MacOS.xml" />
            <include name="com/bdna/modules/os/Netware.xml" />
            <include name="com/bdna/modules/os/OracleVMServer.xml" />
            <include name="com/bdna/modules/os/Solaris.xml" />
            <include name="com/bdna/modules/os/Tru64.xml" />
            <include name="com/bdna/modules/os/UNIX.xml" />
            <include name="com/bdna/modules/os/VMwareESXServer.xml" />
            <include name="com/bdna/modules/os/Windows.xml" />
            <include name="com/bdna/modules/os/XenServer.xml" />
            <include name="com/bdna/modules/metadata/FullContentFlags.xml" />
        </fileset>
    </copy>


    <copy todir="${bdna.content.build}/modules/com/bdna/presentationModules">
        <fileset dir="${bdna.seq}/modules/com/bdna/presentationModules">
            <include name="app/**" />
            <include name="database/**" />
            <include name="network/**" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.build}/modules/com/bdna/presentationModules">
        <fileset dir="${bdna.seq}/modules/com/bdna/presentationModules">
            <include name="common/*" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.build}/modules/com/bdna/presentationModules">
        <fileset dir="${bdna.seq}/modules/com/bdna/presentationModules">
            <include name="hardware/ArubaAPDiscovery.xml" />
            <include name="hardware/PrinterDiscovery.xml" />
            <include name="hardware/NetAppFilerDiscovery.xml" />
            <include name="hardware/SMISL2.xml" />
            <include name="hardware/ILOM.xml" />
            <include name="hardware/ELOM.xml" />
            <include name="os/ALOM.xml" /> 
       </fileset>
    </copy>

    <copy todir="${bdna.content.build}/modules/com/bdna/presentationModules">
        <fileset dir="${bdna.seq}/modules/com/bdna/presentationModules">
            <include name="os/AIX.xml" />
            <include name="os/Embedded.xml" />
            <include name="os/HPUX.xml" />
            <include name="os/IBMzOS.xml" />
            <include name="os/J2ME.xml" />
            <include name="os/Linux.xml" />
            <include name="os/MacOS.xml" />
            <include name="os/Netware.xml" />
            <include name="os/OracleVMServer.xml" />
            <include name="os/UNIX.xml" />
            <include name="os/VNwareESXServer.xml" />            
            <include name="os/Windows.xml" />
            <include name="os/WindowsL2.xml" />
            <include name="os/XenServer.xml" />
        </fileset>
    </copy>


    <!-- copy the built-in application modules -->
    <copy todir="${bdna.content.build}/appframe/com/bdna/modules/appmeta">
        <fileset dir="${bdna.seq}/com/bdna/app/application">
            <include name="ADMMatch.xml" />
            <include name="AppConsole.xml" />
            <!-- <include name="BlackBerry.xml" /> -->
            <include name="Folders.xml" />
            <include name="ApplicationServers.xml" />
            <!-- <include name="CitrixApplications.xml" /> -->
            <include name="CMDB.xml" />
            <include name="CredentialUsage.xml" />
            <include name="Databases.xml" />
            <include name="DB2Databases.xml" />
            <include name="DeprecatedInventory.xml" />
            <include name="ERIDeprecated.xml" /> 
            <include name="FlexLMLicenseServer.xml" />
            <include name="Guardium_Modules.xml" />
            <include name="HPVirtualization.xml" />
            <include name="IBMApplications.xml" />
            <include name="IBMVirtualization.xml" />
            <include name="InformixDatabases.xml" />
            <include name="InventoryApplication.xml" />
            <!-- <include name="JBoss.xml" /> -->
            <!-- <include name="LinkingRulesVirtualization.xml" /> -->
            <include name="LinkingRules.xml" />
            <!-- <include name="LinkingVirtualization.xml" /> -->
            <include name="Linking.xml" />
            <include name="MarketData_SupportViews.xml" />
            <include name="MarketData.xml" />
            <include name="Misc.xml" />
            <!-- <include name="MiscApplications.xml" /> -->
            <include name="MSSQLDatabases.xml" />
            <include name="MSVSVirtualization.xml" />
            <include name="NetworkEquipment.xml" />
            <!-- <include name="ObsoleteReportFolderPlacements.xml" /> -->
            <!-- <include name="OracleApplications.xml" /> -->
            <include name="OracleDatabases.xml" />
            <include name="OracleCommon.xml" />
            <include name="OracleLMS.xml" />
            <include name="OracleLMSPack.xml" />
            <include name="OracleVMVirtualization.xml" />
            <include name="PublisherADM.xml" />
            <include name="PublisherApache.xml" />
            <include name="PublisherDatabase.xml" />
            <include name="PublisherIBM.xml" />
            <include name="PublisherMisc.xml" />
            <include name="PublisherNIC.xml" />
            <include name="PublisherOracle.xml" />
            <!-- <include name="PublisherVirtualization.xml" /> -->
            <include name="PublisherWebServers.xml" />
            <include name="PublisherWin.xml" />
            <include name="PublisherUNIX.xml" />
            <include name="SAPApplications.xml" />
            <include name="ScanSummary.xml" />
            <include name="SoftwareUsage.xml" />
            <include name="StandardApplication.xml" />
            <include name="SunVirtualization.xml" />
            <!-- <include name="SymantecApplications.xml" /> -->
            <!-- <include name="SynopsysApplications.xml" /> -->
            <!-- <include name="Tomcat.xml" /> -->
            <include name="VideoConferencingEquipment.xml" />
            <include name="VirtualizationSummary.xml" />
            <include name="Virtualization.xml" />
            <!-- <include name="VMwareVirtualization.xml" /> -->
            <include name="WebLogic.xml" />
            <include name="WebServers.xml" />
            <include name="WebSphere.xml" />
            <include name="WebSphereMQ.xml" />
            <include name="WinFileScan.xml" />
            <!-- <include name="XenVirtualization.xml" /> -->
        </fileset>
    </copy>

<!--
    <copy todir="${bdna.content.build}/appdata">
        <fileset dir="${bdna.seq}/com/bdna/app/data">
            <include name="marketData-NextGen.xml" />
        </fileset>
    </copy>
-->

     <unzip src="${bdna.seq}/com/bdna/app/data/marketData-NextGen.zip" dest="${bdna.content.build}/appdata/" />

     <!-- Insert Windows scripts into XML modules -->
     <java
         classname="com.bdna.fingerprintTool.ModulesTransformer"
         classpathref="javac.classpath"
         failonerror="true"
         dir="${bdna.seq}/modules"
         fork="yes" >
         <sysproperty key="bdna.home" value="${bdna.seq}"/>
         <arg value="${bdna.seq}" />
         <arg value="${bdna.content.build}" />
     </java>


    <copy todir="${bdna.content.build}/presentation">
        <fileset dir="${bdna.src}/presentation">
            <include name="**/*.xml" />
            <include name="**/*.properties" />
        </fileset>
    </copy>

</target>


<!--                                                        -->
<!--            Prepare the distribution directories        -->
<!--                                                        -->
<target name="prep_dist_bcp_EnterpriseSequence">
    <delete dir="${bdna.content.dist}" />
    <mkdir dir="${bdna.content.dist}/modules" />
    <mkdir dir="${bdna.content.dist}/modules/com" />
    <mkdir dir="${bdna.content.dist}/modules/com/bdna" />
    <mkdir dir="${bdna.content.dist}/scripts" />
    <mkdir dir="${bdna.content.dist}/nih" />
    <mkdir dir="${bdna.content.dist}/pso" />
    <mkdir dir="${bdna.content.dist}/pso/CDB" />
    <mkdir dir="${bdna.content.dist}/appdata" />
    <mkdir dir="${bdna.content.dist}/java" />
    <mkdir dir="${bdna.content.dist}/appframe" />
    <mkdir dir="${bdna.content.dist}/MANIFEST" />
    <mkdir dir="${bdna.content.dist}/pre_upgrade" />
    <mkdir dir="${bdna.content.dist}/upgrade" />
    <mkdir dir="${bdna.content.dist}/content/cmdb/BDNAERI" />
    <mkdir dir="${bdna.content.dist}/classes" />
    <mkdir dir="${bdna.content.dist}/debug" />
    <mkdir dir="${bdna.content.dist}/debug/classes" />
    <mkdir dir="${bdna.content.dist}/java" />
    <mkdir dir="${bdna.content.build}/pl/web/client/classes" />
    <mkdir dir="${bdna.content.dist}/conf" />
</target>

<target name="dist_bcp_EnterpriseSequence" depends="init,generate_bcp_EnterpriseSequence,prep_dist_bcp_EnterpriseSequence, content_java">
    <copy file="${bdna.seq}/pl/web/client/classes/VersionCheck.jar" todir="${bdna.content.dist}/pl/web/client/classes" />
    <copy file="${bdna.seq}/pl/web/client/manifestAttr" todir="${bdna.content.dist}/pl/web/client" />
    <copy file="${bdna.seq}/scripts/OracleLMS/createLMS3PTV_Tables.sql" todir="${bdna.content.dist}/bin" />
    <copy file="${bdna.seq}/scripts/OracleLMS/overview.sql" todir="${bdna.content.dist}/bin" />
    <copy file="${bdna.seq}/scripts/OracleLMS/ExtractLMS3PTVOutput.sh" todir="${bdna.content.dist}/bin" />
    <copy file="${bdna.seq}/scripts/OracleLMS/install_oracle_lms_license.sh" todir="${bdna.content.dist}/bin" />
    <copy file="${bdna.seq}/scripts/Administrator/Oracle/Create_Credential_NoOracleLMS.sql" todir="${bdna.content.dist}/scripts/Administrator/Oracle" />
    <copy file="${bdna.seq}/scripts/Administrator/Oracle/Create_Credential_YesOracleLMS.sql" todir="${bdna.content.dist}/scripts/Administrator/Oracle" />
    <copy file="${bdna.seq}/scripts/Administrator/Oracle/README-Instructions.txt" todir="${bdna.content.dist}/scripts/Administrator/Oracle" />
    <copy file="${bdna.seq}/scripts/Administrator/Oracle/Helper_YesOracleLMS_Oracle9i.sql_lib" todir="${bdna.content.dist}/scripts/Administrator/Oracle" />
    <copy file="${bdna.seq}/scripts/Administrator/Oracle/Helper_YesOracleLMS_Oracle10g.sql_lib" todir="${bdna.content.dist}/scripts/Administrator/Oracle" />
    <copy file="${bdna.seq}/scripts/Administrator/Oracle/Helper_YesOracleLMS_Oracle11g.sql_lib" todir="${bdna.content.dist}/scripts/Administrator/Oracle" />

    <copy file="${bdna.seq}/com/bdna/app/widget/WidgetLibrary.xml" todir="${bdna.content.dist}/appframe/com/bdna/modules/appmeta" />
    <copy file="${bdna.seq}/com/bdna/app/uiengine/HTMLEngineWidgetLibrary.xml" todir="${bdna.content.dist}/appframe/com/bdna/modules/appmeta" />
    <copy file="${bdna.seq}/com/bdna/app/uiengine/SwingEngineWidgetLibrary.xml" todir="${bdna.content.dist}/appframe/com/bdna/modules/appmeta" />
    <copy file="${bdna.seq}/com/bdna/app/metadata/eri/ERI_ColExclusionList.txt" todir="${bdna.content.dist}/content/cmdb/BDNAERI" />

    <copy file="${bdna.seq}/content/manifests/EnterpriseSequenceManifest.xml" todir="${bdna.content.dist}/MANIFEST" />
    <copy file="${bdna.seq}/content/manifests/OracleLicensingManifest.xml" todir="${bdna.content.dist}/bin" />

    <copy file="${bdna.seq}/content/pre_upgrade/pre_upgrade.sh" tofile="${bdna.content.dist}/pre_upgrade/pre_upgrade.sh" />
    <copy file="${bdna.seq}/content/pre_upgrade/cleanMarketData.sql" tofile="${bdna.content.dist}/pre_upgrade/cleanMarketData.sql" />
    <copy file="${bdna.seq}/content/upgrade/upgrade.xml" tofile="${bdna.content.dist}/upgrade/upgrade.xml" />
    <copy file="${bdna.seq}/content/upgrade/EnterpriseSequenceUpgrade.sh" tofile="${bdna.content.dist}/upgrade/upgrade.sh" />
    <copy file="${bdna.seq}/content/upgrade/pubTablesCleanup.sql" tofile="${bdna.content.dist}/upgrade/pubTablesCleanup.sql" />
    <copy file="${bdna.seq}/content/upgrade/removeMD_dups.sql" tofile="${bdna.content.dist}/upgrade/removeMD_dups.sql" />
    <copy file="${bdna.seq}/content/upgrade/publisher_flag_fix.sql" tofile="${bdna.content.dist}/upgrade/publisher_flag_fix.sql" />
    <copy file="${bdna.seq}/content/upgrade/restoreAttributes.sql" tofile="${bdna.content.dist}/upgrade/restoreAttributes.sql" />
    <copy file="${bdna.seq}/content/upgrade/metadataCleanup.sql" tofile="${bdna.content.dist}/upgrade/metadataCleanup.sql" />
    <copy file="${bdna.seq}/content/upgrade/upgradeContentReports.xml" tofile="${bdna.content.dist}/upgrade/upgradeContentReports.xml" />
    <copy file="${bdna.seq}/content/upgrade/sshconnect.pl" tofile="${bdna.content.dist}/upgrade/sshconnect.pl" />

    <copy file="${bdna.seq}/pso/dist/scan/modules/EnableSudoScan.xml" tofile="${bdna.content.dist}/pso/scan/modules/EnableSudoScan.xml" />
    <copy file="${bdna.seq}/pso/dist/scan/modules/EnableSeSudoScan.xml" tofile="${bdna.content.dist}/pso/scan/modules/EnableSeSudoScan.xml" />
    <copy file="${bdna.seq}/pso/dist/scan/modules/EnableUNIXProcessDepList.xml" tofile="${bdna.content.dist}/pso/scan/modules/EnableUNIXProcessDepList.xml" />
    <copy file="${bdna.seq}/pso/dist/scan/modules/DisableUNIXProcessDepList.xml" tofile="${bdna.content.dist}/pso/scan/modules/DisableUNIXProcessDepList.xml" />


    <replace file="${bdna.content.dist}/MANIFEST/EnterpriseSequenceManifest.xml" value="${bdna.bcp.version}">
        <replacefilter token="@bdna.bcp.version@"/>
    </replace>

    <replace file="${bdna.content.dist}/upgrade/upgrade.sh" value="${bdna.bcp.version}">
        <replacefilter token="@bdna.bcp.version@"/>
    </replace>
    <replace file="${bdna.content.dist}/upgrade/upgrade.sh" value="${bcp.build.number}">
        <replacefilter token="@bcp.build.number@"/>
    </replace>

    <copy todir="${bdna.content.dist}/nih">
        <fileset dir="${bdna.content.build}/nih">
            <include name="**" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.dist}/pso/CDB">
        <fileset dir="${bdna.seq}/pso/CDB">
            <include name="DataExtract.sh" />
            <include name="extract.sql" />
            <include name="cpu_extract.sql" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.dist}/scripts">
        <fileset dir="${bdna.content.build}/scripts">
            <include name="**" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.dist}/appdata">
        <fileset dir="${bdna.content.build}/appdata">
            <include name="**" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.dist}/appframe">
        <fileset dir="${bdna.content.build}/appframe">
            <include name="**" />
        </fileset>
    </copy>

    <!-- Updated startagent with Nmap 5.51 binaries -->
    <copy file="${bdna.src}/ShellScripts/Linux/startagent.sh" todir="${bdna.content.dist}/bin" />
    <copy file="${bdna.src}/ShellScripts/Linux/chk_valid_os.pl" todir="${bdna.content.dist}/bin" />

    <copy todir="${bdna.content.dist}/conf">
        <fileset dir="${bdna.seq}/content/udtTemplate">
            <include name="EnterpriseSequenceUdt.tpl" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.dist}/conf">
        <fileset dir="${bdna.content.build}/conf">
            <include name="MessagesBundle.properties" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.dist}/conf">
        <fileset dir="${bdna.seq}/conf">
            <include name=".bdnauikeystore" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.dist}/java/sources/com/bdna/si/udt">
        <fileset dir="${bdna.seq}/com/bdna/si/udt">
            <include name="*.java" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.dist}/java/classes/com/bdna/si/udt">
        <fileset dir="${bdna.build}/classes/com/bdna/si/udt">
            <include name="**" />
        </fileset>
    </copy>

    <!-- move the new Java classes -->
    <copy todir="${bdna.content.dist}/classes">
        <fileset dir="${bdna.seq}/java/classes">
            <include name="com/bdna/xsi/commands/CommandRunXform.class" />
            <include name="com/bdna/app/metadata/xsi/Project.class" />
            <include name="com/bdna/app/metadata/TableDef.class" />
            <include name="com/bdna/agenda/BulkCommon*.class" />
            <include name="com/bdna/agenda/BulkTask4.class" />
            <include name="com/bdna/agenda/BulkTask4$$*.class" />
            <include name="com/bdna/app/widget/JDataAdmin.class" />
            <include name="com/bdna/app/widget/JDataAdmin$$*.class" />
            <include name="com/bdna/app/widget/JMetadataStore2*.class" />
            <include name="com/bdna/app/widget/JNavigation*.class" />
            <include name="com/bdna/app/widget/JNavigation$$*.class" />
            <include name="com/bdna/app/widget/JRoleEditor.class" />
            <include name="com/bdna/app/widget/JRoleEditor$$*.class" />
            <include name="com/bdna/app/widget/JScanTaskEditor*.class" />
            <include name="com/bdna/app/widget/WidgetNavigationCache.class" />
            <include name="com/bdna/app/db/AttributeInfoCache.class" />
            <include name="com/bdna/app/metadata/ScanQuery.class" />
            <include name="com/bdna/app/metadata/ScanQuery$$*.class" />
            <include name="com/bdna/app/metadata/ScanTask*.class" />
            <include name="com/bdna/bvl/dw/GlobalScan.class" />
            <include name="com/bdna/bvl/dw/GlobalScan$$*.class" />
            <include name="com/bdna/app/uiengine/SwingAppClient.class" />
            <include name="com/bdna/app/uiengine/SwingAppClient$$*.class" />
            <include name="com/bdna/bvl/dw/CumulativeScanBuilder.class" />
            <include name="com/bdna/bvl/dw/CumulativeScanBuilder$$*.class" />
            <include name="com/bdna/bvl/dw/ViewBuilder.class" />
            <include name="com/bdna/si/common/AutoConnection.class" />
            <include name="com/bdna/si/common/AutoConnection$$*.class" />
            <include name="com/bdna/si/db/ScanAdminUtility*.class" />
            <include name="com/bdna/si/metadata/ElementFactory.class" />
            <include name="com/bdna/si/metadata/ElementFactory$$*.class" />
            <include name="com/bdna/si/metadata/PackageFactory.class" />
            <include name="com/bdna/si/metadata/PackageFactory$$*.class" />
            <include name="com/bdna/si/udt/UDTUtil.class" />
            <include name="com/bdna/si/udt/GuardiumModulesUDT.class" />
            <include name="com/bdna/si/udt/IBMDB2FeaturesUDT.class" />
            <include name="com/bdna/si/udt/IBMDB2LicmListUDT.class" />
            <include name="com/bdna/ut/cla/claMessages/ResultCodes.class" />
            <include name="com/bdna/ut/xmlsax/BaseHandler.class" />
            <include name="com/bdna/ut/xmlsax/BaseHandler$$*.class" />
            <include name="com/bdna/app/metadata/eri/ERIGenerator.class" />
            <include name="com/bdna/app/metadata/eri/ERIGenerator$$*.class" />
            <include name="com/bdna/si/ac/User.class" />
            <include name="com/bdna/si/ac/User$$*.class" />
            <include name="com/bdna/java/JavaAction.class" />
            <include name="com/bdna/java/JavaAction$$*.class" />
            <include name="com/bdna/jiffy/j4/Operator.class" />
            <include name="com/bdna/jiffy/j4/Operator$$*.class" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.dist}/debug/classes">
        <fileset dir="${bdna.seq}/java/debug/classes">
            <include name="com/bdna/xsi/commands/CommandRunXform.class" />
            <include name="com/bdna/app/metadata/xsi/Project.class" />
            <include name="com/bdna/app/metadata/TableDef.class" />
            <include name="com/bdna/agenda/BulkCommon*.class" />
            <include name="com/bdna/agenda/BulkTask4.class" />
            <include name="com/bdna/agenda/BulkTask4$$*.class" />
            <include name="com/bdna/app/widget/JDataAdmin.class" />
            <include name="com/bdna/app/widget/JDataAdmin$$*.class" />
            <include name="com/bdna/app/widget/JMetadataStore2*.class" />
            <include name="com/bdna/app/widget/JNavigation*.class" />
            <include name="com/bdna/app/widget/JNavigation$$*.class" />
            <include name="com/bdna/app/widget/JRoleEditor.class" />
            <include name="com/bdna/app/widget/JRoleEditor$$*.class" />
            <include name="com/bdna/app/widget/JScanTaskEditor*.class" />
            <include name="com/bdna/app/widget/WidgetNavigationCache.class" />
            <include name="com/bdna/app/metadata/ScanQuery.class" />
            <include name="com/bdna/app/metadata/ScanQuery$$*.class" />
            <include name="com/bdna/app/uiengine/SwingAppClient.class" />
            <include name="com/bdna/app/uiengine/SwingAppClient$$*.class" />
            <include name="com/bdna/app/metadata/ScanTask*.class" />
            <include name="com/bdna/app/db/AttributeInfoCache.class" />
            <include name="com/bdna/bvl/dw/GlobalScan.class" />
            <include name="com/bdna/bvl/dw/GlobalScan$$*.class" />
            <include name="com/bdna/bvl/dw/CumulativeScanBuilder.class" />
            <include name="com/bdna/bvl/dw/CumulativeScanBuilder$$*.class" />
            <include name="com/bdna/bvl/dw/ViewBuilder.class" />
            <include name="com/bdna/si/common/AutoConnection.class" />
            <include name="com/bdna/si/common/AutoConnection$$*.class" />
            <include name="com/bdna/si/db/ScanAdminUtility*.class" />
            <include name="com/bdna/si/metadata/ElementFactory.class" />
            <include name="com/bdna/si/metadata/ElementFactory$$*.class" />
            <include name="com/bdna/si/metadata/PackageFactory.class" />
            <include name="com/bdna/si/metadata/PackageFactory$$*.class" />
            <include name="com/bdna/si/udt/UDTUtil.class" />
            <include name="com/bdna/ut/cla/claMessages/ResultCodes.class" />
            <include name="com/bdna/ut/xmlsax/BaseHandler.class" />
            <include name="com/bdna/ut/xmlsax/BaseHandler$$*.class" />
            <include name="com/bdna/app/metadata/eri/ERIGenerator.class" />
            <include name="com/bdna/app/metadata/eri/ERIGenerator$$*.class" />
            <include name="com/bdna/si/ac/User.class" />
            <include name="com/bdna/si/ac/User$$*.class" />
            <include name="com/bdna/java/JavaAction.class" />
            <include name="com/bdna/java/JavaAction$$*.class" />
            <include name="com/bdna/jiffy/j4/Operator.class" />
            <include name="com/bdna/jiffy/j4/Operator$$*.class" />
        </fileset>
    </copy>

<!-- Just going to grab everything in /modules
<fileset id="EnterpriseSequence_modules" dir="${bdna.content.build}/modules">
            <include name="com/bdna/modules/app/**" />
            <exclude name="com/bdna/modules/app/ActiveDirectory.xml" />
            <exclude name="com/bdna/modules/app/NetworkServices.xml" />
            <include name="com/bdna/modules/common/ADMTypesAndAttrsDef.xml" />
            <include name="com/bdna/modules/common/DiscoveryInstallExtensions.xml" />
            <include name="com/bdna/modules/common/Discovery.xml" />
            <include name="com/bdna/modules/common/SNMP.xml" />
            <include name="com/bdna/modules/common/QueryBasedTypes.xml" />
            <include name="com/bdna/modules/database/**" />
            <include name="com/bdna/modules/hardware/APCUPSDiscovery.xml" />
            <include name="com/bdna/modules/hardware/BrocadeFabricSwitchDiscovery.xml" />
            <include name="com/bdna/modules/hardware/CiscoFabricSwitchDiscovery.xml" />
            <include name="com/bdna/modules/hardware/EMCFabricSwitchDiscovery.xml" />
            <include name="com/bdna/modules/hardware/HPFabricSwitchDiscovery.xml" />
            <include name="com/bdna/modules/hardware/IBMFabricSwitchDiscovery.xml" />
            <include name="com/bdna/modules/hardware/McDATAFabricSwitchDiscovery.xml" />
            <include name="com/bdna/modules/hardware/NetAppFilerDiscovery.xml" />
            <include name="com/bdna/modules/network/CiscoRouterDiscovery.xml" />
            <include name="com/bdna/modules/network/CiscoSwitchDiscovery.xml" />
            <include name="com/bdna/modules/network/HPSwitchDiscovery.xml" />
            <include name="com/bdna/modules/os/AIX.xml" />
            <include name="com/bdna/modules/os/HPUX.xml" />
            <include name="com/bdna/modules/os/IRIX.xml" />
            <include name="com/bdna/modules/os/Linux.xml" />
            <include name="com/bdna/modules/os/MacOS.xml" />
            <include name="com/bdna/modules/os/Netware.xml" />
            <include name="com/bdna/modules/os/OracleVMServer.xml" />
            <include name="com/bdna/modules/os/Solaris.xml" />
            <include name="com/bdna/modules/os/Tru64.xml" />
            <include name="com/bdna/modules/os/UNIX.xml" />
            <include name="com/bdna/modules/os/VMwareESXServer.xml" />
            <include name="com/bdna/modules/os/Windows.xml" />
            <include name="com/bdna/modules/os/XenServer.xml" />
            <include name="com/bdna/modules/metadata/FullContentFlags.xml" />
            <include name="**/*.properties" />
            <include name="com/bdna/presentationModules/app/**" />
            <include name="com/bdna/presentationModules/common/*" />
            <include name="com/bdna/presentationModules/database/**" />
            <include name="com/bdna/presentationModules/hardware/PrinterDiscovery.xml" />
            <include name="com/bdna/presentationModules/hardware/NetAppFilerDiscovery.xml" />
            <include name="com/bdna/presentationModules/network/**" />
            <include name="com/bdna/presentationModules/os/AIX.xml" />
            <include name="com/bdna/presentationModules/os/Embedded.xml" />
            <include name="com/bdna/presentationModules/os/HPUX.xml" />
            <include name="com/bdna/presentationModules/os/IBMzOS.xml" />
            <include name="com/bdna/presentationModules/os/J2ME.xml" />
            <include name="com/bdna/presentationModules/os/Linux.xml" />
            <include name="com/bdna/presentationModules/os/MacOS.xml" />
            <include name="com/bdna/presentationModules/os/Netware.xml" />
            <include name="com/bdna/presentationModules/os/OracleVMServer.xml" />
            <include name="com/bdna/presentationModules/os/UNIX.xml" />
            <include name="com/bdna/presentationModules/os/VNwareESXServer.xml" />            
            <include name="com/bdna/presentationModules/os/Windows.xml" />
            <include name="com/bdna/presentationModules/os/WindowsL2.xml" />
            <include name="com/bdna/presentationModules/os/XenServer.xml" />
</fileset>
-->

    <!-- Update the contentExportTag element contents -->
    <replace file="${bdna.content.build}/modules/com/bdna/modules/common/DiscoveryBase.xml" value="${bdna.bcp.version}">
        <replacefilter token="@bdna.bcp.version@"/>
    </replace>
    <replace file="${bdna.content.build}/modules/com/bdna/modules/common/DiscoveryBase.xml" value="${bcp.build.number}">
        <replacefilter token="@bcp.build.number@"/>
    </replace>

    <delete file="${bdna.content.dist}/modules/com/bdna/bdna_content.bar"/>
    <jar
        jarfile="${bdna.content.dist}/modules/com/bdna/bdna_content.bar"
        basedir="${bdna.content.build}/modules" >
        <manifest>
            <attribute name="Built-By" value="${user.name}"/>
            <section name="common">
              <attribute name="BDNA_CONTENT_PACK_NAME" value="${bdna.BCP.EnterpriseSequence.label}"/>
              <attribute name="BDNA_CONTENT_BUILD_DATE" value="${bdna.content.build.stamp}"/>
              <attribute name="BDNA_CONTENT_VERSION_NUMBER" value="${bdna.BCP.EnterpriseSequence.version}"/>
              <attribute name="BDNA_CONTENT_BUILD_NUMBER" value="${bcp.build.number}"/>
            </section>
            <section name="common/class1.class">
              <attribute name="Sealed" value="false"/>
            </section>
        </manifest>
    </jar>

</target>



<target name="content_installkit_bcp_EnterpriseSequence" depends="dist_bcp_EnterpriseSequence">
    <delete file="${bdna.nightly_builds.this_build}/EnterpriseSequence_${bdna.BCP.EnterpriseSequence.version}_${bcp.build.number}.seq"/>
    <delete file="${bdna.nightly_builds}/EnterpriseSequence_latest.seq"/>

    <jar
        jarfile="${bdna.nightly_builds.this_build}/EnterpriseSequence_${bdna.BCP.EnterpriseSequence.version}_${bcp.build.number}.seq" 
        basedir="${bdna.content.dist}">
    </jar>
    <copy file="${bdna.nightly_builds.this_build}/EnterpriseSequence_${bdna.BCP.EnterpriseSequence.version}_${bcp.build.number}.seq" tofile="${bdna.nightly_builds}/EnterpriseSequence_latest.seq" />
    <copy file="${bdna.seq}/content/upgrade/upgrade_sequence.sh" todir="${bdna.nightly_builds.this_build}/" />
</target>


<!--                                                        -->
<!--            PS'Soft OEM sequence build                  -->
<!--                                                        -->

<target name="prep_build_bcp_PSSoftSequence">
    <delete dir="${bdna.content.build}" />
    <mkdir dir="${bdna.content.build}/modules" />
    <mkdir dir="${bdna.content.build}/presentation" />
    <mkdir dir="${bdna.content.build}/com/bdna/junit" />
    <mkdir dir="${bdna.content.build}/nih" />
    <mkdir dir="${bdna.content.build}/scripts" />
    <mkdir dir="${bdna.content.build}/appframe" />
    <mkdir dir="${bdna.content.build}/appdata" />
    <mkdir dir="${bdna.content.build}/java" />
</target>


<!--                                                        -->
<!--            Generate the fingerprint modules            -->
<!--                                                        -->

<target name="generate_bcp_PSSoftSequence" depends="prep_build_bcp_PSSoftSequence">

    <!-- Include Baseline pack in PSSoft -->
    <generate-bcp-Baseline />

    <java
        classname="com.bdna.fingerprintTool.GenJiffyFP"
        classpathref="javac.classpath"
        failonerror="true"
        dir="${bdna.seq}/com/bdna/fingerprintTool/templates/jiffy"
        fork="yes" >
        <sysproperty key="bdna.home" value="${bdna.seq}"/>
        <sysproperty key="bdna.jiffy.noperlcheck" value="${bdna.jiffy.noperlcheck}" />
        <arg value="${bdna.seq}/com/bdna/fingerprintTool" />
        <arg value="${bdna.content.build}/modules" />
    </java>


    <!-- move the bdna modules, overwrite the generated version if any -->
    <copy todir="${bdna.content.build}/modules/">
        <fileset dir="${bdna.seq}/modules">
            <include name="com/bdna/modules/app/**" />
            <exclude name="com/bdna/modules/app/ActiveDirectory.xml" />
            <exclude name="com/bdna/modules/app/CleanupBDNATrace.xml" />
            <exclude name="com/bdna/modules/app/CPAUNIX.xml" />
            <exclude name="com/bdna/modules/app/NetworkServices.xml" />
            <exclude name="com/bdna/modules/app/procCleanup.xml" />
            <exclude name="com/bdna/modules/app/Citrix/XenVirtualSystem.xml" />
            <exclude name="com/bdna/modules/app/OracleAppL3.xml" />
            <exclude name="com/bdna/modules/app/UNIXOracleApp.xml" />
            <exclude name="com/bdna/modules/app/SAPL3.xml" />
            <exclude name="com/bdna/modules/app/BEA/UNIXWebLogic.xml" />
            <exclude name="com/bdna/modules/app/IBM/UNIX_WebSphere_Application_Server.xml" />
            <exclude name="com/bdna/modules/app/Oracle/WindowsOracleAppServer.xml" />
            <exclude name="com/bdna/modules/app/Oracle/OracleVirtualSystem.xml" />
            <exclude name="com/bdna/modules/app/Oracle/Oracle_Clinical.xml" />
            <exclude name="com/bdna/modules/app/Oracle/UNIX_Oracle_Clinical.xml" />
            <exclude name="com/bdna/modules/app/ResearchInMotion/BlackBerry_Enterprise_Server.xml" />
            <exclude name="com/bdna/modules/app/WyseTechnology/WyseDeviceManager.xml" />

            <include name="com/bdna/modules/common/ADMTypesAndAttrsDef.xml" />
            <include name="com/bdna/modules/common/QueryBasedTypes.xml" />
            <include name="com/bdna/modules/common/SNMP.xml" />
            <include name="com/bdna/modules/common/ILOM.xml" />
            <include name="com/bdna/modules/database/MSSQLServer.xml" />
            <include name="com/bdna/modules/database/Oracle.xml" />
            <include name="com/bdna/modules/database/WindowsOracle.xml" />
            <!--
            <include name="com/bdna/modules/hardware/APCUPSDiscovery.xml" />
            <include name="com/bdna/modules/hardware/BrocadeFabricSwitchDiscovery.xml" />
            <include name="com/bdna/modules/hardware/CiscoFabricSwitchDiscovery.xml" />
            <include name="com/bdna/modules/hardware/EMCFabricSwitchDiscovery.xml" />
            <include name="com/bdna/modules/hardware/HPFabricSwitchDiscovery.xml" />
            <include name="com/bdna/modules/hardware/IBMFabricSwitchDiscovery.xml" />
            <include name="com/bdna/modules/hardware/McDATAFabricSwitchDiscovery.xml" />
            <include name="com/bdna/modules/hardware/NetAppFilerDiscovery.xml" />
            -->
            <include name="com/bdna/modules/network/CiscoRouterDiscovery.xml" />
            <include name="com/bdna/modules/network/CiscoSwitchDiscovery.xml" />
            <include name="com/bdna/modules/network/HPSwitchDiscovery.xml" />
            <!-- <include name="com/bdna/modules/os/Netware.xml" /> -->
            <include name="com/bdna/modules/os/Windows.xml" />
            <include name="com/bdna/modules/metadata/FullContentFlags.xml" />
        </fileset>
    </copy>

    <!-- delete unwanted modules generated by jiffy -->
    <delete file="${bdna.content.build}/modules/com/bdna/modules/database/WindowsDB2Installation.xml" />

    <copy todir="${bdna.content.build}/modules/com/bdna/presentationModules">
        <fileset dir="${bdna.seq}/modules/com/bdna/presentationModules">
            <include name="app/**" />
            <exclude name="app/OracleApp.xml" />
            <exclude name="app/UNIXOracleApp.xml" />
            <exclude name="app/Oracle/OracleVirtualSystem.xml" />
            <exclude name="app/Oracle/Oracle_Clinical.xml" />
            <exclude name="app/Oracle/UNIX_Oracle_Clinical.xml" />
            <exclude name="app/ResearchInMotion/BlackBerry_Enterprise_Server.xml" />
            <exclude name="app/SAPL3.xml" />
            <exclude name="app/BEA/UNIXWebLogic.xml" />
            <exclude name="app/IBM/UNIX_WebSphere_Application_Server.xml" />
            <exclude name="app/IBM/WebSphere_Application_Server.xml" />

            <include name="database/MSSQLServer.xml" />
            <include name="database/Oracle.xml" />
            <include name="database/WindowsOracle.xml" />

            <!-- <include name="network/**" /> -->
            <include name="common/*" />
            <include name="hardware/PrinterDiscovery.xml" />
            <!-- <include name="hardware/NetAppFilerDiscovery.xml" /> -->

            <include name="os/AIX.xml" />
            <include name="os/Embedded.xml" />
            <include name="os/HPUX.xml" />
            <include name="os/IBMzOS.xml" />
            <include name="os/J2ME.xml" />
            <include name="os/Linux.xml" />
            <include name="os/MacOS.xml" />
            <include name="os/Netware.xml" />
            <include name="os/OracleVMServer.xml" />
            <include name="os/UNIX.xml" />
            <include name="os/VNwareESXServer.xml" />            
            <include name="os/Windows.xml" />
            <include name="os/WindowsL2.xml" />
            <include name="os/XenServer.xml" />
        </fileset>
    </copy>

    <!-- copy the built-in application modules -->
    <copy todir="${bdna.content.build}/appframe/com/bdna/modules/appmeta">
        <fileset dir="${bdna.seq}/com/bdna/app/application">
            <include name="AppConsole.xml" />
            <include name="Folders.xml" />
            <include name="MarketData_SupportViews.xml" />
            <include name="MarketData.xml" />
            <include name="StandardApplication.xml" />
            <include name="PSSoftFolderPlacements.xml" />
        </fileset>
    </copy>

    <unzip src="${bdna.seq}/com/bdna/app/data/marketData-NextGen.zip" dest="${bdna.content.build}/appdata/" />
     
    <copy todir="${bdna.content.build}/wincs/Scripts">
        <fileset dir="${bdna.seq}/wincs/Scripts">
            <include name="*.cs" />
        </fileset>
    </copy>

    <copy tofile="${bdna.content.build}/schema/bdna.dtd" file="${bdna.seq}/schema/bdna.dtd" />

    <!-- Insert Windows scripts into XML modules -->
    <java
        classname="com.bdna.fingerprintTool.ModulesTransformer"
        classpathref="javac.classpath"
        failonerror="true"
        dir="${bdna.content.build}/modules"
        fork="yes" >
        <sysproperty key="bdna.home" value="${bdna.seq}"/>
        <arg value="${bdna.content.build}" />
        <arg value="${bdna.content.build}" />
    </java>

    <copy todir="${bdna.content.build}/presentation">
        <fileset dir="${bdna.src}/presentation">
            <include name="**/*.xml" />
            <include name="**/*.properties" />
        </fileset>
    </copy>

</target>


<!--                                                        -->
<!--            Prepare the distribution directories        -->
<!--                                                        -->
<target name="prep_dist_bcp_PSSoftSequence">
    <delete dir="${bdna.content.dist}" />
    <mkdir dir="${bdna.content.dist}/modules" />
    <mkdir dir="${bdna.content.dist}/modules/com" />
    <mkdir dir="${bdna.content.dist}/modules/com/bdna" />
    <mkdir dir="${bdna.content.dist}/scripts" />
    <mkdir dir="${bdna.content.dist}/nih" />
    <mkdir dir="${bdna.content.dist}/pso" />
    <mkdir dir="${bdna.content.dist}/pso/CDB" />
    <mkdir dir="${bdna.content.dist}/appdata" />
    <mkdir dir="${bdna.content.dist}/java" />
    <mkdir dir="${bdna.content.dist}/appframe" />
    <mkdir dir="${bdna.content.dist}/MANIFEST" />
    <mkdir dir="${bdna.content.dist}/pre_upgrade" />
    <mkdir dir="${bdna.content.dist}/upgrade" />
    <mkdir dir="${bdna.content.dist}/content/cmdb/BDNAERI" />
    <mkdir dir="${bdna.content.dist}/classes" />
    <mkdir dir="${bdna.content.dist}/debug" />
    <mkdir dir="${bdna.content.dist}/debug/classes" />
    <mkdir dir="${bdna.content.dist}/java" />
</target>


<target name="dist_bcp_PSSoftSequence" depends="init,generate_bcp_PSSoftSequence,prep_dist_bcp_PSSoftSequence, content_java">

    <copy file="${bdna.seq}/com/bdna/app/widget/WidgetLibrary.xml" todir="${bdna.content.dist}/appframe/com/bdna/modules/appmeta" />
    <copy file="${bdna.seq}/com/bdna/app/uiengine/HTMLEngineWidgetLibrary.xml" todir="${bdna.content.dist}/appframe/com/bdna/modules/appmeta" />
    <copy file="${bdna.seq}/com/bdna/app/uiengine/SwingEngineWidgetLibrary.xml" todir="${bdna.content.dist}/appframe/com/bdna/modules/appmeta" />
    <copy file="${bdna.seq}/com/bdna/app/metadata/eri/ERI_ColExclusionList.txt" todir="${bdna.content.dist}/content/cmdb/BDNAERI" />

    <copy file="${bdna.seq}/content/manifests/PSSoftSequenceManifest.xml" todir="${bdna.content.dist}/MANIFEST" />

    <copy file="${bdna.seq}/content/pre_upgrade/pre_upgrade.sh" tofile="${bdna.content.dist}/pre_upgrade/pre_upgrade.sh" />
    <copy file="${bdna.seq}/content/pre_upgrade/cleanMarketData.sql" tofile="${bdna.content.dist}/pre_upgrade/cleanMarketData.sql" />
    <copy file="${bdna.seq}/content/upgrade/upgrade.xml" tofile="${bdna.content.dist}/upgrade/upgrade.xml" />
    <copy file="${bdna.seq}/content/upgrade/EnterpriseSequenceUpgrade.sh" tofile="${bdna.content.dist}/upgrade/upgrade.sh" />
    <copy file="${bdna.seq}/content/upgrade/pubTablesCleanup.sql" tofile="${bdna.content.dist}/upgrade/pubTablesCleanup.sql" />
    <copy file="${bdna.seq}/content/upgrade/removeMD_dups.sql" tofile="${bdna.content.dist}/upgrade/removeMD_dups.sql" />
    <copy file="${bdna.seq}/content/upgrade/publisher_flag_fix.sql" tofile="${bdna.content.dist}/upgrade/publisher_flag_fix.sql" />
    <copy file="${bdna.seq}/content/upgrade/restoreAttributes.sql" tofile="${bdna.content.dist}/upgrade/restoreAttributes.sql" />
    <copy file="${bdna.seq}/content/upgrade/metadataCleanup.sql" tofile="${bdna.content.dist}/upgrade/metadataCleanup.sql" />
    <copy file="${bdna.seq}/content/upgrade/upgradeContentReports.xml" tofile="${bdna.content.dist}/upgrade/upgradeContentReports.xml" />
    <copy file="${bdna.seq}/content/upgrade/sshconnect.pl" tofile="${bdna.content.dist}/upgrade/sshconnect.pl" />

    <replace file="${bdna.content.dist}/MANIFEST/PSSoftSequenceManifest.xml" value="${bdna.bcp.version}">
        <replacefilter token="@bdna.bcp.version@"/>
    </replace>
    <replace file="${bdna.content.dist}/MANIFEST/PSSoftSequenceManifest.xml" value="${bcp.build.number}">
        <replacefilter token="@bcp.build.number@"/>
    </replace>

    <replace file="${bdna.content.dist}/upgrade/upgrade.sh" value="${bdna.bcp.version}">
        <replacefilter token="@bdna.bcp.version@"/>
    </replace>
    <replace file="${bdna.content.dist}/upgrade/upgrade.sh" value="${bcp.build.number}">
        <replacefilter token="@bcp.build.number@"/>
    </replace>

    <copy todir="${bdna.content.dist}/nih">
        <fileset dir="${bdna.content.build}/nih">
            <include name="**" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.dist}/pso/CDB">
        <fileset dir="${bdna.seq}/pso/CDB">
            <include name="DataExtract.sh" />
            <include name="extract.sql" />
            <include name="cpu_extract.sql" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.dist}/scripts">
        <fileset dir="${bdna.content.build}/scripts">
            <include name="**" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.dist}/appdata">
        <fileset dir="${bdna.content.build}/appdata">
            <include name="**" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.dist}/appframe">
        <fileset dir="${bdna.content.build}/appframe">
            <include name="**" />
        </fileset>
    </copy>

    <!-- Updated startagent with Nmap 5.51 binaries -->
    <copy file="${bdna.src}/ShellScripts/Linux/startagent.sh" todir="${bdna.content.dist}/bin" />
    <copy file="${bdna.src}/ShellScripts/Linux/chk_valid_os.pl" todir="${bdna.content.dist}/bin" />

    <copy todir="${bdna.content.dist}/conf">
        <fileset dir="${bdna.seq}/content/udtTemplate">
            <include name="EnterpriseSequenceUdt.tpl" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.dist}/conf">
        <fileset dir="${bdna.seq}/conf">
            <include name=".bdnauikeystore" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.dist}/java/sources/com/bdna/si/udt">
        <fileset dir="${bdna.seq}/com/bdna/si/udt">
            <include name="*.java" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.dist}/java/classes/com/bdna/si/udt">
        <fileset dir="${bdna.build}/classes/com/bdna/si/udt">
            <include name="**" />
        </fileset>
    </copy>

    <!-- move the new Java classes -->
    <copy todir="${bdna.content.dist}/classes">
        <fileset dir="${bdna.seq}/java/classes">
            <include name="com/bdna/xsi/commands/CommandRunXform.class" />
            <include name="com/bdna/app/metadata/xsi/Project.class" />
            <include name="com/bdna/app/metadata/TableDef.class" />
            <include name="com/bdna/app/widget/JNavigation.class" />
            <include name="com/bdna/app/widget/JNavigation$$*.class" />
            <include name="com/bdna/app/widget/JDataAdmin.class" />
            <include name="com/bdna/app/widget/JDataAdmin$$*.class" />
            <include name="com/bdna/app/widget/JRoleEditor.class" />
            <include name="com/bdna/app/widget/JRoleEditor$$*.class" />
            <include name="com/bdna/app/metadata/ScanQuery.class" />
            <include name="com/bdna/app/metadata/ScanQuery$$*.class" />
            <include name="com/bdna/app/db/AttributeInfoCache.class" />
            <include name="com/bdna/app/uiengine/SwingAppClient.class" />
            <include name="com/bdna/app/uiengine/SwingAppClient$$*.class" />
            <include name="com/bdna/bvl/dw/GlobalScan.class" />
            <include name="com/bdna/bvl/dw/GlobalScan$$*.class" />
            <include name="com/bdna/bvl/dw/CumulativeScanBuilder.class" />
            <include name="com/bdna/bvl/dw/CumulativeScanBuilder$$*.class" />
            <include name="com/bdna/bvl/dw/ViewBuilder.class" />
            <include name="com/bdna/si/common/AutoConnection.class" />
            <include name="com/bdna/si/common/AutoConnection$$*.class" />
            <include name="com/bdna/si/metadata/ElementFactory.class" />
            <include name="com/bdna/si/metadata/ElementFactory$$*.class" />
            <include name="com/bdna/si/metadata/PackageFactory.class" />
            <include name="com/bdna/si/metadata/PackageFactory$$*.class" />
            <include name="com/bdna/si/udt/UDTUtil.class" />
            <include name="com/bdna/si/udt/GuardiumModulesUDT.class" />
            <include name="com/bdna/si/udt/IBMDB2FeaturesUDT.class" />
            <include name="com/bdna/si/udt/IBMDB2LicmListUDT.class" />
            <include name="com/bdna/ut/cla/claMessages/ResultCodes.class" />
            <include name="com/bdna/ut/xmlsax/BaseHandler.class" />
            <include name="com/bdna/ut/xmlsax/BaseHandler$$*.class" />
            <include name="com/bdna/app/metadata/eri/ERIGenerator.class" />
            <include name="com/bdna/app/metadata/eri/ERIGenerator$$*.class" />
            <include name="com/bdna/si/ac/User.class" />
            <include name="com/bdna/si/ac/User$$*.class" />
            <include name="com/bdna/java/JavaAction.class" />
            <include name="com/bdna/java/JavaAction$$*.class" />
            <include name="com/bdna/jiffy/j4/Operator.class" />
            <include name="com/bdna/jiffy/j4/Operator$$*.class" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.dist}/debug/classes">
        <fileset dir="${bdna.seq}/java/debug/classes">
            <include name="com/bdna/xsi/commands/CommandRunXform.class" />
            <include name="com/bdna/app/metadata/xsi/Project.class" />
            <include name="com/bdna/app/metadata/TableDef.class" />
            <include name="com/bdna/app/widget/JNavigation.class" />
            <include name="com/bdna/app/widget/JNavigation$$*.class" />
            <include name="com/bdna/app/widget/JDataAdmin.class" />
            <include name="com/bdna/app/widget/JDataAdmin$$*.class" />
            <include name="com/bdna/app/widget/JRoleEditor.class" />
            <include name="com/bdna/app/widget/JRoleEditor$$*.class" />
            <include name="com/bdna/app/metadata/ScanQuery.class" />
            <include name="com/bdna/app/metadata/ScanQuery$$*.class" />
            <include name="com/bdna/app/db/AttributeInfoCache.class" />
            <include name="com/bdna/app/uiengine/SwingAppClient.class" />
            <include name="com/bdna/app/uiengine/SwingAppClient$$*.class" />
            <include name="com/bdna/bvl/dw/GlobalScan.class" />
            <include name="com/bdna/bvl/dw/GlobalScan$$*.class" />
            <include name="com/bdna/bvl/dw/CumulativeScanBuilder.class" />
            <include name="com/bdna/bvl/dw/CumulativeScanBuilder$$*.class" />
            <include name="com/bdna/bvl/dw/ViewBuilder.class" />
            <include name="com/bdna/si/common/AutoConnection.class" />
            <include name="com/bdna/si/common/AutoConnection$$*.class" />
            <include name="com/bdna/si/metadata/ElementFactory.class" />
            <include name="com/bdna/si/metadata/ElementFactory$$*.class" />
            <include name="com/bdna/si/metadata/PackageFactory.class" />
            <include name="com/bdna/si/metadata/PackageFactory$$*.class" />
            <include name="com/bdna/si/udt/UDTUtil.class" />
            <include name="com/bdna/ut/cla/claMessages/ResultCodes.class" />
            <include name="com/bdna/ut/xmlsax/BaseHandler.class" />
            <include name="com/bdna/ut/xmlsax/BaseHandler$$*.class" />
            <include name="com/bdna/app/metadata/eri/ERIGenerator.class" />
            <include name="com/bdna/app/metadata/eri/ERIGenerator$$*.class" />
            <include name="com/bdna/si/ac/User.class" />
            <include name="com/bdna/si/ac/User$$*.class" />
            <include name="com/bdna/java/JavaAction.class" />
            <include name="com/bdna/java/JavaAction$$*.class" />
            <include name="com/bdna/jiffy/j4/Operator.class" />
            <include name="com/bdna/jiffy/j4/Operator$$*.class" />
        </fileset>
    </copy>


    <!-- Update the contentExportTag element contents -->
    <replace file="${bdna.content.build}/modules/com/bdna/modules/common/DiscoveryBase.xml" value="${bdna.bcp.version}">
        <replacefilter token="@bdna.bcp.version@"/>
    </replace>
    <replace file="${bdna.content.build}/modules/com/bdna/modules/common/DiscoveryBase.xml" value="${bcp.build.number}">
        <replacefilter token="@bcp.build.number@"/>
    </replace>

    <delete file="${bdna.content.dist}/modules/com/bdna/bdna_content.bar"/>
    <jar
        jarfile="${bdna.content.dist}/modules/com/bdna/bdna_content.bar"
        basedir="${bdna.content.build}/modules" >
        <manifest>
            <attribute name="Built-By" value="${user.name}"/>
            <section name="common">
              <attribute name="BDNA_CONTENT_PACK_NAME" value="${bdna.BCP.PSSoftSequence.label}"/>
              <attribute name="BDNA_CONTENT_BUILD_DATE" value="${bdna.content.build.stamp}"/>
              <attribute name="BDNA_CONTENT_VERSION_NUMBER" value="${bdna.BCP.PSSoftSequence.version}"/>
              <attribute name="BDNA_CONTENT_BUILD_NUMBER" value="${bcp.build.number}"/>
            </section>
            <section name="common/class1.class">
              <attribute name="Sealed" value="false"/>
            </section>
        </manifest>
    </jar>

</target>



<target name="content_installkit_bcp_PSSoftSequence" depends="dist_bcp_PSSoftSequence">
    <delete file="${bdna.nightly_builds.this_build}/OEMPSSOFTSequence_${bdna.BCP.PSSoftSequence.version}_${bcp.build.number}.seq"/>
    <delete file="${bdna.nightly_builds}/OEMPSSOFTSequence_latest.seq"/>

    <jar
        jarfile="${bdna.nightly_builds.this_build}/OEMPSSOFTSequence_${bdna.BCP.PSSoftSequence.version}_${bcp.build.number}.seq" 
        basedir="${bdna.content.dist}">
    </jar>
    <copy file="${bdna.nightly_builds.this_build}/OEMPSSOFTSequence_${bdna.BCP.PSSoftSequence.version}_${bcp.build.number}.seq" tofile="${bdna.nightly_builds}/OEMPSSOFTSequence_latest.seq" />
</target>

<target name="build_pssoft_sequence" depends="content_installkit_bcp_PSSoftSequence, content_installkit_bcploader" >
</target>

<target name="build_enterprise_sequence" depends="content_installkit_bcp_EnterpriseSequence, content_installkit_bcploader" >
</target>

<target name="content_installkit_bcploader">
    <copy file="${bdna.src}/ShellScripts/UNIX/bcploader.sh" todir="${bdna.nightly_builds.this_build}/" />
</target>

<target name="build_sequences" depends="content_installkit_bcp_Baseline, content_installkit_bcp_MicrosoftSoftware, content_installkit_bcp_IBMHardware, content_installkit_bcp_IBMSoftware, content_installkit_bcp_OracleSoftware, content_installkit_bcp_OracleLMS, content_installkit_bcp_AdobeSoftware, content_installkit_bcp_DellHardware, content_installkit_bcp_HPHardware, content_installkit_bcp_CiscoHardware, content_installkit_bcp_HardwareEnergy, content_installkit_bcp_EnterpriseSequence, content_installkit_bcp_PSSoftSequence, content_installkit_bcploader" >
</target>


<!--                                                        -->
<!--            6.1.2 content release build                 -->
<!--                                                        -->

<target name="prep_build_bcp_Content612">
    <delete dir="${bdna.content.build}" />
    <mkdir dir="${bdna.content.build}/modules" />
    <mkdir dir="${bdna.content.build}/appframe" />
    <mkdir dir="${bdna.content.build}/appdata" />
</target>


<!--                                                        -->
<!--            Generate the fingerprint modules            -->
<!--                                                        -->
<target name="generate_bcp_Content612" depends="prep_build_bcp_Content612">

    <java
        classname="com.bdna.fingerprintTool.OSDevFingerprint"
        classpathref="javac.classpath"
        failonerror="true"
        dir="${bdna.seq}/com/bdna/fingerprintTool/templates/jiffy"
        fork="yes" >
        <sysproperty key="bdna.home" value="${bdna.seq}"/>
        <sysproperty key="bdna.jiffy.noperlcheck" value="${bdna.jiffy.noperlcheck}" />
        <arg value="${bdna.seq}" />
        <arg value="${bdna.content.build}" />
    </java>

    <java
        classname="com.bdna.fingerprintTool.GenJiffyFP"
        classpathref="javac.classpath"
        failonerror="true"
        dir="${bdna.seq}/com/bdna/fingerprintTool/templates/jiffy"
        fork="yes" >
        <sysproperty key="bdna.home" value="${bdna.seq}"/>
        <sysproperty key="bdna.jiffy.noperlcheck" value="${bdna.jiffy.noperlcheck}" />
        <arg value="${bdna.seq}/com/bdna/fingerprintTool" />
        <arg value="${bdna.content.build}/modules" />
    </java>


    <!-- move the bdna modules, overwrite the generated version if any -->
    <copy todir="${bdna.content.build}/modules/">
        <fileset dir="${bdna.seq}/modules">
            <include name="com/bdna/modules/**" />
            <include name="com/bdna/presentationModules/**" />
        </fileset>
    </copy>

    <!-- copy the built-in application modules -->
    <copy todir="${bdna.content.build}/appframe/com/bdna/modules/appmeta">
        <fileset dir="${bdna.seq}/com/bdna/app/application">
            <include name="ADMDependencyMatch.xml" />
            <include name="Administrative.xml" />
            <include name="ADMMatch.xml" />
            <include name="ADMResults.xml" />
            <include name="Aggregate.xml" />
            <!-- <include name="AppConsole.xml" /> -->
            <include name="ApplicationServers.xml" />
            <include name="Applications.xml" />
            <include name="AssetRecon.xml" />
            <include name="BaselinePack.xml" />
            <include name="Base.xml" />
            <include name="CatalogBase.xml" />
            <include name="CitrixApplications.xml" />
            <include name="CMDB.xml" />
            <include name="Common.xml" />
            <include name="CredentialUsage.xml" />
            <include name="Dashboard.xml" />
            <include name="Databases.xml" />
            <include name="DB2Databases.xml" />
            <include name="DeprecatedInventory.xml" />
            <include name="ERIBase.xml" />
            <include name="ERIDeprecated.xml" />  
            <include name="ERIStar.xml" />
            <include name="FactBase.xml" />
            <include name="FlexLMLicenseServer.xml" />
            <include name="Folders.xml" />
            <include name="Guardium_Modules.xml" />
            <include name="HPVirtualization.xml" />
            <include name="HTMLInventoryApplication.xml" />
            <include name="IBMApplications.xml" />
            <include name="IBMVirtualization.xml" />
            <include name="InformixDatabases.xml" />
            <include name="InventoryApplication.xml" />
            <!-- <include name="LinkingRulesVirtualization.xml" /> -->
            <include name="LinkingRules.xml" />
            <include name="LinkingVirtualization.xml" />
            <include name="Linking.xml" />
            <include name="MarketData_SupportViews.xml" />
            <include name="MarketData.xml" />
            <include name="MDTablesFolderPlacements.xml" />
            <include name="Misc.xml" />
            <!-- <include name="MiscApplications.xml" /> -->
            <include name="MSSQLDatabases.xml" />
            <include name="MSVSVirtualization.xml" />
            <include name="NetworkEquipment.xml" />
            <include name="NetworkServices.xml" />
            <include name="OperatingSystems.xml" />
            <!-- <include name="OracleApplications.xml" /> -->
            <include name="OracleCommon.xml" />
            <include name="OracleDatabases.xml" />
            <include name="OracleVMVirtualization.xml" />
            <include name="Printers.xml" />
            <include name="PublisherADM.xml" />
            <include name="PublisherApache.xml" />
            <include name="PublisherDatabase.xml" />
            <include name="PublisherIBM.xml" />
            <include name="PublisherMisc.xml" />
            <include name="PublisherNIC.xml" />
            <include name="PublisherOracle.xml" />
            <!-- <include name="PublisherVirtualization.xml" /> -->
            <include name="PublisherWebServers.xml" />
            <include name="PublisherWin.xml" />
            <include name="PublisherUNIX.xml" />
            <include name="QuickReports.xml" />
            <include name="SAPApplications.xml" />
            <include name="ScanAdmin.xml" />
            <include name="ScanSummary.xml" />
            <include name="SchemaTool.xml" />
            <include name="SoftwareUsage.xml" />
            <include name="StandardApplication.xml" />
            <include name="Storage.xml" />
            <include name="SunVirtualization.xml" />
            <!-- <include name="SymantecApplications.xml" /> -->
            <!-- <include name="SynopsysApplications.xml" /> -->
            <include name="TransactionalModel.xml" />
            <include name="UserReports.xml" />
            <include name="VideoConferencingEquipment.xml" />
            <include name="VirtualizationSummary.xml" />
            <include name="Virtualization.xml" />
            <include name="VMapRelations.xml" />
            <!-- <include name="VMwareVirtualization.xml" /> -->
            <include name="WebLogic.xml" />
            <include name="WebServers.xml" />
            <include name="WebSphereMQ.xml" />
            <include name="WebSphere.xml" />
            <include name="WinFileScan.xml" />
            <!-- <include name="XenVirtualization.xml" /> -->
        </fileset>
    </copy>

     <unzip src="${bdna.seq}/com/bdna/app/data/marketData-NextGen.zip" dest="${bdna.content.build}/appdata/" />

     <!-- Insert Windows scripts into XML modules -->
     <java
         classname="com.bdna.fingerprintTool.ModulesTransformer"
         classpathref="javac.classpath"
         failonerror="true"
         dir="${bdna.seq}/modules"
         fork="yes" >
         <sysproperty key="bdna.home" value="${bdna.seq}"/>
         <arg value="${bdna.seq}" />
         <arg value="${bdna.content.build}" />
     </java>


    <copy todir="${bdna.content.build}/presentation">
        <fileset dir="${bdna.src}/presentation">
            <include name="**/*.xml" />
            <include name="**/*.properties" />
        </fileset>
    </copy>

</target>

<!--                                                        -->
<!--            Prepare the distribution directories        -->
<!--                                                        -->
<target name="prep_dist_bcp_Content612">
    <delete dir="${bdna.content.dist}" />
    <mkdir dir="${bdna.content.dist}/access" />
    <mkdir dir="${bdna.content.dist}/modules" />
    <mkdir dir="${bdna.content.dist}/modules/com" />
    <mkdir dir="${bdna.content.dist}/modules/com/bdna" />
    <mkdir dir="${bdna.content.dist}/classes" />
    <mkdir dir="${bdna.content.dist}/content" />
    <mkdir dir="${bdna.content.dist}/content/cmdb" />
    <mkdir dir="${bdna.content.dist}/content/cmdb/BDNAERI" />
    <mkdir dir="${bdna.content.dist}/content/cmdb/BDNAERI/ERIProject" />
    <mkdir dir="${bdna.content.dist}/content/cmdb/BDNAERI/ERIProject/com" />
    <mkdir dir="${bdna.content.dist}/content/cmdb/BDNAERI/ERIProject/com/bdna" />
    <mkdir dir="${bdna.content.dist}/content/cmdb/BDNAERI/ERIProject/com/bdna/external" />
    <mkdir dir="${bdna.content.dist}/content/cmdb/BDNAERI/ERIProject/com/bdna/external/bdnaeri" />
    <mkdir dir="${bdna.content.dist}/scripts" />
    <mkdir dir="${bdna.content.dist}/debug" />
    <mkdir dir="${bdna.content.dist}/debug/classes" />
    <mkdir dir="${bdna.content.dist}/appdata" />
    <mkdir dir="${bdna.content.dist}/appframe" />
    <mkdir dir="${bdna.content.dist}/upgrade" />
    <mkdir dir="${bdna.content.dist}/upgrade/612_content" />
    <mkdir dir="${bdna.content.dist}/pso"/>
    <mkdir dir="${bdna.content.dist}/pso/CDB"/>
    <mkdir dir="${bdna.content.dist}/bin"/>
    <mkdir dir="${bdna.content.dist}/java/sources/com/bdna/si/udt"/>
    <mkdir dir="${bdna.content.dist}/java/classes/com/bdna/si/udt"/>
</target>


<target name="dist_bcp_Content612" depends="init,generate_bcp_Content612,prep_dist_bcp_Content612">

    <!-- Not needed for 612 patch
    <copy file="${bdna.seq}/com/bdna/app/widget/WidgetLibrary.xml" todir="${bdna.content.dist}/appframe/com/bdna/modules/appmeta" />
    <copy file="${bdna.seq}/com/bdna/app/uiengine/HTMLEngineWidgetLibrary.xml" todir="${bdna.content.dist}/appframe/com/bdna/modules/appmeta" />
    <copy file="${bdna.seq}/com/bdna/app/uiengine/SwingEngineWidgetLibrary.xml" todir="${bdna.content.dist}/appframe/com/bdna/modules/appmeta" />
    -->

    <copy todir="${bdna.content.dist}/appdata">
        <fileset dir="${bdna.content.build}/appdata">
            <include name="**" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.dist}/appframe">
        <fileset dir="${bdna.content.build}/appframe">
            <include name="**" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.dist}/conf">
        <fileset dir="${bdna.src}/conf">
            <include name="udt.tpl" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.dist}/java/sources/com/bdna/si/udt">
        <fileset dir="${bdna.seq}/com/bdna/si/udt">
            <include name="*.java" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.dist}/java/classes/com/bdna/si/udt">
        <fileset dir="${bdna.build}/classes/com/bdna/si/udt">
            <include name="**" />
        </fileset>
    </copy>

    <!-- add linking report folder placements -->
    <copy todir="${bdna.content.dist}/appframe/com/bdna/modules/appmeta">
        <fileset dir="${bdna.src}/upgrade/612_content">
            <include name="LinkingVirtualizationFolderPlacements.xml" />
        </fileset>
    </copy>

    <!-- move the 6.1.2 Oracle fingerprints without LMS -->
    <!--
    <copy todir="${bdna.content.build}/modules/com/bdna/modules/database" overwrite="true">
        <fileset dir="${bdna.src}/upgrade/612_content">
            <include name="Oracle.xml" />
            <include name="UNIXOracle.xml" />
            <include name="UNIXOracleL3.xml" />
            <include name="WindowsOracle.xml" />
            <include name="WindowsOracleL3.xml" />
        </fileset>
    </copy>
    -->

    <fileset id="Content612_modules" dir="${bdna.content.build}/modules">
        <include name="com/bdna/modules/**" />
        <exclude name="com/bdna/modules/metadata/*SoftwareFlags.xml" />
        <exclude name="com/bdna/modules/metadata/*HardwareFlags.xml" />
        <exclude name="com/bdna/modules/database/OracleL3Common.xml" />
        <include name="com/bdna/presentationModules/**" />
        <include name="**/*.properties" />
    </fileset>

    <!-- Update the contentExportTag element contents -->
    <replace file="${bdna.content.build}/modules/com/bdna/modules/common/DiscoveryBase.xml" value="${bdna.bcp.version}">
        <replacefilter token="@bdna.bcp.version@"/>
    </replace>
    <replace file="${bdna.content.build}/modules/com/bdna/modules/common/DiscoveryBase.xml" value="${bcp.build.number}">
        <replacefilter token="@bcp.build.number@"/>
    </replace>

    <!-- move the new Java classes -->
    <copy todir="${bdna.content.dist}/classes">
        <fileset dir="${bdna.build}/classes">
            <include name="com/bdna/xsi/commands/CommandRunXform.class" />
            <include name="com/bdna/app/metadata/xsi/Project.class" />
            <include name="com/bdna/app/metadata/TableDef.class" />
            <include name="com/bdna/si/udt/CASoftwareCompAndPath.class" />
            <include name="com/bdna/si/udt/dbaFeatureStats.class" />
            <include name="com/bdna/si/udt/dbOptions.class" />
            <include name="com/bdna/si/udt/FlexLMUserID.class" />
            <include name="com/bdna/si/udt/FoundstoneSoftwareCompAndDate.class" />
            <include name="com/bdna/si/udt/PrinterInkLevel.class" />
            <include name="com/bdna/si/udt/WindowsServicesUDT.class" />
            <include name="com/bdna/si/udt/WyseLinuxNics.class" />
            <include name="com/bdna/si/udt/WyseWindowsCENics.class" />
            <include name="com/bdna/si/udt/GuardiumModulesUDT.class" />
            <include name="com/bdna/si/udt/IBMDB2FeaturesUDT.class" />
            <include name="com/bdna/si/udt/IBMDB2LicmListUDT.class" />
            <include name="com/bdna/app/metadata/ScanQuery.class" />
            <include name="com/bdna/app/metadata/ScanQuery$$*.class" />
            <include name="com/bdna/app/uiengine/SwingAppClient.class" />
            <include name="com/bdna/app/uiengine/SwingAppClient$$*.class" />
            <include name="com/bdna/si/common/AutoConnection.class" />
            <include name="com/bdna/si/common/AutoConnection$$*.class" />
            <include name="com/bdna/si/util/CreateOracleUser.class" />
            <include name="com/bdna/ut/cla/claMessages/ResultCodes.class" />
            <include name="com/bdna/app/metadata/eri/ERIGenerator.class" />
            <include name="com/bdna/app/metadata/eri/ERIGenerator$$*.class" />
            <include name="com/bdna/app/widget/JDataAdmin.class" />
            <include name="com/bdna/app/widget/JDataAdmin$$*.class" />
            <include name="com/bdna/app/widget/JRoleEditor.class" />
            <include name="com/bdna/app/widget/JRoleEditor$$*.class" />
            <include name="com/bdna/si/ac/User.class" />
            <include name="com/bdna/si/ac/User$$*.class" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.dist}/debug/classes">
        <fileset dir="${bdna.build}/debug/classes">
            <include name="com/bdna/xsi/commands/CommandRunXform.class" />
            <include name="com/bdna/app/metadata/xsi/Project.class" />
            <include name="com/bdna/app/metadata/TableDef.class" />
            <include name="com/bdna/si/udt/CASoftwareCompAndPath.class" />
            <include name="com/bdna/si/udt/dbaFeatureStats.class" />
            <include name="com/bdna/si/udt/dbOptions.class" />
            <include name="com/bdna/si/udt/FlexLMUserID.class" />
            <include name="com/bdna/si/udt/FoundstoneSoftwareCompAndDate.class" />
            <include name="com/bdna/si/udt/PrinterInkLevel.class" />
            <include name="com/bdna/si/udt/WindowsServicesUDT.class" />
            <include name="com/bdna/si/udt/WyseLinuxNics.class" />
            <include name="com/bdna/si/udt/WyseWindowsCENics.class" />
            <include name="com/bdna/app/metadata/ScanQuery.class" />
            <include name="com/bdna/app/metadata/ScanQuery$$*.class" />
            <include name="com/bdna/app/uiengine/SwingAppClient.class" />
            <include name="com/bdna/app/uiengine/SwingAppClient$$*.class" />
            <include name="com/bdna/si/common/AutoConnection.class" />
            <include name="com/bdna/si/common/AutoConnection$$*.class" />
            <include name="com/bdna/si/util/CreateOracleUser.class" />
            <include name="com/bdna/ut/cla/claMessages/ResultCodes.class" />
            <include name="com/bdna/app/metadata/eri/ERIGenerator.class" />
            <include name="com/bdna/app/metadata/eri/ERIGenerator$$*.class" />
            <include name="com/bdna/app/widget/JDataAdmin.class" />
            <include name="com/bdna/app/widget/JDataAdmin$$*.class" />
            <include name="com/bdna/app/widget/JRoleEditor.class" />
            <include name="com/bdna/app/widget/JRoleEditor$$*.class" />
            <include name="com/bdna/si/ac/User.class" />
            <include name="com/bdna/si/ac/User$$*.class" />
        </fileset>
    </copy>

    <copy todir="${bdna.content.dist}/classes">
        <fileset dir="${bdna.seq}/java/classes612">
            <include name="com/bdna/app/widget/JNavigation.class" />
            <include name="com/bdna/app/widget/JNavigation$$*.class" />
        </fileset>
    </copy>

    <!-- copy the ERI project files -->
    <copy todir="${bdna.content.dist}/content/cmdb/BDNAERI/ERIProject/com/bdna/external/bdnaeri">
        <fileset dir="${bdna.src}/content/external/BDNAERI/ERIProject/com/bdna/external/bdnaeri" includes="*.xml" />
    </copy>

    <!-- dist the bdna access modules -->
    <copy todir="${bdna.content.dist}/access">
        <fileset dir="${bdna.src}/upgrade/612_content">
            <include name="AccessControl.xml" />
        </fileset>
    </copy>

    <!-- dist Nmap 5.21 -->
    <copy todir="${bdna.content.dist}/nih">
        <fileset dir="${bdna.seq}/nih">
            <include name="Perl/Modules/**" />
            <include name="Nmap/src/nmap.Linux.RHEL4" />
            <include name="Nmap/src/nmap.Linux.RHEL5.i686" />
            <include name="Nmap/src/nmap.Linux.RHEL5.x86_64" />
            <include name="Nmap/src/nmap-mac-prefixes" />
            <include name="Nmap/src/nmap-os-db" />
            <include name="Nmap/src/nmap-protocols" />
            <include name="Nmap/src/nmap-rpc" />
            <include name="Nmap/src/nmap-service-probes" />
            <include name="Nmap/src/nmap-services" />
            <include name="Nmap/src/nse_main.lua" />
            <include name="Nmap/src/nselib" />
            <include name="Nmap/src/scripts" />
            <include name="Nmap/src4/nmap-os-fingerprints" />
            <include name="Nmap/src4/nmap-protocols" />
            <include name="Nmap/src4/nmap-services" />
            <include name="Nmap/src4/nmap-rpc" />
            <include name="Nmap/src4/nmap.Linux" />
            <include name="Nmap/src4/nmap.exe" />
            <include name="SNMP/**" />
            <include name="samba/bin/**" />
            <include name="mssqlping/sqlping.Linux" />
            <include name="npadmin/npadmin.Linux" />
            <include name="nbtscan/nbtscan.Linux" />
            <include name="nbtscan/nbtscan.exe" />
        </fileset>
    </copy>

    <!-- dist the misc scripts -->
    <copy todir="${bdna.content.dist}/scripts">
        <fileset dir="${bdna.seq}/scripts">
            <include name="CLE/**" />
            <include name="ModularCollection/**" />
            <include name="RuleEngine/**" />
        </fileset>
    </copy>

    <!-- upgrade related files -->
    <copy todir="${bdna.content.dist}/upgrade/612_content">
        <fileset dir="${bdna.src}/upgrade/612_content">
            <include name="pre_upgrade.sql" />
            <include name="post_upgrade.sql" />
            <include name="upgrade_factbase_invs.sql" />
            <include name="upgradeContent.xml" />
            <include name="upgradeContentReports.xml" />
        </fileset>
    </copy>
    <copy todir="${bdna.content.dist}/upgrade/612_content">
        <fileset dir="${bdna.seq}/content/upgrade">
            <include name="publisher_flag_fix.sql" />
        </fileset>
    </copy>

    <!-- Market data extraction scripts -->
    <copy file="${bdna.src}/pso/CDB/DataExtract.sh" todir="${bdna.content.dist}/pso/CDB" />
    <copy file="${bdna.src}/pso/CDB/extract.sql" todir="${bdna.content.dist}/pso/CDB" />
    <copy file="${bdna.src}/pso/CDB/cpu_extract.sql" todir="${bdna.content.dist}/pso/CDB" />

    <!-- Updated startagent with Nmap 5 binaries -->
    <copy file="${bdna.src}/ShellScripts/Linux/startagent.sh" todir="${bdna.content.dist}/bin" />

    <delete file="${bdna.content.dist}/modules/com/bdna/bdna_content.bar"/>
    <jar
        jarfile="${bdna.content.dist}/modules/com/bdna/bdna_content.bar"
        >
        <fileset refid="Content612_modules"/>

        <manifest>
            <attribute name="Built-By" value="${user.name}"/>
            <section name="common">
              <attribute name="BDNA_CONTENT_PACK_NAME" value="${bdna.BCP.Content612.label}"/>
              <attribute name="BDNA_CONTENT_BUILD_DATE" value="${bdna.content.build.stamp}"/>
              <attribute name="BDNA_CONTENT_VERSION_NUMBER" value="${bdna.BCP.Content612.version}"/>
              <attribute name="BDNA_CONTENT_BUILD_NUMBER" value="${bcp.build.number}"/>
            </section>
            <section name="common/class1.class">
              <attribute name="Sealed" value="false"/>
            </section>
        </manifest>
    </jar>

</target>


<target name="content_installkit_bcp_Content612" depends="dist_bcp_Content612">
    <delete file="${bdna.nightly_builds.this_build}/bdna_content612_${bdna.BCP.Content612.version}_${bcp.build.number}.zip"/>
    <delete file="${bdna.nightly_builds}/bdna_content612_latest.zip"/>

    <zip
        destfile="${bdna.nightly_builds.this_build}/bdna_content612_${bdna.BCP.Content612.version}_${bcp.build.number}.zip" 
        basedir="${bdna.content.dist}">
    </zip>
    <copy file="${bdna.src}/upgrade/612_content/upgrade612_content_schema.sh" todir="${bdna.nightly_builds.this_build}/" />
    <copy file="${bdna.src}/upgrade/612_content/upgrade612_content_install.sh" todir="${bdna.nightly_builds.this_build}/" />

    <replace file="${bdna.nightly_builds.this_build}/upgrade612_content_install.sh" value="${bdna.bcp.version}">
        <replacefilter token="@bdna.bcp.version@"/>
    </replace>

    <copy file="${bdna.nightly_builds.this_build}/bdna_content612_${bdna.BCP.Content612.version}_${bcp.build.number}.zip" tofile="${bdna.nightly_builds}/bdna_content612_latest.zip" />
</target>

<target name="build_content612" depends="content_installkit_bcp_Content612" >
</target>

</project>
